long_test <- stringfish::convert_to_sf(
  c(
    "0214T", "0215T", "0217T", "0218T",
    "0219T", "0220T", "0221T", "0222T",
    "0263T", "0265T", "0266T", "0269T",
    "0274T", "0275T", "0329T", "0330T",
    "0422T", "0444T", "0445T", "0506T",
    "0507T", "15777", "20939", "22510",
    "22511", "22512", "22513", "22514",
    "22515", "22526", "22527", "27197",
    "27198", "30801", "30802", "31231",
    "32673", "34713", "34714", "34715",
    "34716", "34717", "36221", "34812",
    "34820", "34833", "34834", "35572",
    "50300", "50540", "54420", "54430",
    "55200", "55250", "55300", "58575",
    "58600", "58605", "58700", "58720",
    "58800", "58805", "58900", "58920",
    "58925", "58940", "58943", "61000",
    "61001", "61253", "63035", "63043",
    "63044", "63045", "63046", "63047",
    "63048", "64421", "64480", "64484",
    "64491", "64492", "64494", "64495",
    "64634", "64636", "76514", "92025",
    "92081", "92082", "92083", "92132",
    "92133", "92134", "92145", "92201",
    "92202", "92227", "92228", "92229",
    "92235", "92240", "92242", "95870",
    "C7501", "C7502", "C7504", "C7505",
    "C9771", "E0675", "G0279", "G0412",
    "G0413", "G0414", "G0415", "S2342"
  ))

hcpcs_tests <- stringfish::convert_to_sf(
  stringfish::sf_concat(
    c("J*", "G", "0", 4:6),
    c(as.character(30:32)),
    c(as.character(721:729)),
    c(as.character(5202:5208)),
    c(as.character(92015:92019))))

long_test2 <- stringfish::convert_to_sf(
  stringfish::sf_concat(
    sf_substr(long_test, 1, 1),
    sf_substr(long_test, 1, 2),
    sf_substr(long_test, 1, 3),
    sf_substr(long_test, 1, 4),
    sf_substr(long_test, 1, 5)))

all_tests <- stringfish::convert_to_sf(
  stringfish::sf_concat(
    sf_substr(long_test, 1, 2),
    sf_substr(long_test, 1, 3),
    sf_substr(long_test, 1, 4),
    sf_substr(long_test, 1, 5),
    hcpcs_tests))

hcpcs <- stringfish::convert_to_sf(
  collapse::funique(
    northstar::search_descriptions()$hcpcs_code))

start_chr <- sf_convert(sf_extract(hcpcs, "^[A-Z]"))
end_chr   <- sf_convert(sf_extract(hcpcs, "[A-Z]$"))

split_string <- \(...) {
  stringfish::convert_to_sf(paste0(...)) |>
    stringfish::sf_split(", ", nthreads = 4L) |>
    purrr::pluck(1)
}

new_test <- list(
  split_string(
    single_line_string(
      "A4467, A9283, A9285, L1900,
    L1902, L1904, L1906, L1907,
    L1910, L1920, L1930, L1932,
    L1940, L1945, L1950, L1951,
    L1960, L1970, L1971, L1980,
    L1990, L2000, L2005, L2006,
    L2010, L2020, L2030, L2034,
    L2035, L2036, L2037, L2038,
    L2106, L2108, L2112, L2114,
    L2116, L2126, L2128, L2132,
    L2134, L2136, L2180, L2182,
    L2184, L2186, L2188, L2190,
    L2192, L2200, L2210, L2220,
    L2230, L2232, L2240, L2250,
    L2260, L2265, L2270, L2275,
    L2280, L2300, L2310, L2320,
    L2330, L2335, L2340, L2350,
    L2360, L2370, L2375, L2380,
    L2385, L2387, L2390, L2395,
    L2397, L2405, L2415, L2425,
    L2430, L2492, L2500, L2510,
    L2520, L2525, L2526, L2530,
    L2540, L2550, L2750, L2755,
    L2760, L2768, L2780, L2785,
    L2795, L2800, L2810, L2820,
    L2830, L2840, L2850, L2999,
    L4002, L4010, L4020, L4030,
    L4040, L4045, L4050, L4055,
    L4060, L4070, L4080, L4090,
    L4100, L4110, L4130, L4205,
    L4210, L4350, L4360, L4361,
    L4370, L4386, L4387, L4392,
    L4394, L4396, L4397, L4398,
    L4631"
    )),
  split_string(
    single_line_string(
      "90460, 90461, 90471, 90472,
    90473, 90474, 90619, 90620,
    90621, 90633, 90647, 90648,
    90651, 90670, 90672, 90674,
    90680, 90681, 90682, 90685,
    90686, 90687, 90688, 90696,
    90697, 90698, 90700, 90702,
    90707, 90710, 90713, 90714,
    90715, 90716, 90723, 90732,
    90734, 90740, 90743, 90744,
    90746, 90747, 90749, 90756"
    ))) |>
  unlist(use.names = FALSE)
