<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Andrew Allen Bruce">
<meta name="dcterms.date" content="2024-11-28">
<meta name="description" content="Building a regex generator for self-contained, well-defined string detection problems is a very effective way to learn regular expressions.">
<title>Learning to Love Regexes By Learning Them – acéphale</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-cc6107df646ca5ad5b0f4c970cb58fb1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-1ca5a79d274462985c6a5f2263972063.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<meta property="og:title" content="Learning to Love Regexes By Learning Them – acéphale">
<meta property="og:description" content="Building a regex generator for self-contained, well-defined string detection problems is a very effective way to learn regular expressions.">
<meta property="og:site_name" content="acéphale">
<meta property="og:locale" content="en_US">
<meta name="twitter:title" content="Learning to Love Regexes By Learning Them – acéphale">
<meta name="twitter:description" content="Building a regex generator for self-contained, well-defined string detection problems is a very effective way to learn regular expressions.">
<meta name="twitter:creator" content="@andrewallbruce">
<meta name="twitter:card" content="summary">
</head>
<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">acéphale</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/andrewallenbruce"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/andrewallbruce"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/andrewallenbruce/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Learning to Love Regexes By Learning Them</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i></button></div></div>
            <p class="subtitle lead">I Promised Myself I Wouldn’t Do This Again</p>
                  <div>
        <div class="description">
          Building a regex generator for self-contained, well-defined string detection problems is a very effective way to learn regular expressions.
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p><a href="https://andrewallenbruce.github.io">Andrew Allen Bruce</a> <a href="mailto:andrewallenbruce@gmail.com" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Last updated</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 28, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="3"><h2 id="toc-title">Contents</h2>
   
  <ul>
<li><a href="#todo" id="toc-todo" class="nav-link active" data-scroll-target="#todo">TODO</a></li>
  <li><a href="#preprocess-steps" id="toc-preprocess-steps" class="nav-link" data-scroll-target="#preprocess-steps"><span class="header-section-number">1</span> Preprocess Steps</a></li>
  <li><a href="#process-groups" id="toc-process-groups" class="nav-link" data-scroll-target="#process-groups"><span class="header-section-number">2</span> Process Groups</a></li>
  <li><a href="#reduce-groups" id="toc-reduce-groups" class="nav-link" data-scroll-target="#reduce-groups"><span class="header-section-number">3</span> Reduce Groups</a></li>
  <li><a href="#recombine-vectors" id="toc-recombine-vectors" class="nav-link" data-scroll-target="#recombine-vectors"><span class="header-section-number">4</span> Recombine Vectors</a></li>
  <li><a href="#collapse-regex" id="toc-collapse-regex" class="nav-link" data-scroll-target="#collapse-regex"><span class="header-section-number">5</span> Collapse Regex</a></li>
  <li>
<a href="#s7-class" id="toc-s7-class" class="nav-link" data-scroll-target="#s7-class"><span class="header-section-number">6</span> S7 Class</a>
  <ul class="collapse">
<li><a href="#session-information" id="toc-session-information" class="nav-link" data-scroll-target="#session-information"><span class="header-section-number">6.1</span> Session Information</a></li>
  </ul>
</li>
  </ul><div class="quarto-other-links"><h2>Other Links</h2><ul><li><a href="https://github.com/raredd/regex"><i class="bi bi-bookmark-plus"></i>Regex Cheatsheet</a></li><li><a href="https://www.rexegg.com/"><i class="bi bi-bookmark-plus"></i>RexEgg</a></li><li><a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/regex.html"><i class="bi bi-bookmark-plus"></i>Regex in R</a></li></ul></div></nav>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content"><section id="todo" class="level1 unnumbered"><h1 class="unnumbered">TODO</h1>
<ul>
<li>The <em>postfix</em> for a <strong>wildcard</strong> that begins with a <strong>letter</strong> is <code>[0-9]{n}</code>.</li>
<li>In <code>remove_redundant()</code>, try pmap for <code>rr()</code> step.</li>
<li>Groups 3, 4 &amp; 5 beginning with letters.</li>
<li>Group 5 ending with letters.</li>
</ul>
<div style="page-break-after: always;"></div>
<div id="note-good" class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Good Examples
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<section id="case-1" class="level3"><h3 class="anchored" data-anchor-id="case-1">Case 1</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"L80"</span>, </span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"L56"</span>, <span class="st">"L59"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu">sf_extract</span><span class="op">(</span><span class="va">hcpcs</span>, <span class="st">"^L56|^L59|^L80"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu">sf_extract</span><span class="op">(</span><span class="va">hcpcs</span>, <span class="st">"^L(5[69]|80)[0-9]{2}$"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">bench</span><span class="fu">::</span><span class="fu"><a href="http://bench.r-lib.org/reference/mark.html">mark</a></span><span class="op">(</span></span>
<span>  raw <span class="op">=</span> <span class="fu">sf_extract</span><span class="op">(</span><span class="va">hcpcs</span>, <span class="st">"^L56|^L59|^L80"</span><span class="op">)</span>,</span>
<span>  compact <span class="op">=</span> <span class="fu">sf_extract</span><span class="op">(</span><span class="va">hcpcs</span>, <span class="st">"^L(5[69]|80)[0-9]{2}$"</span><span class="op">)</span>,</span>
<span>  iterations <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">expression</span><span class="op">:</span><span class="va">total_time</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="case-2" class="level3"><h3 class="anchored" data-anchor-id="case-2">Case 2</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"021"</span>, <span class="st">"022"</span>, <span class="st">"026"</span>, <span class="st">"027"</span><span class="op">)</span>, </span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"032"</span>, <span class="st">"033"</span><span class="op">)</span>, </span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"042"</span>, <span class="st">"044"</span><span class="op">)</span>, </span>
<span>     <span class="st">"050"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">bench</span><span class="fu">::</span><span class="fu"><a href="http://bench.r-lib.org/reference/mark.html">mark</a></span><span class="op">(</span></span>
<span>  raw <span class="op">=</span> <span class="fu">sf_extract</span><span class="op">(</span><span class="va">hcpcs</span>, <span class="st">"^021|^022|^026|^027|^032|^033|^042|^044|^050"</span><span class="op">)</span>,</span>
<span>  compact <span class="op">=</span> <span class="fu">sf_extract</span><span class="op">(</span><span class="va">hcpcs</span>, <span class="fu">sf_convert</span><span class="op">(</span><span class="st">"^0(2[1267]|3[23]|4[24]|50)[A-Z0-9]{2}$"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  iterations <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">expression</span><span class="op">:</span><span class="va">total_time</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="case-3" class="level3"><h3 class="anchored" data-anchor-id="case-3">Case 3</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"C75"</span>, <span class="st">"C97"</span><span class="op">)</span>,</span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"G02"</span>, <span class="st">"G04"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu">sf_extract</span><span class="op">(</span><span class="va">hcpcs</span>, <span class="st">"^C75|^C97|^G02|^G04"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu">sf_extract</span><span class="op">(</span><span class="va">hcpcs</span>, <span class="st">"^C(75|97)[0-9]{2}$|^G0[24][0-9]{2}$"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu">sf_extract</span><span class="op">(</span><span class="va">hcpcs</span>, <span class="st">"^(C(75|97)|G0[24])[0-9]{2}$"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">bench</span><span class="fu">::</span><span class="fu"><a href="http://bench.r-lib.org/reference/mark.html">mark</a></span><span class="op">(</span></span>
<span>  raw <span class="op">=</span> <span class="fu">sf_extract</span><span class="op">(</span><span class="va">hcpcs</span>, <span class="st">"^C75|^C97|^G02|^G04"</span><span class="op">)</span>,</span>
<span>  reduced <span class="op">=</span> <span class="fu">sf_extract</span><span class="op">(</span><span class="va">hcpcs</span>, <span class="st">"^C(75|97)[0-9]{2}$|^G0[24][0-9]{2}$"</span><span class="op">)</span>,</span>
<span>  compact <span class="op">=</span> <span class="fu">sf_extract</span><span class="op">(</span><span class="va">hcpcs</span>, <span class="fu">sf_convert</span><span class="op">(</span><span class="st">"^(C(75|97)|G0[24])[0-9]{2}$"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  iterations <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">expression</span><span class="op">:</span><span class="va">total_time</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="case-4" class="level3"><h3 class="anchored" data-anchor-id="case-4">Case 4</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"0[2-5]"</span>, </span>
<span>     <span class="st">"15"</span>, </span>
<span>     <span class="st">"2[027]"</span>, </span>
<span>     <span class="st">"3[0-24-6]"</span>, </span>
<span>     <span class="st">"5[0458]"</span>, </span>
<span>     <span class="st">"6[134]"</span>, </span>
<span>     <span class="st">"76"</span>, </span>
<span>     <span class="st">"9[25]"</span>, </span>
<span>     <span class="st">"C[79]"</span>, </span>
<span>     <span class="st">"E0"</span>, </span>
<span>     <span class="st">"G0"</span>, </span>
<span>     <span class="st">"S2"</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">c4list</span></span>
<span></span>
<span><span class="va">c4list</span></span>
<span></span>
<span><span class="va">c4raw</span> <span class="op">&lt;-</span> <span class="st">"^02|^03|^04|^05|^15|^20|^22|^27|^30|^31|^32|^34|^35|^36|^50|^54|^55|^58|^61|^63|^64|^76|^92|^95|^C7|^C9|^E0|^G0|^S2"</span></span>
<span></span>
<span><span class="va">c4compact</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"^("</span>, <span class="fu">sf_collapse</span><span class="op">(</span><span class="fu">list_c</span><span class="op">(</span><span class="va">c4list</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">"|"</span><span class="op">)</span>, <span class="st">")[A-Z0-9]{3}$"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu">sf_extract</span><span class="op">(</span><span class="va">hcpcs</span>, <span class="va">c4raw</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu">sf_extract</span><span class="op">(</span><span class="va">hcpcs</span>, <span class="va">c4compact</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">bench</span><span class="fu">::</span><span class="fu"><a href="http://bench.r-lib.org/reference/mark.html">mark</a></span><span class="op">(</span></span>
<span>  raw <span class="op">=</span> <span class="fu">sf_extract</span><span class="op">(</span><span class="va">hcpcs</span>, <span class="va">c4raw</span><span class="op">)</span>,</span>
<span>  compact <span class="op">=</span> <span class="fu">sf_extract</span><span class="op">(</span><span class="va">hcpcs</span>, <span class="va">c4compact</span><span class="op">)</span>,</span>
<span>  iterations <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">expression</span><span class="op">:</span><span class="va">total_time</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</div>
</div>
</div>
<hr></section><section id="preprocess-steps" class="level1" data-number="1"><h1 data-number="1">
<span class="header-section-number">1</span> Preprocess Steps</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">view</span> <span class="op">&lt;-</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">grp_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">grp_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu">vlen</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, justify <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></span>
<span>  <span class="va">grp_mems</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/modify.html">modify_if</a></span><span class="op">(</span></span>
<span>    <span class="va">x</span>, <span class="fu">vctrs</span><span class="fu">::</span><span class="va"><a href="https://vctrs.r-lib.org/reference/obj_is_list.html">obj_is_list</a></span>, </span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"("</span>, <span class="fu">map_chr</span><span class="op">(</span><span class="va">x</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">x</span>, collapse <span class="op">=</span> <span class="st">" "</span><span class="op">)</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">grp_mems</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="va">grp_mems</span><span class="op">)</span>, justify <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span>  <span class="va">grp_mems</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">grp_mems</span><span class="op">)</span><span class="op">)</span> <span class="cn">NULL</span> <span class="kw">else</span> <span class="va">grp_mems</span></span>
<span>  </span>
<span>  <span class="va">msg</span> <span class="op">&lt;-</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span></span>
<span>      <span class="st">"{grp_name}: "</span>,</span>
<span>      <span class="st">"{grp_size}|"</span>,</span>
<span>      <span class="st">"-[{grp_mems}]"</span></span>
<span>      <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cat_line.html">cat_bullet</a></span><span class="op">(</span><span class="va">msg</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">random_hcpcs</span><span class="op">(</span><span class="fl">50</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">view</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>• 1:  3|-[6, C, L]
• 2: 41|-[01, 02, 04, 05, 06, 21, 23, 27, 28, 29, 30, 41, 43, 50, 57, 66, 67, 75, 82, 92, 97, 99, A6, A7, A9, E0, G0, G1, G8, G9, J0, J2, J3, K0, L1, L3, L5, L6, Q4, T2, V2]
• 3: 43|-[002, 006, 011, 019, 117, 158, 278, 358, 377, 430, 475, 530, 546, 572, 605, 644, 674, 712, 737, 812, 845, 911, 924, 932, 959, 963, A47, C93, E06, G88, G92, J03, J34, J71, K00, M10, Q41, S02, S21, S40, S93, S94, T20]
• 4: 49|-[1110, 1728, 1928, 2022, 2093, 2143, 2193, 2644, 2782, 2789, 3140, 3165, 3351, 3621, 4538, 5032, 5108, 5192, 5660, 6455, 6527, 8136, 8241, 8260, 8296, 8747, 9356, 9379, 9578, 9948, E047, E109, G926, G938, G940, G982, J029, J100, J180, J717, K081, K087, L660, M100, M134, Q422, Q424, S903, V275]
• 5: 50|-[00474, 00870, 0106T, 0313T, 0624T, 11302, 21199, 3066F, 31300, 33951, 33960, 35600, 43284, 45915, 49540, 58353, 58553, 58674, 67113, 74455, 82172, 86146, 86832, 87487, 90736, 92507, 95831, 96111, A5083, C9724, C9742, D7140, E0860, E2100, G2126, G8465, G8497, G8881, G9275, G9899, J0457, J1451, J2941, K0885, L3465, L5642, M1120, Q0479, S3005, V5298]</code></pre>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">view</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>• 1:  3|-[6, C, L]
• 2: 35|-[01, 02, 04, 05, 06, 21, 23, 27, 28, 29, 30, 41, 43, 50, 57, 75, 82, 92, 97, 99, A6, A7, A9, E0, G0, G1, G8, G9, J0, J2, J3, K0, Q4, T2, V2]
• 3: 25|-[002, 006, 117, 158, 358, 377, 475, 530, 546, 712, 737, 812, 845, 911, 932, 959, 963, A47, J71, M10, S02, S21, S40, S93, S94]
• 4: 24|-[1110, 1728, 1928, 2022, 2093, 2644, 3140, 3165, 3351, 3621, 4538, 5108, 5192, 5660, 8136, 8747, 9356, 9379, 9578, E109, J100, J180, M134, S903]
• 5: 29|-[00474, 00870, 0313T, 11302, 31300, 33951, 33960, 35600, 45915, 49540, 58353, 58553, 58674, 74455, 86146, 86832, 87487, 90736, 95831, 96111, A5083, D7140, E2100, G2126, J1451, M1120, Q0479, S3005, V5298]</code></pre>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">view</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>• 1:  3|-[6, C, L]
• 2: 16|-[(01 02 04 05 06), (21 23 27 28 29), (30), (41 43), (50 57), (75), (82), (92 97 99), (A6 A7 A9), (E0), (G0 G1 G8 G9), (J0 J2 J3), (K0), (Q4), (T2), (V2)]
• 3: 12|-[(002 006), (117 158), (358 377), (475), (530 546), (712 737), (812 845), (911 932 959 963), (A47), (J71), (M10), (S02 S21 S40 S93 S94)]
• 4: 11|-[(1110 1728 1928), (2022 2093 2644), (3140 3165 3351 3621), (4538), (5108 5192 5660), (8136 8747), (9356 9379 9578), (E109), (J100 J180), (M134), (S903)]
• 5: 18|-[(00474 00870), (11302), (31300 33951 33960 35600), (45915 49540), (58353 58553 58674), (74455), (86146 86832 87487), (90736 95831 96111), (A5083), (D7140), (E2100), (G2126), (J1451), (M1120), (Q0479), (S3005), (V5298), (0313T)]</code></pre>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">random_hcpcs</span><span class="op">(</span><span class="fl">50</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">view</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>• 1:  4|-[3, Q, S, V]
• 2: 12|-[(00 02 03), (20 21), (51 53 54 59), (61 63 65 69), (74 77), (81 83), (95 96 97 99), (A4 A7), (C9), (G0 G1 G8 G9), (J0 J2 J3 J7), (L1 L6)]
• 3: 15|-[(140 158), (231 238 258 275 286), (467 475 496), (566 572), (649), (864 874 882), (913 925), (A65 A95), (C75), (E01 E15 E23), (G20), (J18 J90), (K00 K10), (L08 L34 L57), (M12)]
• 4: 13|-[(0626 0744), (2281 2822 2829 2875), (4164 4281 4310 4440), (5060 5250 5855), (7003 7361), (8449 8663), (9037 9231 9326 9466), (A619), (E046), (J921), (K085), (L064 L227 L359), (P907)]
• 5: 16|-[(01842 01965), (29875), (41007 45307), (52450 55060), (66988), (73000), (82760 84075 86941 87802), (93292), (A0998), (D7240), (E0485), (J1304 J1443), (L8048), (M1029), (6005F), (0142U)]</code></pre>
</div>
</div>
<hr>
<div style="page-break-after: always;"></div>
</section><section id="process-groups" class="level1" data-number="2"><h1 data-number="2">
<span class="header-section-number">2</span> Process Groups</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Group 3</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Group 4</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Group 5</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">process_groups</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"C75"</span>, <span class="st">"C97"</span>, <span class="st">"G02"</span>, <span class="st">"G04"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_3</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">view</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>• 1: 2|-[(C75), (C97)]
• 2: 1|-[(G02 G04)]</code></pre>
</div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">long_test2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span><span class="op">(</span><span class="va">long_test2</span><span class="op">)</span> <span class="op">==</span> <span class="fl">3</span><span class="op">]</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_3</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[[1]][[1]]
[1] "021" "022" "026" "027"

[[1]][[2]]
[1] "032" "033"

[[1]][[3]]
[1] "042" "044"

[[1]][[4]]
[1] "050"


[[2]]
[[2]][[1]]
[1] "157"


[[3]]
[[3]][[1]]
[1] "209"

[[3]][[2]]
[1] "225"

[[3]][[3]]
[1] "271"


[[4]]
[[4]][[1]]
[1] "308"

[[4]][[2]]
[1] "312"

[[4]][[3]]
[1] "326"

[[4]][[4]]
[1] "347" "348"

[[4]][[5]]
[1] "355"

[[4]][[6]]
[1] "362"


[[5]]
[[5]][[1]]
[1] "503" "505"

[[5]][[2]]
[1] "544"

[[5]][[3]]
[1] "552" "553"

[[5]][[4]]
[1] "585" "586" "587" "588" "589"


[[6]]
[[6]][[1]]
[1] "610" "612"

[[6]][[2]]
[1] "630"

[[6]][[3]]
[1] "644" "646"


[[7]]
[[7]][[1]]
[1] "765"


[[8]]
[[8]][[1]]
[1] "920" "921" "922"

[[8]][[2]]
[1] "958"


[[9]]
[[9]][[1]]
[1] "C75"

[[9]][[2]]
[1] "C97"


[[10]]
[[10]][[1]]
[1] "E06"


[[11]]
[[11]][[1]]
[1] "G02" "G04"


[[12]]
[[12]][[1]]
[1] "S23"</code></pre>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">random_hcpcs</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_3</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[[1]][[1]]
[1] "000"

[[1]][[2]]
[1] "010"


[[2]]
[[2]][[1]]
[1] "426"


[[3]]
[[3]][[1]]
[1] "647"


[[4]]
[[4]][[1]]
[1] "995"


[[5]]
[[5]][[1]]
[1] "J05"


[[6]]
[[6]][[1]]
[1] "L68"


[[7]]
[[7]][[1]]
[1] "M12"</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">old_group_4</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">getelem</span><span class="op">(</span><span class="va">x</span>, <span class="st">"x4"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">map</span><span class="op">(</span><span class="va">x</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="op">(</span></span>
<span>      code <span class="op">=</span> <span class="va">x</span>,</span>
<span>      grp1 <span class="op">=</span> <span class="fu">sf_sub</span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>      grp2 <span class="op">=</span> <span class="fu">sf_sub</span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>      a1 <span class="op">=</span> <span class="fu">take_at</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>      a2 <span class="op">=</span> <span class="fu">take_at</span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>      a3 <span class="op">=</span> <span class="fu">take_at</span><span class="op">(</span><span class="va">x</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>      a4 <span class="op">=</span> <span class="fu">take_at</span><span class="op">(</span><span class="va">x</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>      i1 <span class="op">=</span> <span class="fu">groupid</span><span class="op">(</span><span class="fu">take_at</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"Initial data frame"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">idx</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">idx</span> <span class="op">&lt;-</span> <span class="va">idx</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">fgroup_by</span><span class="op">(</span><span class="va">a1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">fmutate</span><span class="op">(</span>i2 <span class="op">=</span> <span class="fu">groupid</span><span class="op">(</span><span class="va">a2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">fgroup_by</span><span class="op">(</span><span class="va">a1</span>, <span class="va">a2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">fmutate</span><span class="op">(</span>i3 <span class="op">=</span> <span class="fu">groupid</span><span class="op">(</span><span class="va">a3</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">fgroup_by</span><span class="op">(</span><span class="va">a1</span>, <span class="va">a2</span>, <span class="va">a3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">fmutate</span><span class="op">(</span>i4 <span class="op">=</span> <span class="fu">groupid</span><span class="op">(</span><span class="va">a4</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">fungroup</span><span class="op">(</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"Grouped data frame"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">idx</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">lone</span> <span class="op">&lt;-</span> <span class="fu">fcount</span><span class="op">(</span><span class="va">idx</span>, <span class="va">i1</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">fmutate</span><span class="op">(</span>`i2 + i3 + i4 + N` <span class="op">=</span> <span class="va">i2</span> <span class="op">+</span> <span class="va">i3</span> <span class="op">+</span> <span class="va">i4</span> <span class="op">+</span> <span class="va">N</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"Lone Counted"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">lone</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">lone</span> <span class="op">&lt;-</span> <span class="va">lone</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">fsubset</span><span class="op">(</span><span class="op">(</span><span class="va">i2</span> <span class="op">+</span> <span class="va">i3</span> <span class="op">+</span> <span class="va">i4</span> <span class="op">+</span> <span class="va">N</span><span class="op">)</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"Lone i2 + i3 + i4 + N == 4"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">lone</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">last</span> <span class="op">&lt;-</span> <span class="fu">fsubset</span><span class="op">(</span><span class="va">idx</span>, <span class="va">code</span> <span class="op">%!in%</span> <span class="va">lone</span><span class="op">[[</span><span class="st">"code"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"Last Filtered"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">last</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">last</span> <span class="op">&lt;-</span> <span class="fu">join</span><span class="op">(</span></span>
<span>      <span class="fu">fcount</span><span class="op">(</span><span class="va">last</span>, <span class="va">grp1</span>, <span class="va">a3</span><span class="op">)</span>,</span>
<span>      <span class="fu">fcount</span><span class="op">(</span><span class="va">last</span>, <span class="va">grp1</span>, name <span class="op">=</span> <span class="st">"G"</span><span class="op">)</span>,</span>
<span>      on <span class="op">=</span> <span class="st">"grp1"</span>,</span>
<span>      verbose <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">fsubset</span><span class="op">(</span><span class="va">N</span> <span class="op">==</span> <span class="va">G</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">join</span><span class="op">(</span></span>
<span>        <span class="va">last</span>,</span>
<span>        on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"grp1"</span>, <span class="st">"a3"</span><span class="op">)</span>,</span>
<span>        how <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>        verbose <span class="op">=</span> <span class="fl">0</span></span>
<span>      <span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"Last Joined"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">last</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">last</span> <span class="op">&lt;-</span> <span class="va">last</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">fsubset</span><span class="op">(</span><span class="fu">not_na</span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"Last Filtered"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">last</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">rest</span> <span class="op">&lt;-</span> <span class="fu">fsubset</span><span class="op">(</span><span class="va">idx</span>, <span class="va">code</span> <span class="op">%!in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">lone</span><span class="op">[[</span><span class="st">"code"</span><span class="op">]</span><span class="op">]</span>, <span class="va">last</span><span class="op">[[</span><span class="st">"code"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"Rest Filtered"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">rest</span><span class="op">)</span></span>
<span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">lone</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="cn">NULL</span></span>
<span>      <span class="kw">else</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">lone</span><span class="op">[[</span><span class="st">"code"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">last</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="cn">NULL</span></span>
<span>      <span class="kw">else</span></span>
<span>        <span class="fu">gchop</span><span class="op">(</span><span class="va">last</span><span class="op">[[</span><span class="st">"code"</span><span class="op">]</span><span class="op">]</span>, <span class="va">last</span><span class="op">[[</span><span class="st">"grp1"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">rest</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="cn">NULL</span></span>
<span>      <span class="kw">else</span></span>
<span>        <span class="fu">gchop</span><span class="op">(</span><span class="va">rest</span><span class="op">[[</span><span class="st">"code"</span><span class="op">]</span><span class="op">]</span>, <span class="va">rest</span><span class="op">[[</span><span class="st">"grp2"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"C751"</span>, <span class="st">"C752"</span>, <span class="st">"C970"</span>, <span class="st">"G020"</span>, <span class="st">"G021"</span>, <span class="st">"G040"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">old_group_4</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Initial data frame</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     code   grp1   grp2     a1     a2     a3     a4   i1
   &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;qG&gt;
1:   C751     C7    C75      C      7      5      1    1
2:   C752     C7    C75      C      7      5      2    1
3:   C970     C9    C97      C      9      7      0    1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Grouped data frame</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     code   grp1   grp2     a1     a2     a3     a4   i1    i2    i3    i4
   &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;qG&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
1:   C751     C7    C75      C      7      5      1    1     1     1     1
2:   C752     C7    C75      C      7      5      2    1     1     1     2
3:   C970     C9    C97      C      9      7      0    1     2     1     1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Lone Counted</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     code   grp1   grp2     a1     a2     a3     a4   i1    i2    i3    i4
   &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;qG&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
1:   C751     C7    C75      C      7      5      1    1     1     1     1
2:   C752     C7    C75      C      7      5      2    1     1     1     2
3:   C970     C9    C97      C      9      7      0    1     2     1     1
       N i2 + i3 + i4 + N
   &lt;int&gt;            &lt;int&gt;
1:     3                6
2:     3                7
3:     3                7</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Lone i2 + i3 + i4 + N == 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Empty data.table (0 rows and 13 cols): code,grp1,grp2,a1,a2,a3...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Last Filtered</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     code   grp1   grp2     a1     a2     a3     a4   i1    i2    i3    i4
   &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;qG&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
1:   C751     C7    C75      C      7      5      1    1     1     1     1
2:   C752     C7    C75      C      7      5      2    1     1     1     2
3:   C970     C9    C97      C      9      7      0    1     2     1     1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Last Joined</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     grp1     a3     N     G   code   grp2     a1     a2     a4   i1    i2
   &lt;char&gt; &lt;char&gt; &lt;int&gt; &lt;int&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;qG&gt; &lt;int&gt;
1:     C7      5     2     2   C751    C75      C      7      1    1     1
2:     C7      5     2     2   C752    C75      C      7      2    1     1
3:     C9      7     1     1   C970    C97      C      9      0    1     2
      i3    i4
   &lt;int&gt; &lt;int&gt;
1:     1     1
2:     1     2
3:     1     1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Last Filtered</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     grp1     a3     N     G   code   grp2     a1     a2     a4   i1    i2
   &lt;char&gt; &lt;char&gt; &lt;int&gt; &lt;int&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;qG&gt; &lt;int&gt;
1:     C7      5     2     2   C751    C75      C      7      1    1     1
2:     C7      5     2     2   C752    C75      C      7      2    1     1
3:     C9      7     1     1   C970    C97      C      9      0    1     2
      i3    i4
   &lt;int&gt; &lt;int&gt;
1:     1     1
2:     1     2
3:     1     1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Rest Filtered</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Empty data.table (0 rows and 11 cols): code,grp1,grp2,a1,a2,a3...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Initial data frame</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     code   grp1   grp2     a1     a2     a3     a4   i1
   &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;qG&gt;
1:   G020     G0    G02      G      0      2      0    1
2:   G021     G0    G02      G      0      2      1    1
3:   G040     G0    G04      G      0      4      0    1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Grouped data frame</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     code   grp1   grp2     a1     a2     a3     a4   i1    i2    i3    i4
   &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;qG&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
1:   G020     G0    G02      G      0      2      0    1     1     1     1
2:   G021     G0    G02      G      0      2      1    1     1     1     2
3:   G040     G0    G04      G      0      4      0    1     1     2     1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Lone Counted</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     code   grp1   grp2     a1     a2     a3     a4   i1    i2    i3    i4
   &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;qG&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
1:   G020     G0    G02      G      0      2      0    1     1     1     1
2:   G021     G0    G02      G      0      2      1    1     1     1     2
3:   G040     G0    G04      G      0      4      0    1     1     2     1
       N i2 + i3 + i4 + N
   &lt;int&gt;            &lt;int&gt;
1:     3                6
2:     3                7
3:     3                7</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Lone i2 + i3 + i4 + N == 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Empty data.table (0 rows and 13 cols): code,grp1,grp2,a1,a2,a3...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Last Filtered</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     code   grp1   grp2     a1     a2     a3     a4   i1    i2    i3    i4
   &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;qG&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
1:   G020     G0    G02      G      0      2      0    1     1     1     1
2:   G021     G0    G02      G      0      2      1    1     1     1     2
3:   G040     G0    G04      G      0      4      0    1     1     2     1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Last Joined</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     grp1     a3     N     G   code   grp2     a1     a2     a4   i1    i2
   &lt;char&gt; &lt;char&gt; &lt;int&gt; &lt;int&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;qG&gt; &lt;int&gt;
1:     G0      2    NA    NA   G020    G02      G      0      0    1     1
2:     G0      2    NA    NA   G021    G02      G      0      1    1     1
3:     G0      4    NA    NA   G040    G04      G      0      0    1     1
      i3    i4
   &lt;int&gt; &lt;int&gt;
1:     1     1
2:     1     2
3:     2     1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Last Filtered</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Empty data.table (0 rows and 13 cols): grp1,a3,N,G,code,grp2...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Rest Filtered</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     code   grp1   grp2     a1     a2     a3     a4   i1    i2    i3    i4
   &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;qG&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
1:   G020     G0    G02      G      0      2      0    1     1     1     1
2:   G021     G0    G02      G      0      2      1    1     1     1     2
3:   G040     G0    G04      G      0      4      0    1     1     2     1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[[1]][[1]]
[1] "C751" "C752"

[[1]][[2]]
[1] "C970"


[[2]]
[[2]][[1]]
[1] "G020" "G021"

[[2]][[2]]
[1] "G040"</code></pre>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">group_5_num</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="fu">map</span><span class="op">(</span><span class="va">x</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="op">(</span></span>
<span>      code <span class="op">=</span> <span class="va">x</span>,</span>
<span>      grp1 <span class="op">=</span> <span class="fu">sf_sub</span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>      grp2 <span class="op">=</span> <span class="fu">sf_sub</span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>      grp3 <span class="op">=</span> <span class="fu">sf_sub</span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>      a1 <span class="op">=</span> <span class="fu">take_at</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>      a2 <span class="op">=</span> <span class="fu">take_at</span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>      a3 <span class="op">=</span> <span class="fu">take_at</span><span class="op">(</span><span class="va">x</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>      a4 <span class="op">=</span> <span class="fu">take_at</span><span class="op">(</span><span class="va">x</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>      a5 <span class="op">=</span> <span class="fu">take_at</span><span class="op">(</span><span class="va">x</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>      i1 <span class="op">=</span> <span class="fu">groupid</span><span class="op">(</span><span class="fu">take_at</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">fgroup_by</span><span class="op">(</span><span class="va">a1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu">fmutate</span><span class="op">(</span>i2 <span class="op">=</span> <span class="fu">groupid</span><span class="op">(</span><span class="va">a2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">fgroup_by</span><span class="op">(</span><span class="va">a1</span>, <span class="va">a2</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu">fmutate</span><span class="op">(</span>i3 <span class="op">=</span> <span class="fu">groupid</span><span class="op">(</span><span class="va">a3</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">fgroup_by</span><span class="op">(</span><span class="va">a1</span>, <span class="va">a2</span>, <span class="va">a3</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu">fmutate</span><span class="op">(</span>i4 <span class="op">=</span> <span class="fu">groupid</span><span class="op">(</span><span class="va">a4</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">fgroup_by</span><span class="op">(</span><span class="va">a1</span>, <span class="va">a2</span>, <span class="va">a3</span>, <span class="va">a4</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu">fmutate</span><span class="op">(</span>i5 <span class="op">=</span> <span class="fu">groupid</span><span class="op">(</span><span class="va">a5</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu">fungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>      <span class="va">lone</span> <span class="op">&lt;-</span> <span class="fu">fcount</span><span class="op">(</span><span class="va">idx</span>, <span class="va">i1</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu">fsubset</span><span class="op">(</span><span class="op">(</span><span class="va">i2</span> <span class="op">+</span> <span class="va">i3</span> <span class="op">+</span> <span class="va">i4</span> <span class="op">+</span> <span class="va">i5</span> <span class="op">+</span> <span class="va">N</span><span class="op">)</span> <span class="op">==</span> <span class="fl">5</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="va">last</span> <span class="op">&lt;-</span> <span class="fu">fsubset</span><span class="op">(</span><span class="va">idx</span>, <span class="va">code</span> <span class="op">%!in%</span> <span class="va">lone</span><span class="op">[[</span><span class="st">"code"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="va">last</span> <span class="op">&lt;-</span> <span class="fu">join</span><span class="op">(</span></span>
<span>        <span class="fu">fcount</span><span class="op">(</span><span class="va">last</span>, <span class="va">grp2</span>, <span class="va">a4</span><span class="op">)</span>,</span>
<span>        <span class="fu">fcount</span><span class="op">(</span><span class="va">last</span>, <span class="va">grp2</span>, name <span class="op">=</span> <span class="st">"G"</span><span class="op">)</span>, on <span class="op">=</span> <span class="st">"grp2"</span>, verbose <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">fsubset</span><span class="op">(</span><span class="va">N</span> <span class="op">==</span> <span class="va">G</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">join</span><span class="op">(</span><span class="va">last</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"grp2"</span>, <span class="st">"a4"</span><span class="op">)</span>, how <span class="op">=</span> <span class="st">"right"</span>, verbose <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu">fsubset</span><span class="op">(</span><span class="fu">not_na</span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="va">rest</span> <span class="op">&lt;-</span> <span class="fu">fsubset</span><span class="op">(</span><span class="va">idx</span>, <span class="va">code</span> <span class="op">%!in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">lone</span><span class="op">[[</span><span class="st">"code"</span><span class="op">]</span><span class="op">]</span>, <span class="va">last</span><span class="op">[[</span><span class="st">"code"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">lone</span><span class="op">)</span><span class="op">)</span> <span class="cn">NULL</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">lone</span><span class="op">[[</span><span class="st">"code"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">last</span><span class="op">)</span><span class="op">)</span> <span class="cn">NULL</span> <span class="kw">else</span> <span class="fu">gchop</span><span class="op">(</span><span class="va">last</span><span class="op">[[</span><span class="st">"code"</span><span class="op">]</span><span class="op">]</span>, <span class="va">last</span><span class="op">[[</span><span class="st">"grp2"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">rest</span><span class="op">)</span><span class="op">)</span> <span class="cn">NULL</span> <span class="kw">else</span> <span class="fu">gchop</span><span class="op">(</span><span class="va">rest</span><span class="op">[[</span><span class="st">"code"</span><span class="op">]</span><span class="op">]</span>, <span class="va">rest</span><span class="op">[[</span><span class="st">"grp3"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">group_5_chr</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">original</span> <span class="op">&lt;-</span> <span class="va">x</span></span>
<span>  </span>
<span>  <span class="va">reversed</span> <span class="op">&lt;-</span> <span class="fu">map</span><span class="op">(</span></span>
<span>    <span class="va">original</span>, </span>
<span>    \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span></span>
<span>      <span class="fu">take_at</span><span class="op">(</span><span class="va">x</span>, <span class="fl">5</span><span class="op">)</span>, </span>
<span>      <span class="fu">sf_remove</span><span class="op">(</span><span class="va">x</span>, <span class="st">"[A-Z]$"</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>  <span class="fu">map2</span><span class="op">(</span><span class="va">reversed</span>, <span class="va">original</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="op">(</span></span>
<span>      orig <span class="op">=</span> <span class="va">y</span>,</span>
<span>      code <span class="op">=</span> <span class="va">x</span>,</span>
<span>      grp1 <span class="op">=</span> <span class="fu">sf_sub</span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>      grp2 <span class="op">=</span> <span class="fu">sf_sub</span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>      grp3 <span class="op">=</span> <span class="fu">sf_sub</span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>      a1 <span class="op">=</span> <span class="fu">take_at</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>      a2 <span class="op">=</span> <span class="fu">take_at</span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>      a3 <span class="op">=</span> <span class="fu">take_at</span><span class="op">(</span><span class="va">x</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>      a4 <span class="op">=</span> <span class="fu">take_at</span><span class="op">(</span><span class="va">x</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>      a5 <span class="op">=</span> <span class="fu">take_at</span><span class="op">(</span><span class="va">x</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>      i1 <span class="op">=</span> <span class="fu">groupid</span><span class="op">(</span><span class="fu">take_at</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">fgroup_by</span><span class="op">(</span><span class="va">a1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu">fmutate</span><span class="op">(</span>i2 <span class="op">=</span> <span class="fu">groupid</span><span class="op">(</span><span class="va">a2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">fgroup_by</span><span class="op">(</span><span class="va">a1</span>, <span class="va">a2</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu">fmutate</span><span class="op">(</span>i3 <span class="op">=</span> <span class="fu">groupid</span><span class="op">(</span><span class="va">a3</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">fgroup_by</span><span class="op">(</span><span class="va">a1</span>, <span class="va">a2</span>, <span class="va">a3</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu">fmutate</span><span class="op">(</span>i4 <span class="op">=</span> <span class="fu">groupid</span><span class="op">(</span><span class="va">a4</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">fgroup_by</span><span class="op">(</span><span class="va">a1</span>, <span class="va">a2</span>, <span class="va">a3</span>, <span class="va">a4</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu">fmutate</span><span class="op">(</span>i5 <span class="op">=</span> <span class="fu">groupid</span><span class="op">(</span><span class="va">a5</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu">fungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>      <span class="va">lone</span> <span class="op">&lt;-</span> <span class="fu">fcount</span><span class="op">(</span><span class="va">idx</span>, <span class="va">i1</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu">fsubset</span><span class="op">(</span><span class="op">(</span><span class="va">i2</span> <span class="op">+</span> <span class="va">i3</span> <span class="op">+</span> <span class="va">i4</span> <span class="op">+</span> <span class="va">i5</span> <span class="op">+</span> <span class="va">N</span><span class="op">)</span> <span class="op">==</span> <span class="fl">5</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="va">last</span> <span class="op">&lt;-</span> <span class="fu">fsubset</span><span class="op">(</span><span class="va">idx</span>, <span class="va">code</span> <span class="op">%!in%</span> <span class="va">lone</span><span class="op">[[</span><span class="st">"code"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="va">last</span> <span class="op">&lt;-</span> <span class="fu">join</span><span class="op">(</span></span>
<span>        <span class="fu">fcount</span><span class="op">(</span><span class="va">last</span>, <span class="va">grp2</span>, <span class="va">a4</span><span class="op">)</span>,</span>
<span>        <span class="fu">fcount</span><span class="op">(</span><span class="va">last</span>, <span class="va">grp2</span>, name <span class="op">=</span> <span class="st">"G"</span><span class="op">)</span>, on <span class="op">=</span> <span class="st">"grp2"</span>, verbose <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">fsubset</span><span class="op">(</span><span class="va">N</span> <span class="op">==</span> <span class="va">G</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">join</span><span class="op">(</span><span class="va">last</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"grp2"</span>, <span class="st">"a4"</span><span class="op">)</span>, how <span class="op">=</span> <span class="st">"right"</span>, verbose <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu">fsubset</span><span class="op">(</span><span class="fu">not_na</span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="va">rest</span> <span class="op">&lt;-</span> <span class="fu">fsubset</span><span class="op">(</span><span class="va">idx</span>, <span class="va">code</span> <span class="op">%!in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">lone</span><span class="op">[[</span><span class="st">"code"</span><span class="op">]</span><span class="op">]</span>, <span class="va">last</span><span class="op">[[</span><span class="st">"code"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">lone</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="cn">NULL</span></span>
<span>      <span class="kw">else</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">lone</span><span class="op">[[</span><span class="st">"orig"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">last</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="cn">NULL</span></span>
<span>      <span class="kw">else</span></span>
<span>        <span class="fu">gchop</span><span class="op">(</span><span class="va">last</span><span class="op">[[</span><span class="st">"orig"</span><span class="op">]</span><span class="op">]</span>, <span class="va">last</span><span class="op">[[</span><span class="st">"grp1"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">rest</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="cn">NULL</span></span>
<span>      <span class="kw">else</span></span>
<span>        <span class="fu">gchop</span><span class="op">(</span><span class="va">rest</span><span class="op">[[</span><span class="st">"orig"</span><span class="op">]</span><span class="op">]</span>, <span class="va">rest</span><span class="op">[[</span><span class="st">"grp2"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">group_5</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">getelem</span><span class="op">(</span><span class="va">x</span>, <span class="st">"x5"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">chr</span> <span class="op">&lt;-</span> <span class="fu">map</span><span class="op">(</span><span class="va">x</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">sf_extract</span><span class="op">(</span><span class="va">x</span>, <span class="st">"[A-Z]$"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">compact</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">num</span> <span class="op">&lt;-</span> <span class="fu">map</span><span class="op">(</span><span class="va">x</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">sf_extract</span><span class="op">(</span><span class="va">x</span>, <span class="st">"[0-9]$"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">compact</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">chr</span><span class="op">)</span><span class="op">)</span> <span class="cn">NULL</span> <span class="kw">else</span> <span class="fu">group_5_chr</span><span class="op">(</span><span class="va">chr</span><span class="op">)</span>,</span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">num</span><span class="op">)</span><span class="op">)</span> <span class="cn">NULL</span> <span class="kw">else</span> <span class="fu">group_5_num</span><span class="op">(</span><span class="va">num</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"C7510"</span>, <span class="st">"C9701"</span>, <span class="st">"G0200"</span>, <span class="st">"G0400"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_5</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[[1]][[1]]
[1] "C7510"

[[1]][[2]]
[1] "C9701"


[[2]]
[[2]][[1]]
[1] "G0200"

[[2]][[2]]
[1] "G0400"</code></pre>
</div>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">long_test2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span><span class="op">(</span><span class="va">long_test2</span><span class="op">)</span> <span class="op">==</span> <span class="fl">5</span><span class="op">]</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_5</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">nametree</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in nametree(group_5(split_first(remove_redundant(split_lengths(long_test2[nchar(long_test2) == : could not find function "nametree"</code></pre>
</div>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">random_hcpcs</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_5</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[[1]][[1]]
[1] "3500F"


[[2]]
[[2]][[1]]
[1] "31513"


[[3]]
[[3]][[1]]
[1] "43810"


[[4]]
[[4]][[1]]
[1] "70545"


[[5]]
[[5]][[1]]
[1] "90646"


[[6]]
[[6]][[1]]
[1] "D6055"


[[7]]
[[7]][[1]]
[1] "J0558"

[[7]][[2]]
[1] "J1627"</code></pre>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">process_groups</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    g1 <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">x1</span>,</span>
<span>    g2 <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">x2</span>,</span>
<span>    g3 <span class="op">=</span> <span class="fu">group_3</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>    g4 <span class="op">=</span> <span class="fu">group_4</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>    g5 <span class="op">=</span> <span class="fu">group_5</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">hcpcs_tests</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">process_groups</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$g1
[1] "0" "4" "5" "6" "G" "J"

$g2
$g2[[1]]
[1] "30" "31" "32"


$g3
$g3[[1]]
$g3[[1]][[1]]
[1] "721" "722" "723" "724" "725" "726" "727" "728" "729"



$g4
list()

$g5
$g5[[1]]
$g5[[1]][[1]]
[1] "92015" "92016" "92017" "92018" "92019"</code></pre>
</div>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">long_test2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">process_groups</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$g1
 [1] "0" "1" "2" "3" "5" "6" "7" "9" "C" "E" "G" "S"

$g2
list()

$g3
list()

$g4
list()

$g5
list()</code></pre>
</div>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">random_hcpcs</span><span class="op">(</span><span class="fl">50</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">process_groups</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$g1
[1] "7" "M" "U"

$g2
$g2[[1]]
[1] "00" "06" "08"

$g2[[2]]
[1] "21" "27" "29"

$g2[[3]]
[1] "31" "32" "38"

$g2[[4]]
[1] "44" "45" "46"

$g2[[5]]
[1] "53" "54"

$g2[[6]]
[1] "68"

$g2[[7]]
[1] "81" "82" "86" "87"

$g2[[8]]
[1] "94" "97" "99"

$g2[[9]]
[1] "A4"

$g2[[10]]
[1] "C7" "C9"

$g2[[11]]
[1] "E0" "E1" "E2"

$g2[[12]]
[1] "G0" "G1" "G8" "G9"

$g2[[13]]
[1] "J2" "J3"

$g2[[14]]
[1] "K0"

$g2[[15]]
[1] "L4" "L6"

$g2[[16]]
[1] "S5"

$g2[[17]]
[1] "V5"


$g3
$g3[[1]]
$g3[[1]][[1]]
[1] "016"

$g3[[1]][[2]]
[1] "029"

$g3[[1]][[3]]
[1] "030" "037"

$g3[[1]][[4]]
[1] "046"

$g3[[1]][[5]]
[1] "051"

$g3[[1]][[6]]
[1] "075"


$g3[[2]]
$g3[[2]][[1]]
[1] "112"

$g3[[2]][[2]]
[1] "157"

$g3[[2]][[3]]
[1] "172"


$g3[[3]]
$g3[[3]][[1]]
[1] "244"

$g3[[3]][[2]]
[1] "259"

$g3[[3]][[3]]
[1] "264" "266"


$g3[[4]]
$g3[[4]][[1]]
[1] "304"

$g3[[4]][[2]]
[1] "357"

$g3[[4]][[3]]
[1] "364"


$g3[[5]]
$g3[[5]][[1]]
[1] "408"

$g3[[5]][[2]]
[1] "424"


$g3[[6]]
$g3[[6]][[1]]
[1] "522"


$g3[[7]]
$g3[[7]][[1]]
[1] "630"


$g3[[8]]
$g3[[8]][[1]]
[1] "802"

$g3[[8]][[2]]
[1] "842"


$g3[[9]]
$g3[[9]][[1]]
[1] "961"


$g3[[10]]
$g3[[10]][[1]]
[1] "A50"


$g3[[11]]
$g3[[11]][[1]]
[1] "D42"


$g3[[12]]
$g3[[12]][[1]]
[1] "H20"


$g3[[13]]
$g3[[13]][[1]]
[1] "J05" "J08"

$g3[[13]][[2]]
[1] "J10"

$g3[[13]][[3]]
[1] "J76"


$g3[[14]]
$g3[[14]][[1]]
[1] "Q42"


$g3[[15]]
$g3[[15]][[1]]
[1] "T10"



$g4
$g4[[1]]
$g4[[1]][[1]]
[1] "0151"


$g4[[2]]
$g4[[2]][[1]]
[1] "1910"

$g4[[2]][[2]]
[1] "1160"

$g4[[2]][[3]]
[1] "1195"


$g4[[3]]
$g4[[3]][[1]]
[1] "2095"

$g4[[3]][[2]]
[1] "2255"

$g4[[3]][[3]]
[1] "2528"

$g4[[3]][[4]]
[1] "2826"

$g4[[3]][[5]]
[1] "2852"

$g4[[3]][[6]]
[1] "2870"


$g4[[4]]
$g4[[4]][[1]]
[1] "3321"

$g4[[4]][[2]]
[1] "3683"


$g4[[5]]
$g4[[5]][[1]]
[1] "4365"

$g4[[5]][[2]]
[1] "4922"


$g4[[6]]
$g4[[6]][[1]]
[1] "5174" "5179"


$g4[[7]]
$g4[[7]][[1]]
[1] "6228"

$g4[[7]][[2]]
[1] "6473"


$g4[[8]]
$g4[[8]][[1]]
[1] "9210"

$g4[[8]][[2]]
[1] "9007"

$g4[[8]][[3]]
[1] "9067"

$g4[[8]][[4]]
[1] "9330"

$g4[[8]][[5]]
[1] "9345"

$g4[[8]][[6]]
[1] "9525"

$g4[[8]][[7]]
[1] "9597"


$g4[[9]]
$g4[[9]][[1]]
[1] "A655"


$g4[[10]]
$g4[[10]][[1]]
[1] "C184"


$g4[[11]]
$g4[[11]][[1]]
[1] "G220"

$g4[[11]][[2]]
[1] "G600"


$g4[[12]]
$g4[[12]][[1]]
[1] "J046"

$g4[[12]][[2]]
[1] "J126"

$g4[[12]][[3]]
[1] "J145"


$g4[[13]]
$g4[[13]][[1]]
[1] "S909"

$g4[[13]][[2]]
[1] "S937"


$g4[[14]]
$g4[[14]][[1]]
[1] "T203"



$g5
$g5[[1]]
$g5[[1]][[1]]
[1] "0331T" "0407T" "0731T"


$g5[[2]]
$g5[[2]][[1]]
[1] "0254U"


$g5[[3]]
$g5[[3]][[1]]
[1] "15157"

$g5[[3]][[2]]
[1] "15273"


$g5[[4]]
$g5[[4]][[1]]
[1] "20805"

$g5[[4]][[2]]
[1] "20974"

$g5[[4]][[3]]
[1] "26010"

$g5[[4]][[4]]
[1] "26502"

$g5[[4]][[5]]
[1] "28202"


$g5[[5]]
$g5[[5]][[1]]
[1] "33340"


$g5[[6]]
$g5[[6]][[1]]
[1] "41800"


$g5[[7]]
$g5[[7]][[1]]
[1] "50390"

$g5[[7]][[2]]
[1] "55862"

$g5[[7]][[3]]
[1] "57260"

$g5[[7]][[4]]
[1] "58559"


$g5[[8]]
$g5[[8]][[1]]
[1] "63305"


$g5[[9]]
$g5[[9]][[1]]
[1] "88363"


$g5[[10]]
$g5[[10]][[1]]
[1] "95801"

$g5[[10]][[2]]
[1] "96402"


$g5[[11]]
$g5[[11]][[1]]
[1] "A7035"

$g5[[11]][[2]]
[1] "A9268"


$g5[[12]]
$g5[[12]][[1]]
[1] "J1730"


$g5[[13]]
$g5[[13]][[1]]
[1] "L8603"


$g5[[14]]
$g5[[14]][[1]]
[1] "Q2042"


$g5[[15]]
$g5[[15]][[1]]
[1] "S9538"</code></pre>
</div>
</div>
</div>
</div>
</div>
<hr>
<div style="page-break-after: always;"></div>
</section><section id="reduce-groups" class="level1" data-number="3"><h1 data-number="3">
<span class="header-section-number">3</span> Reduce Groups</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">reduce_runs</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">red1</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">red2</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">red3</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false">red4</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-6" role="tab" aria-controls="tabset-2-6" aria-selected="false">red5</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-7" role="tab" aria-controls="tabset-2-7" aria-selected="false">reduce_groups</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">reduce_runs</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">sf_nchar</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> </span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">37</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">9</span>, <span class="st">"&amp;"</span>, <span class="va">LETTERS</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">vec</span> <span class="op">&lt;-</span> <span class="va">test</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu">desplit</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">"&amp;"</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">vec</span> <span class="op">&lt;-</span> <span class="va">vec</span><span class="op">[</span><span class="fu">not_na</span><span class="op">(</span><span class="va">vec</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">test</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">vec</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>  </span>
<span>  <span class="va">test</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span> <span class="op">==</span> <span class="st">"&amp;"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span>  <span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="op">(</span></span>
<span>    value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span>,</span>
<span>    keys <span class="op">=</span> <span class="va">test</span>,</span>
<span>    group <span class="op">=</span> <span class="fu">groupid</span><span class="op">(</span><span class="va">test</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">fgroup_by</span><span class="op">(</span><span class="va">group</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu">join</span><span class="op">(</span></span>
<span>    <span class="va">groups</span>, </span>
<span>    <span class="fu">fcount</span><span class="op">(</span><span class="va">groups</span>, <span class="va">group</span><span class="op">)</span>, </span>
<span>    on <span class="op">=</span> <span class="st">"group"</span>, </span>
<span>    verbose <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">fungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">fsubset</span><span class="op">(</span><span class="va">keys</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">fsubset</span><span class="op">(</span><span class="va">N</span> <span class="op">&gt;=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">fselect</span><span class="op">(</span><span class="va">value</span>, <span class="va">group</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">groups</span><span class="op">)</span><span class="op">)</span> </span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">xgroups</span> <span class="op">&lt;-</span> <span class="fu">gchop</span><span class="op">(</span></span>
<span>    <span class="va">groups</span><span class="op">$</span><span class="va">value</span>, </span>
<span>    <span class="va">groups</span><span class="op">$</span><span class="va">group</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">map</span><span class="op">(</span><span class="va">smush</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">list_c</span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">xgroups</span> <span class="op">==</span> <span class="fu">smush</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">9</span>, <span class="st">"&amp;"</span>, <span class="va">LETTERS</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="st">"[A-Z0-9]"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">replacements</span> <span class="op">&lt;-</span> <span class="fu">join</span><span class="op">(</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_min</a></span><span class="op">(</span><span class="va">groups</span>, by <span class="op">=</span> <span class="va">group</span>, order_by <span class="op">=</span> <span class="va">value</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>start <span class="op">=</span> <span class="va">value</span><span class="op">)</span>,</span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_max</a></span><span class="op">(</span><span class="va">groups</span>, by <span class="op">=</span> <span class="va">group</span>, order_by <span class="op">=</span> <span class="va">value</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>end <span class="op">=</span> <span class="va">value</span><span class="op">)</span>,</span>
<span>    on <span class="op">=</span> <span class="st">"group"</span>, verbose <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue_data</a></span><span class="op">(</span><span class="st">"{start}-{end}"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">bracket</span><span class="op">(</span><span class="fu">replace_regex</span><span class="op">(</span><span class="va">x</span>, <span class="va">xgroups</span>, <span class="va">replacements</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">red1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">getelem</span><span class="op">(</span><span class="va">x</span>, <span class="st">"g1"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> </span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">re</span> <span class="op">&lt;-</span> <span class="fu">sort_order</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">reduce_runs</span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">re</span> <span class="op">==</span> <span class="st">"[A-Z0-9]"</span><span class="op">)</span> </span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu">str_glue</span><span class="op">(</span><span class="st">"^{re}{{5}}"</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">post</span> <span class="op">&lt;-</span> <span class="fu">iif_else</span><span class="op">(</span></span>
<span>    <span class="fu">sf_detect</span><span class="op">(</span></span>
<span>      <span class="va">re</span>, </span>
<span>      <span class="st">"\\[?[0-9]{1}"</span><span class="op">)</span>, </span>
<span>    <span class="st">"[A-Z0-9]"</span>, </span>
<span>    <span class="st">"[0-9]"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">str_glue</span><span class="op">(</span><span class="st">"^{re}{post}{{4}}"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">long_test2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">process_groups</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">red1</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>^[CEGS0-35-79][A-Z0-9]{4}</code></pre>
</div>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">hcpcs_tests</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">process_groups</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">red1</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>^[GJ04-6][A-Z0-9]{4}</code></pre>
</div>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="fl">0</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">process_groups</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">red1</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>^[A-E0-9][A-Z0-9]{4}</code></pre>
</div>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>g1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">9</span>, <span class="va">LETTERS</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">red1</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>^[A-Z0-9]{5}</code></pre>
</div>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>g1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="fl">0</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">red1</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>^[A-E0-9][A-Z0-9]{4}</code></pre>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">red2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">getelem</span><span class="op">(</span><span class="va">x</span>, <span class="st">"g2"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> </span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">modify_if</span><span class="op">(</span><span class="va">x</span>, <span class="va">len_gt_one</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">parts</span> <span class="op">&lt;-</span> <span class="fu">split_max_vlen</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">map</span><span class="op">(</span><span class="va">uniq_narm</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">map</span><span class="op">(</span><span class="va">sort_order</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">map</span><span class="op">(</span><span class="va">reduce_runs</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">delist</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">multi</span> <span class="op">&lt;-</span> <span class="fu">sf_nchar</span><span class="op">(</span><span class="va">parts</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span></span>
<span>  <span class="va">nobrk</span> <span class="op">&lt;-</span> <span class="fu">sf_ndetect</span><span class="op">(</span><span class="va">parts</span>, <span class="st">"\\[|\\]"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="va">multi</span><span class="op">[</span><span class="va">nobrk</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="va">parts</span><span class="op">[</span><span class="va">multi</span><span class="op">[</span><span class="va">nobrk</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">map_chr</span><span class="op">(</span><span class="va">parts</span><span class="op">[</span><span class="va">multi</span><span class="op">[</span><span class="va">nobrk</span><span class="op">]</span><span class="op">]</span>, <span class="va">bracket</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">smush</span><span class="op">(</span><span class="va">parts</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">long_test2</span><span class="op">[</span><span class="fu">sf_nchar</span><span class="op">(</span><span class="va">long_test2</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">process_groups</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">red2</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "0[2-5]"

[[2]]
[1] "15"

[[3]]
[1] "2[027]"

[[4]]
[1] "3[0-24-6]"

[[5]]
[1] "5[0458]"

[[6]]
[1] "6[134]"

[[7]]
[1] "76"

[[8]]
[1] "9[25]"

[[9]]
[1] "C[79]"

[[10]]
[1] "E0"

[[11]]
[1] "G0"

[[12]]
[1] "S2"</code></pre>
</div>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">5</span>, <span class="va">LETTERS</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">process_groups</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">red2</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "A[A-Z0-5]"</code></pre>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">red3</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">getelem</span><span class="op">(</span><span class="va">x</span>, <span class="st">"g3"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">map</span><span class="op">(</span><span class="va">x</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="fu">modify_if</span><span class="op">(</span><span class="va">x</span>, <span class="va">len_gt_one</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>      </span>
<span>      <span class="va">parts</span> <span class="op">&lt;-</span> <span class="fu">split_max_vlen</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">map</span><span class="op">(</span><span class="va">uniq_narm</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu">map</span><span class="op">(</span><span class="va">sort_order</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">map</span><span class="op">(</span><span class="va">reduce_runs</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu">delist</span><span class="op">(</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="va">multi</span> <span class="op">&lt;-</span> <span class="fu">sf_nchar</span><span class="op">(</span><span class="va">parts</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span></span>
<span>      <span class="va">nobrk</span> <span class="op">&lt;-</span> <span class="fu">sf_ndetect</span><span class="op">(</span><span class="va">parts</span>, <span class="st">"\\[|\\]"</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="va">multi</span><span class="op">[</span><span class="va">nobrk</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="va">parts</span><span class="op">[</span><span class="va">multi</span><span class="op">[</span><span class="va">nobrk</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">map_chr</span><span class="op">(</span><span class="va">parts</span><span class="op">[</span><span class="va">multi</span><span class="op">[</span><span class="va">nobrk</span><span class="op">]</span><span class="op">]</span>, <span class="va">bracket</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="fu">smush</span><span class="op">(</span><span class="va">parts</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">long_test2</span><span class="op">[</span><span class="fu">sf_nchar</span><span class="op">(</span><span class="va">long_test2</span><span class="op">)</span> <span class="op">==</span> <span class="fl">3</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">process_groups</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">red3</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[[1]][[1]]
[1] "02[1267]"

[[1]][[2]]
[1] "03[23]"

[[1]][[3]]
[1] "04[24]"

[[1]][[4]]
[1] "050"


[[2]]
[[2]][[1]]
[1] "157"


[[3]]
[[3]][[1]]
[1] "209"

[[3]][[2]]
[1] "225"

[[3]][[3]]
[1] "271"


[[4]]
[[4]][[1]]
[1] "308"

[[4]][[2]]
[1] "312"

[[4]][[3]]
[1] "326"

[[4]][[4]]
[1] "34[78]"

[[4]][[5]]
[1] "355"

[[4]][[6]]
[1] "362"


[[5]]
[[5]][[1]]
[1] "50[35]"

[[5]][[2]]
[1] "544"

[[5]][[3]]
[1] "55[23]"

[[5]][[4]]
[1] "58[5-9]"


[[6]]
[[6]][[1]]
[1] "61[02]"

[[6]][[2]]
[1] "630"

[[6]][[3]]
[1] "64[46]"


[[7]]
[[7]][[1]]
[1] "765"


[[8]]
[[8]][[1]]
[1] "92[0-2]"

[[8]][[2]]
[1] "958"


[[9]]
[[9]][[1]]
[1] "C75"

[[9]][[2]]
[1] "C97"


[[10]]
[[10]][[1]]
[1] "E06"


[[11]]
[[11]][[1]]
[1] "G0[24]"


[[12]]
[[12]][[1]]
[1] "S23"</code></pre>
</div>
</div>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">red4</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">getelem</span><span class="op">(</span><span class="va">x</span>, <span class="st">"g4"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">map</span><span class="op">(</span><span class="va">x</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="fu">modify_if</span><span class="op">(</span><span class="va">x</span>, <span class="va">len_gt_one</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>      </span>
<span>      <span class="va">parts</span> <span class="op">&lt;-</span> <span class="fu">split_max_vlen</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">map</span><span class="op">(</span><span class="va">uniq_narm</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu">map</span><span class="op">(</span><span class="va">sort_order</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">map</span><span class="op">(</span><span class="va">reduce_runs</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu">delist</span><span class="op">(</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="va">multi</span> <span class="op">&lt;-</span> <span class="fu">sf_nchar</span><span class="op">(</span><span class="va">parts</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span></span>
<span>      <span class="va">nobrk</span> <span class="op">&lt;-</span> <span class="fu">sf_ndetect</span><span class="op">(</span><span class="va">parts</span>, <span class="st">"\\[|\\]"</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="va">multi</span><span class="op">[</span><span class="va">nobrk</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="va">parts</span><span class="op">[</span><span class="va">multi</span><span class="op">[</span><span class="va">nobrk</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">map_chr</span><span class="op">(</span><span class="va">parts</span><span class="op">[</span><span class="va">multi</span><span class="op">[</span><span class="va">nobrk</span><span class="op">]</span><span class="op">]</span>, <span class="va">bracket</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="fu">smush</span><span class="op">(</span><span class="va">parts</span><span class="op">)</span></span>
<span>      </span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">long_test2</span><span class="op">[</span><span class="fu">sf_nchar</span><span class="op">(</span><span class="va">long_test2</span><span class="op">)</span> <span class="op">==</span> <span class="fl">4</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">process_groups</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">red4</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[[1]][[1]]
[1] "050[67]"

[[1]][[2]]
[1] "021[457-9]"

[[1]][[3]]
[1] "022[0-2]"

[[1]][[4]]
[1] "026[3569]"

[[1]][[5]]
[1] "027[45]"

[[1]][[6]]
[1] "0329"

[[1]][[7]]
[1] "0330"

[[1]][[8]]
[1] "0422"

[[1]][[9]]
[1] "044[45]"


[[2]]
[[2]][[1]]
[1] "1577"


[[3]]
[[3]][[1]]
[1] "2093"

[[3]][[2]]
[1] "225[12]"

[[3]][[3]]
[1] "2719"


[[4]]
[[4]][[1]]
[1] "3080"

[[4]][[2]]
[1] "3123"

[[4]][[3]]
[1] "3267"

[[4]][[4]]
[1] "3557"

[[4]][[5]]
[1] "3622"

[[4]][[6]]
[1] "3471"

[[4]][[7]]
[1] "348[1-3]"


[[5]]
[[5]][[1]]
[1] "544[23]"

[[5]][[2]]
[1] "5030"

[[5]][[3]]
[1] "5054"

[[5]][[4]]
[1] "552[05]"

[[5]][[5]]
[1] "5530"

[[5]][[6]]
[1] "5857"

[[5]][[7]]
[1] "5860"

[[5]][[8]]
[1] "587[02]"

[[5]][[9]]
[1] "5880"

[[5]][[10]]
[1] "589[024]"


[[6]]
[[6]][[1]]
[1] "630[34]"

[[6]][[2]]
[1] "6100"

[[6]][[3]]
[1] "6125"

[[6]][[4]]
[1] "644[289]"

[[6]][[5]]
[1] "6463"


[[7]]
[[7]][[1]]
[1] "7651"


[[8]]
[[8]][[1]]
[1] "9587"

[[8]][[2]]
[1] "920[28]"

[[8]][[3]]
[1] "921[34]"

[[8]][[4]]
[1] "922[02-4]"


[[9]]
[[9]][[1]]
[1] "C750"

[[9]][[2]]
[1] "C977"


[[10]]
[[10]][[1]]
[1] "E067"


[[11]]
[[11]][[1]]
[1] "G027"

[[11]][[2]]
[1] "G041"


[[12]]
[[12]][[1]]
[1] "S234"</code></pre>
</div>
</div>
</div>
<div id="tabset-2-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-6-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">red5</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">getelem</span><span class="op">(</span><span class="va">x</span>, <span class="st">"g5"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">map</span><span class="op">(</span><span class="va">x</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="fu">modify_if</span><span class="op">(</span><span class="va">x</span>, <span class="va">len_gt_one</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>      </span>
<span>      <span class="va">parts</span> <span class="op">&lt;-</span> <span class="fu">split_max_vlen</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">map</span><span class="op">(</span><span class="va">uniq_narm</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu">map</span><span class="op">(</span><span class="va">sort_order</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">map</span><span class="op">(</span><span class="va">reduce_runs</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu">delist</span><span class="op">(</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="va">multi</span> <span class="op">&lt;-</span> <span class="fu">sf_nchar</span><span class="op">(</span><span class="va">parts</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span></span>
<span>      <span class="va">nobrk</span> <span class="op">&lt;-</span> <span class="fu">sf_ndetect</span><span class="op">(</span><span class="va">parts</span>, <span class="st">"\\[|\\]"</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="va">multi</span><span class="op">[</span><span class="va">nobrk</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="va">parts</span><span class="op">[</span><span class="va">multi</span><span class="op">[</span><span class="va">nobrk</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">map_chr</span><span class="op">(</span><span class="va">parts</span><span class="op">[</span><span class="va">multi</span><span class="op">[</span><span class="va">nobrk</span><span class="op">]</span><span class="op">]</span>, <span class="va">bracket</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="fu">smush</span><span class="op">(</span><span class="va">parts</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">long_test2</span><span class="op">[</span><span class="fu">sf_nchar</span><span class="op">(</span><span class="va">long_test2</span><span class="op">)</span> <span class="op">==</span> <span class="fl">5</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># remove_redundant() |&gt;</span></span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">process_groups</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">red5</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[[1]][[1]]
[1] "050[67]T"

[[1]][[2]]
[1] "02[1267][0-9]T"

[[1]][[3]]
[1] "03[23][09]T"

[[1]][[4]]
[1] "04[24][245]T"


[[2]]
[[2]][[1]]
[1] "15777"


[[3]]
[[3]][[1]]
[1] "20939"

[[3]][[2]]
[1] "2719[78]"

[[3]][[3]]
[1] "2251[0-5]"

[[3]][[4]]
[1] "2252[67]"


[[4]]
[[4]][[1]]
[1] "3080[12]"

[[4]][[2]]
[1] "31231"

[[4]][[3]]
[1] "32673"

[[4]][[4]]
[1] "3471[3-7]"

[[4]][[5]]
[1] "35572"

[[4]][[6]]
[1] "36221"

[[4]][[7]]
[1] "34812"

[[4]][[8]]
[1] "34820"

[[4]][[9]]
[1] "3483[34]"


[[5]]
[[5]][[1]]
[1] "50300"

[[5]][[2]]
[1] "50540"

[[5]][[3]]
[1] "55300"

[[5]][[4]]
[1] "58575"

[[5]][[5]]
[1] "5860[05]"

[[5]][[6]]
[1] "5880[05]"

[[5]][[7]]
[1] "54420"

[[5]][[8]]
[1] "54430"

[[5]][[9]]
[1] "55200"

[[5]][[10]]
[1] "55250"

[[5]][[11]]
[1] "58700"

[[5]][[12]]
[1] "58720"

[[5]][[13]]
[1] "58900"

[[5]][[14]]
[1] "5892[05]"

[[5]][[15]]
[1] "5894[03]"


[[6]]
[[6]][[1]]
[1] "6100[01]"

[[6]][[2]]
[1] "61253"

[[6]][[3]]
[1] "6463[46]"

[[6]][[4]]
[1] "63035"

[[6]][[5]]
[1] "6304[3-8]"

[[6]][[6]]
[1] "64421"

[[6]][[7]]
[1] "6448[04]"

[[6]][[8]]
[1] "6449[1245]"


[[7]]
[[7]][[1]]
[1] "76514"


[[8]]
[[8]][[1]]
[1] "95870"

[[8]][[2]]
[1] "92025"

[[8]][[3]]
[1] "9208[1-3]"

[[8]][[4]]
[1] "9213[2-4]"

[[8]][[5]]
[1] "92145"

[[8]][[6]]
[1] "9220[12]"

[[8]][[7]]
[1] "9222[7-9]"

[[8]][[8]]
[1] "92235"

[[8]][[9]]
[1] "9224[02]"


[[9]]
[[9]][[1]]
[1] "C750[1245]"

[[9]][[2]]
[1] "C9771"


[[10]]
[[10]][[1]]
[1] "E0675"


[[11]]
[[11]][[1]]
[1] "G0279"

[[11]][[2]]
[1] "G041[2-5]"


[[12]]
[[12]][[1]]
[1] "S2342"</code></pre>
</div>
</div>
</div>
<div id="tabset-2-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-7-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">reduce_groups</span> <span class="op">&lt;-</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    g1 <span class="op">=</span> <span class="fu">red1</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>    g2 <span class="op">=</span> <span class="fu">red2</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>    g3 <span class="op">=</span> <span class="fu">red3</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>    g4 <span class="op">=</span> <span class="fu">red4</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>    g5 <span class="op">=</span> <span class="fu">red5</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">long_test2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># remove_redundant() |&gt;</span></span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">process_groups</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">reduce_groups</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$g1
^[CEGS0-35-79][A-Z0-9]{4}

$g2
$g2[[1]]
[1] "0[2-5]"

$g2[[2]]
[1] "15"

$g2[[3]]
[1] "2[027]"

$g2[[4]]
[1] "3[0-24-6]"

$g2[[5]]
[1] "5[0458]"

$g2[[6]]
[1] "6[134]"

$g2[[7]]
[1] "76"

$g2[[8]]
[1] "9[25]"

$g2[[9]]
[1] "C[79]"

$g2[[10]]
[1] "E0"

$g2[[11]]
[1] "G0"

$g2[[12]]
[1] "S2"


$g3
$g3[[1]]
$g3[[1]][[1]]
[1] "02[1267]"

$g3[[1]][[2]]
[1] "03[23]"

$g3[[1]][[3]]
[1] "04[24]"

$g3[[1]][[4]]
[1] "050"


$g3[[2]]
$g3[[2]][[1]]
[1] "157"


$g3[[3]]
$g3[[3]][[1]]
[1] "209"

$g3[[3]][[2]]
[1] "225"

$g3[[3]][[3]]
[1] "271"


$g3[[4]]
$g3[[4]][[1]]
[1] "308"

$g3[[4]][[2]]
[1] "312"

$g3[[4]][[3]]
[1] "326"

$g3[[4]][[4]]
[1] "34[78]"

$g3[[4]][[5]]
[1] "355"

$g3[[4]][[6]]
[1] "362"


$g3[[5]]
$g3[[5]][[1]]
[1] "50[35]"

$g3[[5]][[2]]
[1] "544"

$g3[[5]][[3]]
[1] "55[23]"

$g3[[5]][[4]]
[1] "58[5-9]"


$g3[[6]]
$g3[[6]][[1]]
[1] "61[02]"

$g3[[6]][[2]]
[1] "630"

$g3[[6]][[3]]
[1] "64[46]"


$g3[[7]]
$g3[[7]][[1]]
[1] "765"


$g3[[8]]
$g3[[8]][[1]]
[1] "92[0-2]"

$g3[[8]][[2]]
[1] "958"


$g3[[9]]
$g3[[9]][[1]]
[1] "C75"

$g3[[9]][[2]]
[1] "C97"


$g3[[10]]
$g3[[10]][[1]]
[1] "E06"


$g3[[11]]
$g3[[11]][[1]]
[1] "G0[24]"


$g3[[12]]
$g3[[12]][[1]]
[1] "S23"



$g4
$g4[[1]]
$g4[[1]][[1]]
[1] "050[67]"

$g4[[1]][[2]]
[1] "021[457-9]"

$g4[[1]][[3]]
[1] "022[0-2]"

$g4[[1]][[4]]
[1] "026[3569]"

$g4[[1]][[5]]
[1] "027[45]"

$g4[[1]][[6]]
[1] "0329"

$g4[[1]][[7]]
[1] "0330"

$g4[[1]][[8]]
[1] "0422"

$g4[[1]][[9]]
[1] "044[45]"


$g4[[2]]
$g4[[2]][[1]]
[1] "1577"


$g4[[3]]
$g4[[3]][[1]]
[1] "2093"

$g4[[3]][[2]]
[1] "225[12]"

$g4[[3]][[3]]
[1] "2719"


$g4[[4]]
$g4[[4]][[1]]
[1] "3080"

$g4[[4]][[2]]
[1] "3123"

$g4[[4]][[3]]
[1] "3267"

$g4[[4]][[4]]
[1] "3557"

$g4[[4]][[5]]
[1] "3622"

$g4[[4]][[6]]
[1] "3471"

$g4[[4]][[7]]
[1] "348[1-3]"


$g4[[5]]
$g4[[5]][[1]]
[1] "544[23]"

$g4[[5]][[2]]
[1] "5030"

$g4[[5]][[3]]
[1] "5054"

$g4[[5]][[4]]
[1] "552[05]"

$g4[[5]][[5]]
[1] "5530"

$g4[[5]][[6]]
[1] "5857"

$g4[[5]][[7]]
[1] "5860"

$g4[[5]][[8]]
[1] "587[02]"

$g4[[5]][[9]]
[1] "5880"

$g4[[5]][[10]]
[1] "589[024]"


$g4[[6]]
$g4[[6]][[1]]
[1] "630[34]"

$g4[[6]][[2]]
[1] "6100"

$g4[[6]][[3]]
[1] "6125"

$g4[[6]][[4]]
[1] "644[289]"

$g4[[6]][[5]]
[1] "6463"


$g4[[7]]
$g4[[7]][[1]]
[1] "7651"


$g4[[8]]
$g4[[8]][[1]]
[1] "9587"

$g4[[8]][[2]]
[1] "920[28]"

$g4[[8]][[3]]
[1] "921[34]"

$g4[[8]][[4]]
[1] "922[02-4]"


$g4[[9]]
$g4[[9]][[1]]
[1] "C750"

$g4[[9]][[2]]
[1] "C977"


$g4[[10]]
$g4[[10]][[1]]
[1] "E067"


$g4[[11]]
$g4[[11]][[1]]
[1] "G027"

$g4[[11]][[2]]
[1] "G041"


$g4[[12]]
$g4[[12]][[1]]
[1] "S234"



$g5
$g5[[1]]
$g5[[1]][[1]]
[1] "050[67]T"

$g5[[1]][[2]]
[1] "02[1267][0-9]T"

$g5[[1]][[3]]
[1] "03[23][09]T"

$g5[[1]][[4]]
[1] "04[24][245]T"


$g5[[2]]
$g5[[2]][[1]]
[1] "15777"


$g5[[3]]
$g5[[3]][[1]]
[1] "20939"

$g5[[3]][[2]]
[1] "2719[78]"

$g5[[3]][[3]]
[1] "2251[0-5]"

$g5[[3]][[4]]
[1] "2252[67]"


$g5[[4]]
$g5[[4]][[1]]
[1] "3080[12]"

$g5[[4]][[2]]
[1] "31231"

$g5[[4]][[3]]
[1] "32673"

$g5[[4]][[4]]
[1] "3471[3-7]"

$g5[[4]][[5]]
[1] "35572"

$g5[[4]][[6]]
[1] "36221"

$g5[[4]][[7]]
[1] "34812"

$g5[[4]][[8]]
[1] "34820"

$g5[[4]][[9]]
[1] "3483[34]"


$g5[[5]]
$g5[[5]][[1]]
[1] "50300"

$g5[[5]][[2]]
[1] "50540"

$g5[[5]][[3]]
[1] "55300"

$g5[[5]][[4]]
[1] "58575"

$g5[[5]][[5]]
[1] "5860[05]"

$g5[[5]][[6]]
[1] "5880[05]"

$g5[[5]][[7]]
[1] "54420"

$g5[[5]][[8]]
[1] "54430"

$g5[[5]][[9]]
[1] "55200"

$g5[[5]][[10]]
[1] "55250"

$g5[[5]][[11]]
[1] "58700"

$g5[[5]][[12]]
[1] "58720"

$g5[[5]][[13]]
[1] "58900"

$g5[[5]][[14]]
[1] "5892[05]"

$g5[[5]][[15]]
[1] "5894[03]"


$g5[[6]]
$g5[[6]][[1]]
[1] "6100[01]"

$g5[[6]][[2]]
[1] "61253"

$g5[[6]][[3]]
[1] "6463[46]"

$g5[[6]][[4]]
[1] "63035"

$g5[[6]][[5]]
[1] "6304[3-8]"

$g5[[6]][[6]]
[1] "64421"

$g5[[6]][[7]]
[1] "6448[04]"

$g5[[6]][[8]]
[1] "6449[1245]"


$g5[[7]]
$g5[[7]][[1]]
[1] "76514"


$g5[[8]]
$g5[[8]][[1]]
[1] "95870"

$g5[[8]][[2]]
[1] "92025"

$g5[[8]][[3]]
[1] "9208[1-3]"

$g5[[8]][[4]]
[1] "9213[2-4]"

$g5[[8]][[5]]
[1] "92145"

$g5[[8]][[6]]
[1] "9220[12]"

$g5[[8]][[7]]
[1] "9222[7-9]"

$g5[[8]][[8]]
[1] "92235"

$g5[[8]][[9]]
[1] "9224[02]"


$g5[[9]]
$g5[[9]][[1]]
[1] "C750[1245]"

$g5[[9]][[2]]
[1] "C9771"


$g5[[10]]
$g5[[10]][[1]]
[1] "E0675"


$g5[[11]]
$g5[[11]][[1]]
[1] "G0279"

$g5[[11]][[2]]
[1] "G041[2-5]"


$g5[[12]]
$g5[[12]][[1]]
[1] "S2342"</code></pre>
</div>
</div>
</div>
</div>
</div>
<hr>
<div style="page-break-after: always;"></div>
</section><section id="recombine-vectors" class="level1" data-number="4"><h1 data-number="4">
<span class="header-section-number">4</span> Recombine Vectors</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">recombine2</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">recombine3</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">recombine4</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">recombine5</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-5" role="tab" aria-controls="tabset-3-5" aria-selected="false">recombine_groups</a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">recombine2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">getelem</span><span class="op">(</span><span class="va">x</span>, <span class="st">"g2"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">sf_collapse</span><span class="op">(</span><span class="fu">list_c</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">'|'</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># str_glue("^({x})[A-Z0-9]{{3}}$")</span></span>
<span>  <span class="fu">str_glue</span><span class="op">(</span><span class="st">"({x})"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">long_test2</span><span class="op">[</span><span class="fu">sf_nchar</span><span class="op">(</span><span class="va">long_test2</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">process_groups</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">reduce_groups</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">recombine2</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(0[2-5]|15|2[027]|3[0-24-6]|5[0458]|6[134]|76|9[25]|C[79]|E0|G0|S2)</code></pre>
</div>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">random_hcpcs</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">process_groups</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">reduce_groups</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">recombine2</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(03|2[01]|54|62|75|95|K0|L2)</code></pre>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">recombine3</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">getelem</span><span class="op">(</span><span class="va">x</span>, <span class="st">"g3"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fu">vlen</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> </span>
<span>      <span class="cn">NULL</span> </span>
<span>    <span class="kw">else</span> </span>
<span>      <span class="fu">parentheses</span><span class="op">(</span></span>
<span>        <span class="fu">sf_collapse</span><span class="op">(</span></span>
<span>          <span class="fu">delist</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fu">vlen</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">"|"</span><span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/as_glue.html">as_glue</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fu">vlen</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> </span>
<span>      <span class="cn">NULL</span> </span>
<span>    <span class="kw">else</span> </span>
<span>      <span class="fu">map</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fu">vlen</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">]</span>, </span>
<span>          <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>          </span>
<span>            <span class="va">front</span> <span class="op">&lt;-</span> <span class="fu">uniq</span><span class="op">(</span><span class="fu">sf_sub</span><span class="op">(</span><span class="fu">delist</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, start <span class="op">=</span> <span class="fl">1</span>, stop <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>          </span>
<span>            <span class="va">back</span>  <span class="op">&lt;-</span> <span class="fu">sf_collapse</span><span class="op">(</span><span class="fu">sf_remove</span><span class="op">(</span><span class="fu">delist</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu">str_glue</span><span class="op">(</span><span class="st">"^[{front}]{{1}}"</span><span class="op">)</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">"|"</span><span class="op">)</span></span>
<span>          </span>
<span>            <span class="fu">str_glue</span><span class="op">(</span><span class="st">"{front}({back})"</span><span class="op">)</span></span>
<span>          </span>
<span>            <span class="op">}</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">list_flatten</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">long_test2</span><span class="op">[</span><span class="fu">sf_nchar</span><span class="op">(</span><span class="va">long_test2</span><span class="op">)</span> <span class="op">==</span> <span class="fl">3</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">process_groups</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">reduce_groups</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">recombine3</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
(157|765|E06|G0[24]|S23)

[[2]]
0(2[1267]|3[23]|4[24]|50)

[[3]]
2(09|25|71)

[[4]]
3(08|12|26|4[78]|55|62)

[[5]]
5(0[35]|44|5[23]|8[5-9])

[[6]]
6(1[02]|30|4[46])

[[7]]
9(2[0-2]|58)

[[8]]
C(75|97)</code></pre>
</div>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">random_hcpcs</span><span class="op">(</span><span class="fl">50</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">process_groups</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">reduce_groups</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">recombine3</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
(50[457]|630|705|95[18]|Q4[12]|S94)

[[2]]
1(17|40|56)

[[3]]
2(5[01]|6[49])

[[4]]
3(17|38|50)

[[5]]
4(24|32|54)

[[6]]
G(20|89)

[[7]]
J(15|27|73)

[[8]]
L(16|83)</code></pre>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">recombine4</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">getelem</span><span class="op">(</span><span class="va">x</span>, <span class="st">"g4"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fu">vlen</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> </span>
<span>      <span class="cn">NULL</span> </span>
<span>    <span class="kw">else</span> </span>
<span>      <span class="fu">parentheses</span><span class="op">(</span></span>
<span>        <span class="fu">sf_collapse</span><span class="op">(</span></span>
<span>          <span class="fu">delist</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fu">vlen</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">"|"</span><span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/as_glue.html">as_glue</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fu">vlen</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> </span>
<span>      <span class="cn">NULL</span> </span>
<span>    <span class="kw">else</span> </span>
<span>      <span class="fu">map</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fu">vlen</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">]</span>, </span>
<span>          <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>          </span>
<span>            <span class="va">front</span> <span class="op">&lt;-</span> <span class="fu">uniq</span><span class="op">(</span><span class="fu">sf_sub</span><span class="op">(</span><span class="fu">delist</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, start <span class="op">=</span> <span class="fl">1</span>, stop <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>          </span>
<span>            <span class="va">back</span>  <span class="op">&lt;-</span> <span class="fu">sf_collapse</span><span class="op">(</span><span class="fu">sf_remove</span><span class="op">(</span><span class="fu">delist</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu">str_glue</span><span class="op">(</span><span class="st">"^[{front}]{{1}}"</span><span class="op">)</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">"|"</span><span class="op">)</span></span>
<span>          </span>
<span>            <span class="fu">str_glue</span><span class="op">(</span><span class="st">"{front}({back})"</span><span class="op">)</span></span>
<span>          </span>
<span>            <span class="op">}</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">list_flatten</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">long_test2</span><span class="op">[</span><span class="fu">sf_nchar</span><span class="op">(</span><span class="va">long_test2</span><span class="op">)</span> <span class="op">==</span> <span class="fl">4</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">process_groups</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">reduce_groups</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">recombine4</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
(1577|7651|E067|S234)

[[2]]
0(50[67]|21[457-9]|22[0-2]|26[3569]|27[45]|329|330|422|44[45])

[[3]]
2(093|25[12]|719)

[[4]]
3(080|123|267|557|622|471|48[1-3])

[[5]]
5(44[23]|030|054|52[05]|530|857|860|87[02]|880|89[024])

[[6]]
6(30[34]|100|125|44[289]|463)

[[7]]
9(587|20[28]|21[34]|22[02-4])

[[8]]
C(750|977)

[[9]]
G(027|041)</code></pre>
</div>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">random_hcpcs</span><span class="op">(</span><span class="fl">50</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">process_groups</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">reduce_groups</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">recombine4</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
(7032|E095|G886|J155|K060)

[[2]]
0(274|481|531)

[[3]]
2(286|434|015|026|72[46]|732|772|812|830)

[[4]]
3(284|336)

[[5]]
5(192|250|854)

[[6]]
6(461|729)

[[7]]
9(130|296|361|931|94[68])

[[8]]
A(420|602)

[[9]]
Q(047|201)</code></pre>
</div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">recombine5</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">getelem</span><span class="op">(</span><span class="va">x</span>, <span class="st">"g5"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fu">vlen</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> </span>
<span>      <span class="cn">NULL</span> </span>
<span>    <span class="kw">else</span> </span>
<span>      <span class="fu">parentheses</span><span class="op">(</span></span>
<span>        <span class="fu">sf_collapse</span><span class="op">(</span></span>
<span>          <span class="fu">delist</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fu">vlen</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">"|"</span><span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/as_glue.html">as_glue</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fu">vlen</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> </span>
<span>      <span class="cn">NULL</span> </span>
<span>    <span class="kw">else</span> </span>
<span>      <span class="fu">map</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fu">vlen</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">]</span>, </span>
<span>          <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>          </span>
<span>            <span class="va">front</span> <span class="op">&lt;-</span> <span class="fu">uniq</span><span class="op">(</span><span class="fu">sf_sub</span><span class="op">(</span><span class="fu">delist</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, start <span class="op">=</span> <span class="fl">1</span>, stop <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>          </span>
<span>            <span class="va">back</span>  <span class="op">&lt;-</span> <span class="fu">sf_collapse</span><span class="op">(</span><span class="fu">sf_remove</span><span class="op">(</span><span class="fu">delist</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu">str_glue</span><span class="op">(</span><span class="st">"^[{front}]{{1}}"</span><span class="op">)</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">"|"</span><span class="op">)</span></span>
<span>          </span>
<span>            <span class="fu">str_glue</span><span class="op">(</span><span class="st">"{front}({back})"</span><span class="op">)</span></span>
<span>          </span>
<span>            <span class="op">}</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">list_flatten</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">long_test2</span><span class="op">[</span><span class="fu">sf_nchar</span><span class="op">(</span><span class="va">long_test2</span><span class="op">)</span> <span class="op">==</span> <span class="fl">5</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">process_groups</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">reduce_groups</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">recombine5</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
(15777|76514|E0675|S2342)

[[2]]
0(50[67]T|2[1267][0-9]T|3[23][09]T|4[24][245]T)

[[3]]
2(0939|719[78]|251[0-5]|252[67])

[[4]]
3(080[12]|1231|2673|471[3-7]|5572|6221|4812|4820|483[34])

[[5]]
5(0300|0540|5300|8575|860[05]|880[05]|4420|4430|5200|5250|8700|8720|8900|892[05]|894[03])

[[6]]
6(100[01]|1253|463[46]|3035|304[3-8]|4421|448[04]|449[1245])

[[7]]
9(5870|2025|208[1-3]|213[2-4]|2145|220[12]|222[7-9]|2235|224[02])

[[8]]
C(750[1245]|9771)

[[9]]
G(0279|041[2-5])</code></pre>
</div>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">random_hcpcs</span><span class="op">(</span><span class="fl">50</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">process_groups</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">reduce_groups</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">recombine5</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
(0769T|0253U|01710|17312|35907|44300|56631|E2101|K0071|Q0483)

[[2]]
7(3522|8598)

[[3]]
9(4452|8976)

[[4]]
C(1822|7535)

[[5]]
G(0235|0313|0476|0505)

[[6]]
L(1001|1290)

[[7]]
V(2211|2315)</code></pre>
</div>
</div>
</div>
<div id="tabset-3-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-5-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">recombine_groups</span> <span class="op">&lt;-</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    v1 <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">g1</span>,</span>
<span>    v2 <span class="op">=</span> <span class="fu">recombine2</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>    v3 <span class="op">=</span> <span class="fu">recombine3</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>    v4 <span class="op">=</span> <span class="fu">recombine4</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>    v5 <span class="op">=</span> <span class="fu">recombine5</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">long_test2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">process_groups</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">reduce_groups</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">recombine_groups</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$v1
^[CEGS0-35-79][A-Z0-9]{4}

$v2
character(0)

$v3
character(0)

$v4
character(0)

$v5
character(0)</code></pre>
</div>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">random_hcpcs</span><span class="op">(</span><span class="fl">50</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_lengths</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">remove_redundant</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">split_first</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">process_groups</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">reduce_groups</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">recombine_groups</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$v1
^GP1[A-Z0-9]{4}

$v2
(2[1-358]|3[235]|4[0-36]|5[02]|6[49]|7[26]|8[01468]|9[367]|A[06]|C1|J[027]|L3|M0|Q4|T1|V2)

$v3
$v3[[1]]
(028|305|481|585|616|872|J85|L56|M10|S21|T45)

$v3[[2]]
2(06|67|74)

$v3[[3]]
7(58|7[04])

$v3[[4]]
9(59|9[14])

$v3[[5]]
A(42|55|95)

$v3[[6]]
Q(04|20)


$v4
$v4[[1]]
(8544|J330|M118|S557|T204)

$v4[[2]]
0(207|310|458)

$v4[[3]]
2(72[37]|772)

$v4[[4]]
3(163|682|949)

$v4[[5]]
4(901|942)

$v4[[6]]
5(386|416)

$v4[[7]]
6(121|514|308|328)

$v4[[8]]
9(038|066|071)


$v5
$v5[[1]]
(0015M|0[246][256][128]T|0377U|26055|44680|73201|94400|C7535|E2607|M1133)

$v5[[2]]
3(6522|6904|7242|8530)

$v5[[3]]
5(3410|8356)

$v5[[4]]
6(0100|1501|2320|7850|8135)

$v5[[5]]
8(2638|5421)

$v5[[6]]
A(9609|4427|4438)

$v5[[7]]
J(1652|9227)</code></pre>
</div>
</div>
</div>
</div>
</div>
<hr>
<div style="page-break-after: always;"></div>
</section><section id="collapse-regex" class="level1" data-number="5"><h1 data-number="5">
<span class="header-section-number">5</span> Collapse Regex</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">vec_to_regex</span> <span class="op">&lt;-</span> <span class="va">vrg</span> <span class="op">&lt;-</span> \<span class="op">(</span><span class="va">x</span>, <span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">empty</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> </span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">post</span> <span class="op">&lt;-</span> <span class="fu">iif_else</span><span class="op">(</span><span class="fu">sf_detect</span><span class="op">(</span><span class="va">x</span>, <span class="st">"^\\[?[A-Z]\\-?"</span><span class="op">)</span>, <span class="st">"[0-9]"</span>, <span class="st">"[A-Z0-9]"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">fcase</span><span class="op">(</span></span>
<span>    <span class="va">n</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"^{x}$"</span><span class="op">)</span>,                </span>
<span>    <span class="va">n</span> <span class="op">==</span> <span class="fl">1</span>, <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"^{x}{post}$"</span><span class="op">)</span>,</span>
<span>    <span class="va">n</span> <span class="op">==</span> <span class="fl">2</span>, <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"^{x}{post}{{2}}$"</span><span class="op">)</span>,</span>
<span>    <span class="va">n</span> <span class="op">==</span> <span class="fl">3</span>, <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"^{x}{post}{{3}}$"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>  <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue_collapse.html">glue_collapse</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">collapse_regex</span> <span class="op">&lt;-</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    g1 <span class="op">=</span> <span class="fu">red1</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>    g2 <span class="op">=</span> <span class="fu">map_chr</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">g2</span>, <span class="va">red2</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">map_chr</span><span class="op">(</span><span class="va">vrg</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/as_glue.html">as_glue</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    g3 <span class="op">=</span> <span class="fu">map_chr</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">g3</span>, <span class="va">red3</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">map_chr</span><span class="op">(</span><span class="va">vrg</span>, n <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/as_glue.html">as_glue</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    g4 <span class="op">=</span> <span class="fu">map_chr</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">g4</span>, <span class="va">red4</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">map_chr</span><span class="op">(</span><span class="va">vrg</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/as_glue.html">as_glue</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    g5 <span class="op">=</span> <span class="fu">map_chr</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">g5</span>, <span class="va">red5</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">map_chr</span><span class="op">(</span><span class="va">vrg</span>, n <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/as_glue.html">as_glue</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<div style="page-break-after: always;"></div>
</section><section id="s7-class" class="level1" data-number="6"><h1 data-number="6">
<span class="header-section-number">6</span> S7 Class</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">hcpcs</span> <span class="op">&lt;-</span> <span class="fu">new_class</span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"hcpcs"</span>,</span>
<span>  properties <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    input <span class="op">=</span> <span class="va">class_vector</span>,</span>
<span>    split_length     <span class="op">=</span> <span class="fu">new_property</span><span class="op">(</span>class <span class="op">=</span> <span class="va">class_list</span>, getter <span class="op">=</span> \<span class="op">(</span><span class="va">self</span><span class="op">)</span> <span class="fu">split_lengths</span><span class="op">(</span><span class="va">self</span><span class="op">@</span><span class="va">input</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    remove_redundant <span class="op">=</span> <span class="fu">new_property</span><span class="op">(</span>class <span class="op">=</span> <span class="va">class_list</span>, getter <span class="op">=</span> \<span class="op">(</span><span class="va">self</span><span class="op">)</span> <span class="fu">remove_redundant</span><span class="op">(</span><span class="va">self</span><span class="op">@</span><span class="va">split_length</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    split_first      <span class="op">=</span> <span class="fu">new_property</span><span class="op">(</span>class <span class="op">=</span> <span class="va">class_list</span>, getter <span class="op">=</span> \<span class="op">(</span><span class="va">self</span><span class="op">)</span> <span class="fu">split_first</span><span class="op">(</span><span class="va">self</span><span class="op">@</span><span class="va">remove_redundant</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    process_groups   <span class="op">=</span> <span class="fu">new_property</span><span class="op">(</span>class <span class="op">=</span> <span class="va">class_list</span>, getter <span class="op">=</span> \<span class="op">(</span><span class="va">self</span><span class="op">)</span> <span class="fu">process_groups</span><span class="op">(</span><span class="va">self</span><span class="op">@</span><span class="va">split_first</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    reduce_groups    <span class="op">=</span> <span class="fu">new_property</span><span class="op">(</span>class <span class="op">=</span> <span class="va">class_list</span>, getter <span class="op">=</span> \<span class="op">(</span><span class="va">self</span><span class="op">)</span> <span class="fu">reduce_groups</span><span class="op">(</span><span class="va">self</span><span class="op">@</span><span class="va">process_groups</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    recombine_groups <span class="op">=</span> <span class="fu">new_property</span><span class="op">(</span>class <span class="op">=</span> <span class="va">class_list</span>, getter <span class="op">=</span> \<span class="op">(</span><span class="va">self</span><span class="op">)</span> <span class="fu">recombine_groups</span><span class="op">(</span><span class="va">self</span><span class="op">@</span><span class="va">reduce_groups</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">hcpcs</span><span class="op">(</span>input <span class="op">=</span> <span class="fu">random_hcpcs</span><span class="op">(</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;hcpcs&gt;
 @ input           : chr [1:203] "0" "U" "8" "K0" "M1" "31" "46" "Q4" "L5" "07" "Q4" "54" ...
 @ split_length    :List of 5
 .. $ x1: chr [1:3] "0" "8" "U"
 .. $ x2: chr [1:41] "00" "01" "02" "05" ...
 .. $ x3: chr [1:49] "000" "005" "008" "018" ...
 .. $ x4: chr [1:50] "0073" "0222" "0425" "1142" ...
 .. $ x5: chr [1:50] "0025U" "01112" "0239T" "15100" ...
 @ remove_redundant:List of 5
 .. $ x1: chr [1:3] "0" "8" "U"
 .. $ x2: chr [1:33] "17" "21" "22" "23" ...
 .. $ x3: chr [1:26] "100" "245" "325" "365" ...
 .. $ x4: chr [1:28] "1142" "1520" "2097" "2466" ...
 .. $ x5: chr [1:23] "15100" "20703" "25515" "25920" ...
 @ split_first     :List of 5
 .. $ x1: chr [1:3] "0" "8" "U"
 .. $ x2:List of 16
 ..  ..$ : chr "17"
 ..  ..$ : chr [1:5] "21" "22" "23" "27" ...
 ..  ..$ : chr [1:3] "30" "31" "33"
 ..  ..$ : chr [1:3] "42" "43" "46"
 ..  ..$ : chr "54"
 ..  ..$ : chr [1:3] "60" "61" "62"
 ..  ..$ : chr [1:3] "72" "73" "74"
 ..  ..$ : chr "E0"
 ..  ..$ : chr [1:3] "G4" "G8" "G9"
 ..  ..$ : chr [1:2] "J1" "J7"
 ..  ..$ : chr "K0"
 ..  ..$ : chr [1:3] "L5" "L7" "L8"
 ..  ..$ : chr "M1"
 ..  ..$ : chr "P9"
 ..  ..$ : chr "Q4"
 ..  ..$ : chr "S9"
 .. $ x3:List of 13
 ..  ..$ : chr "100"
 ..  ..$ : chr "245"
 ..  ..$ : chr [1:3] "325" "365" "385"
 ..  ..$ : chr [1:3] "404" "418" "451"
 ..  ..$ : chr "572"
 ..  ..$ : chr "648"
 ..  ..$ : chr [1:4] "757" "759" "782" "785"
 ..  ..$ : chr [1:3] "925" "963" "994"
 ..  ..$ : chr "A95"
 ..  ..$ : chr [1:2] "C26" "C90"
 ..  ..$ : chr [1:2] "E10" "E26"
 ..  ..$ : chr [1:3] "J02" "J07" "J08"
 ..  ..$ : chr "M02"
 .. $ x4:List of 16
 ..  ..$ : chr [1:2] "1142" "1520"
 ..  ..$ : chr [1:6] "2097" "2466" "2507" "2530" ...
 ..  ..$ : chr "3776"
 ..  ..$ : chr "5040"
 ..  ..$ : chr "7049"
 ..  ..$ : chr [1:2] "9353" "9362"
 ..  ..$ : chr [1:3] "A443" "A470" "A621"
 ..  ..$ : chr [1:2] "C176" "C973"
 ..  ..$ : chr "E221"
 ..  ..$ : chr "G218"
 ..  ..$ : chr "H201"
 ..  ..$ : chr "J928"
 ..  ..$ : chr "L688"
 ..  ..$ : chr "Q510"
 ..  ..$ : chr [1:2] "S031" "S080"
 ..  ..$ : chr [1:2] "V230" "V526"
 .. $ x5:List of 14
 ..  ..$ : chr "15100"
 ..  ..$ : chr [1:3] "20703" "25515" "25920"
 ..  ..$ : chr [1:3] "34832" "36620" "37224"
 ..  ..$ : chr "48400"
 ..  ..$ : chr [1:4] "50688" "50860" "53085" "58750"
 ..  ..$ : chr "67921"
 ..  ..$ : chr "76883"
 ..  ..$ : chr "90655"
 ..  ..$ : chr "C7549"
 ..  ..$ : chr [1:2] "E1231" "E2370"
 ..  ..$ : chr [1:2] "G2167" "G2204"
 ..  ..$ : chr "J9144"
 ..  ..$ : chr "Q0244"
 ..  ..$ : chr "3200F"
 @ process_groups  :List of 5
 .. $ g1: chr [1:3] "0" "8" "U"
 .. $ g2:List of 16
 ..  ..$ : chr "17"
 ..  ..$ : chr [1:5] "21" "22" "23" "27" ...
 ..  ..$ : chr [1:3] "30" "31" "33"
 ..  ..$ : chr [1:3] "42" "43" "46"
 ..  ..$ : chr "54"
 ..  ..$ : chr [1:3] "60" "61" "62"
 ..  ..$ : chr [1:3] "72" "73" "74"
 ..  ..$ : chr "E0"
 ..  ..$ : chr [1:3] "G4" "G8" "G9"
 ..  ..$ : chr [1:2] "J1" "J7"
 ..  ..$ : chr "K0"
 ..  ..$ : chr [1:3] "L5" "L7" "L8"
 ..  ..$ : chr "M1"
 ..  ..$ : chr "P9"
 ..  ..$ : chr "Q4"
 ..  ..$ : chr "S9"
 .. $ g3:List of 13
 ..  ..$ :List of 1
 ..  .. ..$ : chr "100"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "245"
 ..  ..$ :List of 3
 ..  .. ..$ : chr "325"
 ..  .. ..$ : chr "365"
 ..  .. ..$ : chr "385"
 ..  ..$ :List of 3
 ..  .. ..$ : chr "404"
 ..  .. ..$ : chr "418"
 ..  .. ..$ : chr "451"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "572"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "648"
 ..  ..$ :List of 2
 ..  .. ..$ : chr [1:2] "757" "759"
 ..  .. ..$ : chr [1:2] "782" "785"
 ..  ..$ :List of 3
 ..  .. ..$ : chr "925"
 ..  .. ..$ : chr "963"
 ..  .. ..$ : chr "994"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "A95"
 ..  ..$ :List of 2
 ..  .. ..$ : chr "C26"
 ..  .. ..$ : chr "C90"
 ..  ..$ :List of 2
 ..  .. ..$ : chr "E10"
 ..  .. ..$ : chr "E26"
 ..  ..$ :List of 1
 ..  .. ..$ : chr [1:3] "J02" "J07" "J08"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "M02"
 .. $ g4:List of 16
 ..  ..$ :List of 2
 ..  .. ..$ : chr "1142"
 ..  .. ..$ : chr "1520"
 ..  ..$ :List of 6
 ..  .. ..$ : chr "2097"
 ..  .. ..$ : chr "2466"
 ..  .. ..$ : chr "2686"
 ..  .. ..$ : chr "2988"
 ..  .. ..$ : chr "2507"
 ..  .. ..$ : chr "2530"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "3776"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "5040"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "7049"
 ..  ..$ :List of 2
 ..  .. ..$ : chr "9353"
 ..  .. ..$ : chr "9362"
 ..  ..$ :List of 3
 ..  .. ..$ : chr "A621"
 ..  .. ..$ : chr "A443"
 ..  .. ..$ : chr "A470"
 ..  ..$ :List of 2
 ..  .. ..$ : chr "C176"
 ..  .. ..$ : chr "C973"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "E221"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "G218"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "H201"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "J928"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "L688"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "Q510"
 ..  ..$ :List of 2
 ..  .. ..$ : chr "S031"
 ..  .. ..$ : chr "S080"
 ..  ..$ :List of 2
 ..  .. ..$ : chr "V230"
 ..  .. ..$ : chr "V526"
 .. $ g5:List of 14
 ..  ..$ :List of 1
 ..  .. ..$ : chr "3200F"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "15100"
 ..  ..$ :List of 3
 ..  .. ..$ : chr "20703"
 ..  .. ..$ : chr "25515"
 ..  .. ..$ : chr "25920"
 ..  ..$ :List of 3
 ..  .. ..$ : chr "34832"
 ..  .. ..$ : chr "36620"
 ..  .. ..$ : chr "37224"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "48400"
 ..  ..$ :List of 4
 ..  .. ..$ : chr "50688"
 ..  .. ..$ : chr "50860"
 ..  .. ..$ : chr "53085"
 ..  .. ..$ : chr "58750"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "67921"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "76883"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "90655"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "C7549"
 ..  ..$ :List of 2
 ..  .. ..$ : chr "E1231"
 ..  .. ..$ : chr "E2370"
 ..  ..$ :List of 2
 ..  .. ..$ : chr "G2167"
 ..  .. ..$ : chr "G2204"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "J9144"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "Q0244"
 @ reduce_groups   :List of 5
 .. $ g1: 'glue' chr "^U08[A-Z0-9]{4}"
 .. $ g2:List of 16
 ..  ..$ : chr "17"
 ..  ..$ : chr "2[1-378]"
 ..  ..$ : chr "3[013]"
 ..  ..$ : chr "4[236]"
 ..  ..$ : chr "54"
 ..  ..$ : chr "6[0-2]"
 ..  ..$ : chr "7[2-4]"
 ..  ..$ : chr "E0"
 ..  ..$ : chr "G[489]"
 ..  ..$ : chr "J[17]"
 ..  ..$ : chr "K0"
 ..  ..$ : chr "L[578]"
 ..  ..$ : chr "M1"
 ..  ..$ : chr "P9"
 ..  ..$ : chr "Q4"
 ..  ..$ : chr "S9"
 .. $ g3:List of 13
 ..  ..$ :List of 1
 ..  .. ..$ : chr "100"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "245"
 ..  ..$ :List of 3
 ..  .. ..$ : chr "325"
 ..  .. ..$ : chr "365"
 ..  .. ..$ : chr "385"
 ..  ..$ :List of 3
 ..  .. ..$ : chr "404"
 ..  .. ..$ : chr "418"
 ..  .. ..$ : chr "451"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "572"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "648"
 ..  ..$ :List of 2
 ..  .. ..$ : chr "75[79]"
 ..  .. ..$ : chr "78[25]"
 ..  ..$ :List of 3
 ..  .. ..$ : chr "925"
 ..  .. ..$ : chr "963"
 ..  .. ..$ : chr "994"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "A95"
 ..  ..$ :List of 2
 ..  .. ..$ : chr "C26"
 ..  .. ..$ : chr "C90"
 ..  ..$ :List of 2
 ..  .. ..$ : chr "E10"
 ..  .. ..$ : chr "E26"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "J0[278]"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "M02"
 .. $ g4:List of 16
 ..  ..$ :List of 2
 ..  .. ..$ : chr "1142"
 ..  .. ..$ : chr "1520"
 ..  ..$ :List of 6
 ..  .. ..$ : chr "2097"
 ..  .. ..$ : chr "2466"
 ..  .. ..$ : chr "2686"
 ..  .. ..$ : chr "2988"
 ..  .. ..$ : chr "2507"
 ..  .. ..$ : chr "2530"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "3776"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "5040"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "7049"
 ..  ..$ :List of 2
 ..  .. ..$ : chr "9353"
 ..  .. ..$ : chr "9362"
 ..  ..$ :List of 3
 ..  .. ..$ : chr "A621"
 ..  .. ..$ : chr "A443"
 ..  .. ..$ : chr "A470"
 ..  ..$ :List of 2
 ..  .. ..$ : chr "C176"
 ..  .. ..$ : chr "C973"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "E221"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "G218"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "H201"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "J928"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "L688"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "Q510"
 ..  ..$ :List of 2
 ..  .. ..$ : chr "S031"
 ..  .. ..$ : chr "S080"
 ..  ..$ :List of 2
 ..  .. ..$ : chr "V230"
 ..  .. ..$ : chr "V526"
 .. $ g5:List of 14
 ..  ..$ :List of 1
 ..  .. ..$ : chr "3200F"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "15100"
 ..  ..$ :List of 3
 ..  .. ..$ : chr "20703"
 ..  .. ..$ : chr "25515"
 ..  .. ..$ : chr "25920"
 ..  ..$ :List of 3
 ..  .. ..$ : chr "34832"
 ..  .. ..$ : chr "36620"
 ..  .. ..$ : chr "37224"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "48400"
 ..  ..$ :List of 4
 ..  .. ..$ : chr "50688"
 ..  .. ..$ : chr "50860"
 ..  .. ..$ : chr "53085"
 ..  .. ..$ : chr "58750"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "67921"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "76883"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "90655"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "C7549"
 ..  ..$ :List of 2
 ..  .. ..$ : chr "E1231"
 ..  .. ..$ : chr "E2370"
 ..  ..$ :List of 2
 ..  .. ..$ : chr "G2167"
 ..  .. ..$ : chr "G2204"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "J9144"
 ..  ..$ :List of 1
 ..  .. ..$ : chr "Q0244"
 @ recombine_groups:List of 5
 .. $ v1: 'glue' chr "^U08[A-Z0-9]{4}"
 .. $ v2: 'glue' chr "(17|2[1-378]|3[013]|4[236]|54|6[0-2]|7[2-4]|E0|G[489]|J[17]|K0|L[578]|M1|P9|Q4|S9)"
 .. $ v3:List of 7
 ..  ..$ : 'glue' chr "(100|245|572|648|A95|J0[278]|M02)"
 ..  ..$ : 'glue' chr "3(25|65|85)"
 ..  ..$ : 'glue' chr "4(04|18|51)"
 ..  ..$ : 'glue' chr "7(5[79]|8[25])"
 ..  ..$ : 'glue' chr "9(25|63|94)"
 ..  ..$ : 'glue' chr "C(26|90)"
 ..  ..$ : 'glue' chr "E(10|26)"
 .. $ v4:List of 8
 ..  ..$ : 'glue' chr "(3776|5040|7049|E221|G218|H201|J928|L688|Q510)"
 ..  ..$ : 'glue' chr "1(142|520)"
 ..  ..$ : 'glue' chr "2(097|466|686|988|507|530)"
 ..  ..$ : 'glue' chr "9(353|362)"
 ..  ..$ : 'glue' chr "A(621|443|470)"
 ..  ..$ : 'glue' chr "C(176|973)"
 ..  ..$ : 'glue' chr "S(031|080)"
 ..  ..$ : 'glue' chr "V(230|526)"
 .. $ v5:List of 6
 ..  ..$ : 'glue' chr "(3200F|15100|48400|67921|76883|90655|C7549|J9144|Q0244)"
 ..  ..$ : 'glue' chr "2(0703|5515|5920)"
 ..  ..$ : 'glue' chr "3(4832|6620|7224)"
 ..  ..$ : 'glue' chr "5(0688|0860|3085|8750)"
 ..  ..$ : 'glue' chr "E(1231|2370)"
 ..  ..$ : 'glue' chr "G(2167|2204)"</code></pre>
</div>
</div>
<hr>
<div style="page-break-after: always;"></div>
<div id="nte-references" class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip&nbsp;1: Links
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<section id="reference" class="level3"><h3 class="anchored" data-anchor-id="reference">Reference</h3>
<ul>
<li><a href="https://github.com/raredd/regex">Regex Cheatsheet</a></li>
<li><a href="https://github.com/ziishaned/learn-regex">Learn Regex</a></li>
<li><a href="https://josiahparry.com/posts/2024-06-13-eval-strings">Evaluating strings as code</a></li>
<li><a href="https://github.com/Permian-Global-Research/rsi">Building rules from code operands</a></li>
<li><a href="https://github.com/atorus-research/ardis/blob/main/R/denom.R">Filter logic</a></li>
<li><a href="https://www.regular-expressions.info/tutorial.html">Regular-Expression.info</a></li>
<li><a href="https://www.rexegg.com/">RexEgg</a></li>
<li><a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/regex.html">Regular Expressions as used in R</a></li>
<li><a href="https://www.debuggex.com/">Debuggex</a></li>
</ul></section><section id="packages" class="level3"><h3 class="anchored" data-anchor-id="packages">Packages</h3>
<ul>
<li><a href="https://github.com/trinker/textshape"><strong>textshape</strong></a></li>
<li><a href="https://github.com/johncassil/stringr.plus"><strong>stringr.plus</strong></a></li>
<li><a href="https://github.com/jonocarroll/regexmagic"><strong>regexmagic</strong></a></li>
<li><a href="https://github.com/selkamand/makeunique"><strong>makeunique</strong></a></li>
<li><a href="https://github.com/davidsjoberg/similiars"><strong>similiars</strong></a></li>
<li><a href="https://github.com/rorynolan/strex/"><strong>strex</strong></a></li>
<li><a href="https://github.com/traversc/stringfish"><strong>stringfish</strong></a></li>
<li><a href="https://sebkrantz.github.io/collapse/"><strong>collapse</strong></a></li>
<li><a href="https://github.com/2005m/kit"><strong>kit</strong></a></li>
<li><a href="https://github.com/NicChr/cheapr"><strong>cheapr</strong></a></li>
<li><a href="https://github.com/NicChr/fastplyr"><strong>fastplyr</strong></a></li>
<li><a href="https://stringi.gagolewski.com/"><strong>stringi</strong></a></li>
<li><a href="https://github.com/trinker/qdapRegex"><strong>qdapRegex</strong></a></li>
<li><a href="https://github.com/jonocarroll/charcuterie"><strong>charcuterie</strong></a></li>
</ul></section><section id="functions" class="level3"><h3 class="anchored" data-anchor-id="functions">Functions</h3>
<ul>
<li><a href="https://github.com/jmbarbone/mark/blob/main/R/glob.R">mark::globbing</a></li>
<li><a href="https://github.com/raivokolde/RUtil/blob/master/Source/R/make_unique_comb.r">RUtil::make_unique_comb</a></li>
<li><a href="https://github.com/mirvie/mirmisc/blob/main/R/utils.R">mirmisc::longest_common_substring</a></li>
<li><a href="https://github.com/HughParsonage/hutils/blob/master/R/longest_affix.R">hutils::longest prefix/suffix</a></li>
<li><a href="https://github.com/m-clark/tidyext/blob/master/R/combn_2_col.R">tidyext::combn_2_col</a></li>
</ul></section>
</div>
</div>
</div>
<section id="session-information" class="level2" data-number="6.1"><h2 data-number="6.1" class="anchored" data-anchor-id="session-information">
<span class="header-section-number">6.1</span> Session Information</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<p><strong>R version 4.4.2 (2024-10-31 ucrt)</strong></p>
<p><strong>Platform:</strong> x86_64-w64-mingw32/x64</p>
<p><strong>locale:</strong> <em>LC_COLLATE=English_United States.utf8</em>, <em>LC_CTYPE=English_United States.utf8</em>, <em>LC_MONETARY=English_United States.utf8</em>, <em>LC_NUMERIC=C</em> and <em>LC_TIME=English_United States.utf8</em></p>
<p><strong>attached base packages:</strong> <em>compiler</em>, <em>stats</em>, <em>graphics</em>, <em>grDevices</em>, <em>utils</em>, <em>datasets</em>, <em>methods</em> and <em>base</em></p>
<p><strong>other attached packages:</strong> <em>codex(v.0.0.1)</em>, <em>kit(v.0.0.19)</em>, <em>collapse(v.2.0.18)</em>, <em>data.table(v.1.16.99)</em>, <em>stringfish(v.0.16.0)</em>, <em>S7(v.0.2.0)</em>, <em>vctrs(v.0.6.5)</em>, <em>cli(v.3.6.3)</em>, <em>rlang(v.1.1.4)</em>, <em>stringr(v.1.5.1)</em>, <em>purrr(v.1.0.2)</em>, <em>dplyr(v.1.1.4)</em> and <em>fuimus(v.0.0.2)</em></p>
<p><strong>loaded via a namespace (and not attached):</strong> <em>rappdirs(v.0.3.3)</em>, <em>utf8(v.1.2.4)</em>, <em>generics(v.0.1.3)</em>, <em>stringi(v.1.8.4)</em>, <em>digest(v.0.6.37)</em>, <em>magrittr(v.2.0.3)</em>, <em>evaluate(v.1.0.1)</em>, <em>fastmap(v.1.2.0)</em>, <em>rprojroot(v.2.0.4)</em>, <em>jsonlite(v.1.8.9)</em>, <em>pins(v.1.4.0)</em>, <em>pander(v.0.6.5)</em>, <em>fansi(v.1.0.6)</em>, <em>northstar(v.0.0.7)</em>, <em>textshaping(v.0.4.0)</em>, <em>RApiSerialize(v.0.1.4)</em>, <em>crayon(v.1.5.3)</em>, <em>withr(v.3.0.2)</em>, <em>yaml(v.2.3.10)</em>, <em>tools(v.4.4.2)</em>, <em>qs(v.0.27.2)</em>, <em>parallel(v.4.4.2)</em>, <em>here(v.1.0.1)</em>, <em>R6(v.2.5.1)</em>, <em>lifecycle(v.1.0.4)</em>, <em>cheapr(v.0.9.91)</em>, <em>fs(v.1.6.5)</em>, <em>htmlwidgets(v.1.6.4)</em>, <em>ragg(v.1.3.3)</em>, <em>pkgconfig(v.2.0.3)</em>, <em>RcppParallel(v.5.1.9)</em>, <em>pillar(v.1.9.0)</em>, <em>glue(v.1.8.0)</em>, <em>Rcpp(v.1.0.13-1)</em>, <em>systemfonts(v.1.1.0)</em>, <em>xfun(v.0.49)</em>, <em>tibble(v.3.2.1)</em>, <em>tidyselect(v.1.2.1)</em>, <em>rstudioapi(v.0.17.1)</em>, <em>knitr(v.1.49)</em>, <em>htmltools(v.0.5.8.1)</em> and <em>rmarkdown(v.2.29)</em></p>
</div>
</div>


<!-- -->

</section></section><a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{allen_bruce2024,
  author = {Allen Bruce, Andrew},
  title = {Learning to {Love} {Regexes} {By} {Learning} {Them}},
  date = {2024-11-28},
  url = {https://andrewallenbruce.github.io/acephale/posts/regex/regex.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-allen_bruce2024" class="csl-entry quarto-appendix-citeas" role="listitem">
Allen Bruce, Andrew. 2024. <span>“Learning to Love Regexes By Learning
Them.”</span> November 28, 2024. <a href="https://andrewallenbruce.github.io/acephale/posts/regex/regex.html">https://andrewallenbruce.github.io/acephale/posts/regex/regex.html</a>.
</div></div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/andrewallenbruce\.github\.io\/acephale\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb114" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Learning to Love Regexes By Learning Them"</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "I Promised Myself I Wouldn't Do This Again"</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Building a regex generator for self-contained, well-defined string detection problems is a very effective way to learn regular expressions."</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a><span class="co">    reference-location: margin</span></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a><span class="co">    other-links:</span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a><span class="co">      - text: Regex Cheatsheet</span></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a><span class="co">        icon: bookmark-plus</span></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a><span class="co">        href: https://github.com/raredd/regex</span></span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a><span class="co">      - text: RexEgg</span></span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a><span class="co">        icon: bookmark-plus</span></span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a><span class="co">        href: https://www.rexegg.com/</span></span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a><span class="co">      - text: Regex in R</span></span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a><span class="co">        icon: bookmark-plus</span></span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a><span class="co">        href: https://stat.ethz.ch/R-manual/R-devel/library/base/html/regex.html</span></span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true" tabindex="-1"></a><span class="an">callout-appearance:</span><span class="co"> simple</span></span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb114-22"><a href="#cb114-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-25"><a href="#cb114-25" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-26"><a href="#cb114-26" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb114-27"><a href="#cb114-27" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb114-28"><a href="#cb114-28" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb114-29"><a href="#cb114-29" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb114-30"><a href="#cb114-30" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: false</span></span>
<span id="cb114-31"><a href="#cb114-31" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(</span>
<span id="cb114-32"><a href="#cb114-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">collapse  =</span> <span class="cn">FALSE</span>,</span>
<span id="cb114-33"><a href="#cb114-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">echo      =</span> <span class="cn">TRUE</span>, </span>
<span id="cb114-34"><a href="#cb114-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">message   =</span> <span class="cn">FALSE</span>, </span>
<span id="cb114-35"><a href="#cb114-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">warning   =</span> <span class="cn">FALSE</span>,</span>
<span id="cb114-36"><a href="#cb114-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">error     =</span> <span class="cn">TRUE</span>,</span>
<span id="cb114-37"><a href="#cb114-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">comment   =</span> <span class="st">""</span>,</span>
<span id="cb114-38"><a href="#cb114-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi       =</span> <span class="dv">300</span>, </span>
<span id="cb114-39"><a href="#cb114-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">dev       =</span> <span class="st">"ragg_png"</span>,</span>
<span id="cb114-40"><a href="#cb114-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">out.width =</span> <span class="st">"100%"</span>,</span>
<span id="cb114-41"><a href="#cb114-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig.align =</span> <span class="st">"center"</span>,</span>
<span id="cb114-42"><a href="#cb114-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig.width =</span> <span class="dv">8</span></span>
<span id="cb114-43"><a href="#cb114-43" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb114-44"><a href="#cb114-44" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb114-45"><a href="#cb114-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-46"><a href="#cb114-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fuimus)</span>
<span id="cb114-47"><a href="#cb114-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-48"><a href="#cb114-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb114-49"><a href="#cb114-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb114-50"><a href="#cb114-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb114-51"><a href="#cb114-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rlang)</span>
<span id="cb114-52"><a href="#cb114-52" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cli)</span>
<span id="cb114-53"><a href="#cb114-53" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vctrs)</span>
<span id="cb114-54"><a href="#cb114-54" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(S7)</span>
<span id="cb114-55"><a href="#cb114-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-56"><a href="#cb114-56" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringfish)</span>
<span id="cb114-57"><a href="#cb114-57" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb114-58"><a href="#cb114-58" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(collapse)</span>
<span id="cb114-59"><a href="#cb114-59" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kit)</span>
<span id="cb114-60"><a href="#cb114-60" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(compiler)</span>
<span id="cb114-61"><a href="#cb114-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-62"><a href="#cb114-62" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(codex)</span>
<span id="cb114-63"><a href="#cb114-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-64"><a href="#cb114-64" aria-hidden="true" tabindex="-1"></a><span class="co"># library(dtplyr)</span></span>
<span id="cb114-65"><a href="#cb114-65" aria-hidden="true" tabindex="-1"></a><span class="co"># library(cheapr)</span></span>
<span id="cb114-66"><a href="#cb114-66" aria-hidden="true" tabindex="-1"></a><span class="co"># library(fastplyr)</span></span>
<span id="cb114-67"><a href="#cb114-67" aria-hidden="true" tabindex="-1"></a><span class="co"># library(tidyfast)</span></span>
<span id="cb114-68"><a href="#cb114-68" aria-hidden="true" tabindex="-1"></a><span class="co"># library(tidytable)</span></span>
<span id="cb114-69"><a href="#cb114-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-70"><a href="#cb114-70" aria-hidden="true" tabindex="-1"></a><span class="co"># library(re2)</span></span>
<span id="cb114-71"><a href="#cb114-71" aria-hidden="true" tabindex="-1"></a><span class="co"># library(re2r)</span></span>
<span id="cb114-72"><a href="#cb114-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-73"><a href="#cb114-73" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"posts/regex/scripts"</span>, <span class="st">"data.R"</span>))</span>
<span id="cb114-74"><a href="#cb114-74" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-75"><a href="#cb114-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-76"><a href="#cb114-76" aria-hidden="true" tabindex="-1"></a><span class="fu"># TODO {.unnumbered}</span></span>
<span id="cb114-77"><a href="#cb114-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-78"><a href="#cb114-78" aria-hidden="true" tabindex="-1"></a><span class="ss">   * </span>The *postfix* for a **wildcard** that begins with a **letter** is <span class="in">`[0-9]{n}`</span>.</span>
<span id="cb114-79"><a href="#cb114-79" aria-hidden="true" tabindex="-1"></a><span class="ss">   * </span>In <span class="in">`remove_redundant()`</span>, try pmap for <span class="in">`rr()`</span> step.</span>
<span id="cb114-80"><a href="#cb114-80" aria-hidden="true" tabindex="-1"></a><span class="ss">   * </span>Groups 3, 4 &amp; 5 beginning with letters.</span>
<span id="cb114-81"><a href="#cb114-81" aria-hidden="true" tabindex="-1"></a><span class="ss">   * </span>Group 5 ending with letters.</span>
<span id="cb114-82"><a href="#cb114-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-83"><a href="#cb114-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-84"><a href="#cb114-84" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb114-85"><a href="#cb114-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-86"><a href="#cb114-86" aria-hidden="true" tabindex="-1"></a>::: {#note-good .callout-note collapse="true"}</span>
<span id="cb114-87"><a href="#cb114-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-88"><a href="#cb114-88" aria-hidden="true" tabindex="-1"></a><span class="fu">### Good Examples</span></span>
<span id="cb114-89"><a href="#cb114-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-90"><a href="#cb114-90" aria-hidden="true" tabindex="-1"></a><span class="fu">### Case 1</span></span>
<span id="cb114-91"><a href="#cb114-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-94"><a href="#cb114-94" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-95"><a href="#cb114-95" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: case_1</span></span>
<span id="cb114-96"><a href="#cb114-96" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb114-97"><a href="#cb114-97" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="st">"L80"</span>, </span>
<span id="cb114-98"><a href="#cb114-98" aria-hidden="true" tabindex="-1"></a>     <span class="fu">c</span>(<span class="st">"L56"</span>, <span class="st">"L59"</span>))</span>
<span id="cb114-99"><a href="#cb114-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-100"><a href="#cb114-100" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">sf_extract</span>(hcpcs, <span class="st">"^L56|^L59|^L80"</span>))</span>
<span id="cb114-101"><a href="#cb114-101" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">sf_extract</span>(hcpcs, <span class="st">"^L(5[69]|80)[0-9]{2}$"</span>))</span>
<span id="cb114-102"><a href="#cb114-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-103"><a href="#cb114-103" aria-hidden="true" tabindex="-1"></a>bench<span class="sc">::</span><span class="fu">mark</span>(</span>
<span id="cb114-104"><a href="#cb114-104" aria-hidden="true" tabindex="-1"></a>  <span class="at">raw =</span> <span class="fu">sf_extract</span>(hcpcs, <span class="st">"^L56|^L59|^L80"</span>),</span>
<span id="cb114-105"><a href="#cb114-105" aria-hidden="true" tabindex="-1"></a>  <span class="at">compact =</span> <span class="fu">sf_extract</span>(hcpcs, <span class="st">"^L(5[69]|80)[0-9]{2}$"</span>),</span>
<span id="cb114-106"><a href="#cb114-106" aria-hidden="true" tabindex="-1"></a>  <span class="at">iterations =</span> <span class="dv">10000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb114-107"><a href="#cb114-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(expression<span class="sc">:</span>total_time)</span>
<span id="cb114-108"><a href="#cb114-108" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-109"><a href="#cb114-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-110"><a href="#cb114-110" aria-hidden="true" tabindex="-1"></a><span class="fu">### Case 2</span></span>
<span id="cb114-111"><a href="#cb114-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-114"><a href="#cb114-114" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-115"><a href="#cb114-115" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: case_2</span></span>
<span id="cb114-116"><a href="#cb114-116" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb114-117"><a href="#cb114-117" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"021"</span>, <span class="st">"022"</span>, <span class="st">"026"</span>, <span class="st">"027"</span>), </span>
<span id="cb114-118"><a href="#cb114-118" aria-hidden="true" tabindex="-1"></a>     <span class="fu">c</span>(<span class="st">"032"</span>, <span class="st">"033"</span>), </span>
<span id="cb114-119"><a href="#cb114-119" aria-hidden="true" tabindex="-1"></a>     <span class="fu">c</span>(<span class="st">"042"</span>, <span class="st">"044"</span>), </span>
<span id="cb114-120"><a href="#cb114-120" aria-hidden="true" tabindex="-1"></a>     <span class="st">"050"</span>)</span>
<span id="cb114-121"><a href="#cb114-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-122"><a href="#cb114-122" aria-hidden="true" tabindex="-1"></a>bench<span class="sc">::</span><span class="fu">mark</span>(</span>
<span id="cb114-123"><a href="#cb114-123" aria-hidden="true" tabindex="-1"></a>  <span class="at">raw =</span> <span class="fu">sf_extract</span>(hcpcs, <span class="st">"^021|^022|^026|^027|^032|^033|^042|^044|^050"</span>),</span>
<span id="cb114-124"><a href="#cb114-124" aria-hidden="true" tabindex="-1"></a>  <span class="at">compact =</span> <span class="fu">sf_extract</span>(hcpcs, <span class="fu">sf_convert</span>(<span class="st">"^0(2[1267]|3[23]|4[24]|50)[A-Z0-9]{2}$"</span>)),</span>
<span id="cb114-125"><a href="#cb114-125" aria-hidden="true" tabindex="-1"></a>  <span class="at">iterations =</span> <span class="dv">10000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb114-126"><a href="#cb114-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(expression<span class="sc">:</span>total_time)</span>
<span id="cb114-127"><a href="#cb114-127" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-128"><a href="#cb114-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-129"><a href="#cb114-129" aria-hidden="true" tabindex="-1"></a><span class="fu">### Case 3</span></span>
<span id="cb114-130"><a href="#cb114-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-133"><a href="#cb114-133" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-134"><a href="#cb114-134" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: case_3</span></span>
<span id="cb114-135"><a href="#cb114-135" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb114-136"><a href="#cb114-136" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"C75"</span>, <span class="st">"C97"</span>),</span>
<span id="cb114-137"><a href="#cb114-137" aria-hidden="true" tabindex="-1"></a>     <span class="fu">c</span>(<span class="st">"G02"</span>, <span class="st">"G04"</span>))</span>
<span id="cb114-138"><a href="#cb114-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-139"><a href="#cb114-139" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">sf_extract</span>(hcpcs, <span class="st">"^C75|^C97|^G02|^G04"</span>))</span>
<span id="cb114-140"><a href="#cb114-140" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">sf_extract</span>(hcpcs, <span class="st">"^C(75|97)[0-9]{2}$|^G0[24][0-9]{2}$"</span>))</span>
<span id="cb114-141"><a href="#cb114-141" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">sf_extract</span>(hcpcs, <span class="st">"^(C(75|97)|G0[24])[0-9]{2}$"</span>))</span>
<span id="cb114-142"><a href="#cb114-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-143"><a href="#cb114-143" aria-hidden="true" tabindex="-1"></a>bench<span class="sc">::</span><span class="fu">mark</span>(</span>
<span id="cb114-144"><a href="#cb114-144" aria-hidden="true" tabindex="-1"></a>  <span class="at">raw =</span> <span class="fu">sf_extract</span>(hcpcs, <span class="st">"^C75|^C97|^G02|^G04"</span>),</span>
<span id="cb114-145"><a href="#cb114-145" aria-hidden="true" tabindex="-1"></a>  <span class="at">reduced =</span> <span class="fu">sf_extract</span>(hcpcs, <span class="st">"^C(75|97)[0-9]{2}$|^G0[24][0-9]{2}$"</span>),</span>
<span id="cb114-146"><a href="#cb114-146" aria-hidden="true" tabindex="-1"></a>  <span class="at">compact =</span> <span class="fu">sf_extract</span>(hcpcs, <span class="fu">sf_convert</span>(<span class="st">"^(C(75|97)|G0[24])[0-9]{2}$"</span>)),</span>
<span id="cb114-147"><a href="#cb114-147" aria-hidden="true" tabindex="-1"></a>  <span class="at">iterations =</span> <span class="dv">10000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb114-148"><a href="#cb114-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(expression<span class="sc">:</span>total_time)</span>
<span id="cb114-149"><a href="#cb114-149" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-150"><a href="#cb114-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-151"><a href="#cb114-151" aria-hidden="true" tabindex="-1"></a><span class="fu">### Case 4</span></span>
<span id="cb114-152"><a href="#cb114-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-155"><a href="#cb114-155" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-156"><a href="#cb114-156" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: case_4</span></span>
<span id="cb114-157"><a href="#cb114-157" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb114-158"><a href="#cb114-158" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="st">"0[2-5]"</span>, </span>
<span id="cb114-159"><a href="#cb114-159" aria-hidden="true" tabindex="-1"></a>     <span class="st">"15"</span>, </span>
<span id="cb114-160"><a href="#cb114-160" aria-hidden="true" tabindex="-1"></a>     <span class="st">"2[027]"</span>, </span>
<span id="cb114-161"><a href="#cb114-161" aria-hidden="true" tabindex="-1"></a>     <span class="st">"3[0-24-6]"</span>, </span>
<span id="cb114-162"><a href="#cb114-162" aria-hidden="true" tabindex="-1"></a>     <span class="st">"5[0458]"</span>, </span>
<span id="cb114-163"><a href="#cb114-163" aria-hidden="true" tabindex="-1"></a>     <span class="st">"6[134]"</span>, </span>
<span id="cb114-164"><a href="#cb114-164" aria-hidden="true" tabindex="-1"></a>     <span class="st">"76"</span>, </span>
<span id="cb114-165"><a href="#cb114-165" aria-hidden="true" tabindex="-1"></a>     <span class="st">"9[25]"</span>, </span>
<span id="cb114-166"><a href="#cb114-166" aria-hidden="true" tabindex="-1"></a>     <span class="st">"C[79]"</span>, </span>
<span id="cb114-167"><a href="#cb114-167" aria-hidden="true" tabindex="-1"></a>     <span class="st">"E0"</span>, </span>
<span id="cb114-168"><a href="#cb114-168" aria-hidden="true" tabindex="-1"></a>     <span class="st">"G0"</span>, </span>
<span id="cb114-169"><a href="#cb114-169" aria-hidden="true" tabindex="-1"></a>     <span class="st">"S2"</span>) <span class="ot">-&gt;</span> c4list</span>
<span id="cb114-170"><a href="#cb114-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-171"><a href="#cb114-171" aria-hidden="true" tabindex="-1"></a>c4list</span>
<span id="cb114-172"><a href="#cb114-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-173"><a href="#cb114-173" aria-hidden="true" tabindex="-1"></a>c4raw <span class="ot">&lt;-</span> <span class="st">"^02|^03|^04|^05|^15|^20|^22|^27|^30|^31|^32|^34|^35|^36|^50|^54|^55|^58|^61|^63|^64|^76|^92|^95|^C7|^C9|^E0|^G0|^S2"</span></span>
<span id="cb114-174"><a href="#cb114-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-175"><a href="#cb114-175" aria-hidden="true" tabindex="-1"></a>c4compact <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"^("</span>, <span class="fu">sf_collapse</span>(<span class="fu">list_c</span>(c4list), <span class="at">collapse =</span> <span class="st">"|"</span>), <span class="st">")[A-Z0-9]{3}$"</span>)</span>
<span id="cb114-176"><a href="#cb114-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-177"><a href="#cb114-177" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">sf_extract</span>(hcpcs, c4raw))</span>
<span id="cb114-178"><a href="#cb114-178" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">sf_extract</span>(hcpcs, c4compact))</span>
<span id="cb114-179"><a href="#cb114-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-180"><a href="#cb114-180" aria-hidden="true" tabindex="-1"></a>bench<span class="sc">::</span><span class="fu">mark</span>(</span>
<span id="cb114-181"><a href="#cb114-181" aria-hidden="true" tabindex="-1"></a>  <span class="at">raw =</span> <span class="fu">sf_extract</span>(hcpcs, c4raw),</span>
<span id="cb114-182"><a href="#cb114-182" aria-hidden="true" tabindex="-1"></a>  <span class="at">compact =</span> <span class="fu">sf_extract</span>(hcpcs, c4compact),</span>
<span id="cb114-183"><a href="#cb114-183" aria-hidden="true" tabindex="-1"></a>  <span class="at">iterations =</span> <span class="dv">10000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb114-184"><a href="#cb114-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(expression<span class="sc">:</span>total_time)</span>
<span id="cb114-185"><a href="#cb114-185" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-186"><a href="#cb114-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-187"><a href="#cb114-187" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb114-188"><a href="#cb114-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-189"><a href="#cb114-189" aria-hidden="true" tabindex="-1"></a>&lt;hr&gt;</span>
<span id="cb114-190"><a href="#cb114-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-191"><a href="#cb114-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-192"><a href="#cb114-192" aria-hidden="true" tabindex="-1"></a><span class="fu"># Preprocess Steps</span></span>
<span id="cb114-193"><a href="#cb114-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-196"><a href="#cb114-196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-197"><a href="#cb114-197" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: print_method</span></span>
<span id="cb114-198"><a href="#cb114-198" aria-hidden="true" tabindex="-1"></a>view <span class="ot">&lt;-</span> \(x) {</span>
<span id="cb114-199"><a href="#cb114-199" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-200"><a href="#cb114-200" aria-hidden="true" tabindex="-1"></a>  grp_name <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">seq_along</span>(x))</span>
<span id="cb114-201"><a href="#cb114-201" aria-hidden="true" tabindex="-1"></a>  grp_size <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">vlen</span>(x), <span class="at">justify =</span> <span class="st">"left"</span>)</span>
<span id="cb114-202"><a href="#cb114-202" aria-hidden="true" tabindex="-1"></a>  grp_mems <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">modify_if</span>(</span>
<span id="cb114-203"><a href="#cb114-203" aria-hidden="true" tabindex="-1"></a>    x, vctrs<span class="sc">::</span>obj_is_list, </span>
<span id="cb114-204"><a href="#cb114-204" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(x) <span class="fu">paste0</span>(<span class="st">"("</span>, <span class="fu">map_chr</span>(x, \(x) <span class="fu">paste0</span>(x, <span class="at">collapse =</span> <span class="st">" "</span>)), <span class="st">")"</span>))</span>
<span id="cb114-205"><a href="#cb114-205" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-206"><a href="#cb114-206" aria-hidden="true" tabindex="-1"></a>  grp_mems <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">unname</span>(grp_mems), <span class="at">justify =</span> <span class="st">"none"</span>)</span>
<span id="cb114-207"><a href="#cb114-207" aria-hidden="true" tabindex="-1"></a>  grp_mems <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">empty</span>(grp_mems)) <span class="cn">NULL</span> <span class="cf">else</span> grp_mems</span>
<span id="cb114-208"><a href="#cb114-208" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-209"><a href="#cb114-209" aria-hidden="true" tabindex="-1"></a>  msg <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(</span>
<span id="cb114-210"><a href="#cb114-210" aria-hidden="true" tabindex="-1"></a>      <span class="st">"{grp_name}: "</span>,</span>
<span id="cb114-211"><a href="#cb114-211" aria-hidden="true" tabindex="-1"></a>      <span class="st">"{grp_size}|"</span>,</span>
<span id="cb114-212"><a href="#cb114-212" aria-hidden="true" tabindex="-1"></a>      <span class="st">"-[{grp_mems}]"</span></span>
<span id="cb114-213"><a href="#cb114-213" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb114-214"><a href="#cb114-214" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-215"><a href="#cb114-215" aria-hidden="true" tabindex="-1"></a>  cli<span class="sc">::</span><span class="fu">cat_bullet</span>(msg)</span>
<span id="cb114-216"><a href="#cb114-216" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-217"><a href="#cb114-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">invisible</span>(x))</span>
<span id="cb114-218"><a href="#cb114-218" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-219"><a href="#cb114-219" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-220"><a href="#cb114-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-223"><a href="#cb114-223" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-224"><a href="#cb114-224" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: preprocess</span></span>
<span id="cb114-225"><a href="#cb114-225" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">random_hcpcs</span>(<span class="dv">50</span>)</span>
<span id="cb114-226"><a href="#cb114-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-227"><a href="#cb114-227" aria-hidden="true" tabindex="-1"></a>x <span class="sc">|&gt;</span> </span>
<span id="cb114-228"><a href="#cb114-228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-229"><a href="#cb114-229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">view</span>()</span>
<span id="cb114-230"><a href="#cb114-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-231"><a href="#cb114-231" aria-hidden="true" tabindex="-1"></a>x <span class="sc">|&gt;</span></span>
<span id="cb114-232"><a href="#cb114-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-233"><a href="#cb114-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-234"><a href="#cb114-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">view</span>()</span>
<span id="cb114-235"><a href="#cb114-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-236"><a href="#cb114-236" aria-hidden="true" tabindex="-1"></a>x <span class="sc">|&gt;</span></span>
<span id="cb114-237"><a href="#cb114-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-238"><a href="#cb114-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-239"><a href="#cb114-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-240"><a href="#cb114-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">view</span>()</span>
<span id="cb114-241"><a href="#cb114-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-242"><a href="#cb114-242" aria-hidden="true" tabindex="-1"></a><span class="fu">random_hcpcs</span>(<span class="dv">50</span>) <span class="sc">|&gt;</span> </span>
<span id="cb114-243"><a href="#cb114-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-244"><a href="#cb114-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-245"><a href="#cb114-245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-246"><a href="#cb114-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">view</span>()</span>
<span id="cb114-247"><a href="#cb114-247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-248"><a href="#cb114-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-249"><a href="#cb114-249" aria-hidden="true" tabindex="-1"></a>&lt;hr&gt;</span>
<span id="cb114-250"><a href="#cb114-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-251"><a href="#cb114-251" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb114-252"><a href="#cb114-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-253"><a href="#cb114-253" aria-hidden="true" tabindex="-1"></a><span class="fu"># Process Groups</span></span>
<span id="cb114-254"><a href="#cb114-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-255"><a href="#cb114-255" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb114-256"><a href="#cb114-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-257"><a href="#cb114-257" aria-hidden="true" tabindex="-1"></a><span class="fu">## Group 3</span></span>
<span id="cb114-258"><a href="#cb114-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-261"><a href="#cb114-261" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-262"><a href="#cb114-262" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: group_3</span></span>
<span id="cb114-263"><a href="#cb114-263" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">"C75"</span>, <span class="st">"C97"</span>, <span class="st">"G02"</span>, <span class="st">"G04"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb114-264"><a href="#cb114-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-265"><a href="#cb114-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-266"><a href="#cb114-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-267"><a href="#cb114-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_3</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-268"><a href="#cb114-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">view</span>()</span>
<span id="cb114-269"><a href="#cb114-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-270"><a href="#cb114-270" aria-hidden="true" tabindex="-1"></a>long_test2[<span class="fu">nchar</span>(long_test2) <span class="sc">==</span> <span class="dv">3</span>] <span class="sc">|&gt;</span> </span>
<span id="cb114-271"><a href="#cb114-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-272"><a href="#cb114-272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-273"><a href="#cb114-273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-274"><a href="#cb114-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_3</span>()</span>
<span id="cb114-275"><a href="#cb114-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-276"><a href="#cb114-276" aria-hidden="true" tabindex="-1"></a><span class="fu">random_hcpcs</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-277"><a href="#cb114-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-278"><a href="#cb114-278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-279"><a href="#cb114-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-280"><a href="#cb114-280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_3</span>()</span>
<span id="cb114-281"><a href="#cb114-281" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-282"><a href="#cb114-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-283"><a href="#cb114-283" aria-hidden="true" tabindex="-1"></a><span class="fu">## Group 4</span></span>
<span id="cb114-284"><a href="#cb114-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-287"><a href="#cb114-287" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-288"><a href="#cb114-288" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: group_4_old</span></span>
<span id="cb114-289"><a href="#cb114-289" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: true</span></span>
<span id="cb114-290"><a href="#cb114-290" aria-hidden="true" tabindex="-1"></a>old_group_4 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb114-291"><a href="#cb114-291" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">getelem</span>(x, <span class="st">"x4"</span>)</span>
<span id="cb114-292"><a href="#cb114-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-293"><a href="#cb114-293" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">empty</span>(x))</span>
<span id="cb114-294"><a href="#cb114-294" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb114-295"><a href="#cb114-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-296"><a href="#cb114-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(x, <span class="cf">function</span>(x) {</span>
<span id="cb114-297"><a href="#cb114-297" aria-hidden="true" tabindex="-1"></a>    idx <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb114-298"><a href="#cb114-298" aria-hidden="true" tabindex="-1"></a>      <span class="at">code =</span> x,</span>
<span id="cb114-299"><a href="#cb114-299" aria-hidden="true" tabindex="-1"></a>      <span class="at">grp1 =</span> <span class="fu">sf_sub</span>(x, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb114-300"><a href="#cb114-300" aria-hidden="true" tabindex="-1"></a>      <span class="at">grp2 =</span> <span class="fu">sf_sub</span>(x, <span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb114-301"><a href="#cb114-301" aria-hidden="true" tabindex="-1"></a>      <span class="at">a1 =</span> <span class="fu">take_at</span>(x),</span>
<span id="cb114-302"><a href="#cb114-302" aria-hidden="true" tabindex="-1"></a>      <span class="at">a2 =</span> <span class="fu">take_at</span>(x, <span class="dv">2</span>),</span>
<span id="cb114-303"><a href="#cb114-303" aria-hidden="true" tabindex="-1"></a>      <span class="at">a3 =</span> <span class="fu">take_at</span>(x, <span class="dv">3</span>),</span>
<span id="cb114-304"><a href="#cb114-304" aria-hidden="true" tabindex="-1"></a>      <span class="at">a4 =</span> <span class="fu">take_at</span>(x, <span class="dv">4</span>),</span>
<span id="cb114-305"><a href="#cb114-305" aria-hidden="true" tabindex="-1"></a>      <span class="at">i1 =</span> <span class="fu">groupid</span>(<span class="fu">take_at</span>(x))</span>
<span id="cb114-306"><a href="#cb114-306" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb114-307"><a href="#cb114-307" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb114-308"><a href="#cb114-308" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">"Initial data frame"</span>)</span>
<span id="cb114-309"><a href="#cb114-309" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(idx)</span>
<span id="cb114-310"><a href="#cb114-310" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb114-311"><a href="#cb114-311" aria-hidden="true" tabindex="-1"></a>    idx <span class="ot">&lt;-</span> idx <span class="sc">|&gt;</span></span>
<span id="cb114-312"><a href="#cb114-312" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fgroup_by</span>(a1) <span class="sc">|&gt;</span></span>
<span id="cb114-313"><a href="#cb114-313" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fmutate</span>(<span class="at">i2 =</span> <span class="fu">groupid</span>(a2)) <span class="sc">|&gt;</span></span>
<span id="cb114-314"><a href="#cb114-314" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fgroup_by</span>(a1, a2) <span class="sc">|&gt;</span></span>
<span id="cb114-315"><a href="#cb114-315" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fmutate</span>(<span class="at">i3 =</span> <span class="fu">groupid</span>(a3)) <span class="sc">|&gt;</span></span>
<span id="cb114-316"><a href="#cb114-316" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fgroup_by</span>(a1, a2, a3) <span class="sc">|&gt;</span></span>
<span id="cb114-317"><a href="#cb114-317" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fmutate</span>(<span class="at">i4 =</span> <span class="fu">groupid</span>(a4)) <span class="sc">|&gt;</span></span>
<span id="cb114-318"><a href="#cb114-318" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fungroup</span>()</span>
<span id="cb114-319"><a href="#cb114-319" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb114-320"><a href="#cb114-320" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">"Grouped data frame"</span>)</span>
<span id="cb114-321"><a href="#cb114-321" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(idx)</span>
<span id="cb114-322"><a href="#cb114-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-323"><a href="#cb114-323" aria-hidden="true" tabindex="-1"></a>    lone <span class="ot">&lt;-</span> <span class="fu">fcount</span>(idx, i1, <span class="at">add =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb114-324"><a href="#cb114-324" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fmutate</span>(<span class="st">`</span><span class="at">i2 + i3 + i4 + N</span><span class="st">`</span> <span class="ot">=</span> i2 <span class="sc">+</span> i3 <span class="sc">+</span> i4 <span class="sc">+</span> N)</span>
<span id="cb114-325"><a href="#cb114-325" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb114-326"><a href="#cb114-326" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">"Lone Counted"</span>)</span>
<span id="cb114-327"><a href="#cb114-327" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(lone)</span>
<span id="cb114-328"><a href="#cb114-328" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb114-329"><a href="#cb114-329" aria-hidden="true" tabindex="-1"></a>    lone <span class="ot">&lt;-</span> lone <span class="sc">|&gt;</span></span>
<span id="cb114-330"><a href="#cb114-330" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fsubset</span>((i2 <span class="sc">+</span> i3 <span class="sc">+</span> i4 <span class="sc">+</span> N) <span class="sc">==</span> <span class="dv">4</span>)</span>
<span id="cb114-331"><a href="#cb114-331" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb114-332"><a href="#cb114-332" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">"Lone i2 + i3 + i4 + N == 4"</span>)</span>
<span id="cb114-333"><a href="#cb114-333" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(lone)</span>
<span id="cb114-334"><a href="#cb114-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-335"><a href="#cb114-335" aria-hidden="true" tabindex="-1"></a>    last <span class="ot">&lt;-</span> <span class="fu">fsubset</span>(idx, code <span class="sc">%!in%</span> lone[[<span class="st">"code"</span>]])</span>
<span id="cb114-336"><a href="#cb114-336" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb114-337"><a href="#cb114-337" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">"Last Filtered"</span>)</span>
<span id="cb114-338"><a href="#cb114-338" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(last)</span>
<span id="cb114-339"><a href="#cb114-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-340"><a href="#cb114-340" aria-hidden="true" tabindex="-1"></a>    last <span class="ot">&lt;-</span> <span class="fu">join</span>(</span>
<span id="cb114-341"><a href="#cb114-341" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fcount</span>(last, grp1, a3),</span>
<span id="cb114-342"><a href="#cb114-342" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fcount</span>(last, grp1, <span class="at">name =</span> <span class="st">"G"</span>),</span>
<span id="cb114-343"><a href="#cb114-343" aria-hidden="true" tabindex="-1"></a>      <span class="at">on =</span> <span class="st">"grp1"</span>,</span>
<span id="cb114-344"><a href="#cb114-344" aria-hidden="true" tabindex="-1"></a>      <span class="at">verbose =</span> <span class="dv">0</span></span>
<span id="cb114-345"><a href="#cb114-345" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb114-346"><a href="#cb114-346" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fsubset</span>(N <span class="sc">==</span> G) <span class="sc">|&gt;</span></span>
<span id="cb114-347"><a href="#cb114-347" aria-hidden="true" tabindex="-1"></a>      <span class="fu">join</span>(</span>
<span id="cb114-348"><a href="#cb114-348" aria-hidden="true" tabindex="-1"></a>        last,</span>
<span id="cb114-349"><a href="#cb114-349" aria-hidden="true" tabindex="-1"></a>        <span class="at">on =</span> <span class="fu">c</span>(<span class="st">"grp1"</span>, <span class="st">"a3"</span>),</span>
<span id="cb114-350"><a href="#cb114-350" aria-hidden="true" tabindex="-1"></a>        <span class="at">how =</span> <span class="st">"right"</span>,</span>
<span id="cb114-351"><a href="#cb114-351" aria-hidden="true" tabindex="-1"></a>        <span class="at">verbose =</span> <span class="dv">0</span></span>
<span id="cb114-352"><a href="#cb114-352" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb114-353"><a href="#cb114-353" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb114-354"><a href="#cb114-354" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">"Last Joined"</span>)</span>
<span id="cb114-355"><a href="#cb114-355" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(last)</span>
<span id="cb114-356"><a href="#cb114-356" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb114-357"><a href="#cb114-357" aria-hidden="true" tabindex="-1"></a>    last <span class="ot">&lt;-</span> last <span class="sc">|&gt;</span></span>
<span id="cb114-358"><a href="#cb114-358" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fsubset</span>(<span class="fu">not_na</span>(N))</span>
<span id="cb114-359"><a href="#cb114-359" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb114-360"><a href="#cb114-360" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">"Last Filtered"</span>)</span>
<span id="cb114-361"><a href="#cb114-361" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(last)</span>
<span id="cb114-362"><a href="#cb114-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-363"><a href="#cb114-363" aria-hidden="true" tabindex="-1"></a>    rest <span class="ot">&lt;-</span> <span class="fu">fsubset</span>(idx, code <span class="sc">%!in%</span> <span class="fu">c</span>(lone[[<span class="st">"code"</span>]], last[[<span class="st">"code"</span>]]))</span>
<span id="cb114-364"><a href="#cb114-364" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb114-365"><a href="#cb114-365" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">"Rest Filtered"</span>)</span>
<span id="cb114-366"><a href="#cb114-366" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(rest)</span>
<span id="cb114-367"><a href="#cb114-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-368"><a href="#cb114-368" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb114-369"><a href="#cb114-369" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">empty</span>(lone))</span>
<span id="cb114-370"><a href="#cb114-370" aria-hidden="true" tabindex="-1"></a>        <span class="cn">NULL</span></span>
<span id="cb114-371"><a href="#cb114-371" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span></span>
<span id="cb114-372"><a href="#cb114-372" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(lone[[<span class="st">"code"</span>]]),</span>
<span id="cb114-373"><a href="#cb114-373" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">empty</span>(last))</span>
<span id="cb114-374"><a href="#cb114-374" aria-hidden="true" tabindex="-1"></a>        <span class="cn">NULL</span></span>
<span id="cb114-375"><a href="#cb114-375" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span></span>
<span id="cb114-376"><a href="#cb114-376" aria-hidden="true" tabindex="-1"></a>        <span class="fu">gchop</span>(last[[<span class="st">"code"</span>]], last[[<span class="st">"grp1"</span>]]),</span>
<span id="cb114-377"><a href="#cb114-377" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">empty</span>(rest))</span>
<span id="cb114-378"><a href="#cb114-378" aria-hidden="true" tabindex="-1"></a>        <span class="cn">NULL</span></span>
<span id="cb114-379"><a href="#cb114-379" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span></span>
<span id="cb114-380"><a href="#cb114-380" aria-hidden="true" tabindex="-1"></a>        <span class="fu">gchop</span>(rest[[<span class="st">"code"</span>]], rest[[<span class="st">"grp2"</span>]])</span>
<span id="cb114-381"><a href="#cb114-381" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb114-382"><a href="#cb114-382" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb114-383"><a href="#cb114-383" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-384"><a href="#cb114-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-385"><a href="#cb114-385" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">"C751"</span>, <span class="st">"C752"</span>, <span class="st">"C970"</span>, <span class="st">"G020"</span>, <span class="st">"G021"</span>, <span class="st">"G040"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb114-386"><a href="#cb114-386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-387"><a href="#cb114-387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-388"><a href="#cb114-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-389"><a href="#cb114-389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">old_group_4</span>()</span>
<span id="cb114-390"><a href="#cb114-390" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-391"><a href="#cb114-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-392"><a href="#cb114-392" aria-hidden="true" tabindex="-1"></a><span class="fu">## Group 5</span></span>
<span id="cb114-393"><a href="#cb114-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-396"><a href="#cb114-396" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-397"><a href="#cb114-397" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: group_5_num</span></span>
<span id="cb114-398"><a href="#cb114-398" aria-hidden="true" tabindex="-1"></a>group_5_num <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb114-399"><a href="#cb114-399" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-400"><a href="#cb114-400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(x, <span class="cf">function</span>(x) {</span>
<span id="cb114-401"><a href="#cb114-401" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb114-402"><a href="#cb114-402" aria-hidden="true" tabindex="-1"></a>    idx <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb114-403"><a href="#cb114-403" aria-hidden="true" tabindex="-1"></a>      <span class="at">code =</span> x,</span>
<span id="cb114-404"><a href="#cb114-404" aria-hidden="true" tabindex="-1"></a>      <span class="at">grp1 =</span> <span class="fu">sf_sub</span>(x, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb114-405"><a href="#cb114-405" aria-hidden="true" tabindex="-1"></a>      <span class="at">grp2 =</span> <span class="fu">sf_sub</span>(x, <span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb114-406"><a href="#cb114-406" aria-hidden="true" tabindex="-1"></a>      <span class="at">grp3 =</span> <span class="fu">sf_sub</span>(x, <span class="dv">1</span>, <span class="dv">4</span>),</span>
<span id="cb114-407"><a href="#cb114-407" aria-hidden="true" tabindex="-1"></a>      <span class="at">a1 =</span> <span class="fu">take_at</span>(x),</span>
<span id="cb114-408"><a href="#cb114-408" aria-hidden="true" tabindex="-1"></a>      <span class="at">a2 =</span> <span class="fu">take_at</span>(x, <span class="dv">2</span>),</span>
<span id="cb114-409"><a href="#cb114-409" aria-hidden="true" tabindex="-1"></a>      <span class="at">a3 =</span> <span class="fu">take_at</span>(x, <span class="dv">3</span>),</span>
<span id="cb114-410"><a href="#cb114-410" aria-hidden="true" tabindex="-1"></a>      <span class="at">a4 =</span> <span class="fu">take_at</span>(x, <span class="dv">4</span>),</span>
<span id="cb114-411"><a href="#cb114-411" aria-hidden="true" tabindex="-1"></a>      <span class="at">a5 =</span> <span class="fu">take_at</span>(x, <span class="dv">5</span>),</span>
<span id="cb114-412"><a href="#cb114-412" aria-hidden="true" tabindex="-1"></a>      <span class="at">i1 =</span> <span class="fu">groupid</span>(<span class="fu">take_at</span>(x))) <span class="sc">|&gt;</span></span>
<span id="cb114-413"><a href="#cb114-413" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fgroup_by</span>(a1) <span class="sc">|&gt;</span> </span>
<span id="cb114-414"><a href="#cb114-414" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fmutate</span>(<span class="at">i2 =</span> <span class="fu">groupid</span>(a2)) <span class="sc">|&gt;</span></span>
<span id="cb114-415"><a href="#cb114-415" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fgroup_by</span>(a1, a2) <span class="sc">|&gt;</span> </span>
<span id="cb114-416"><a href="#cb114-416" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fmutate</span>(<span class="at">i3 =</span> <span class="fu">groupid</span>(a3)) <span class="sc">|&gt;</span></span>
<span id="cb114-417"><a href="#cb114-417" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fgroup_by</span>(a1, a2, a3) <span class="sc">|&gt;</span> </span>
<span id="cb114-418"><a href="#cb114-418" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fmutate</span>(<span class="at">i4 =</span> <span class="fu">groupid</span>(a4)) <span class="sc">|&gt;</span></span>
<span id="cb114-419"><a href="#cb114-419" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fgroup_by</span>(a1, a2, a3, a4) <span class="sc">|&gt;</span> </span>
<span id="cb114-420"><a href="#cb114-420" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fmutate</span>(<span class="at">i5 =</span> <span class="fu">groupid</span>(a5)) <span class="sc">|&gt;</span> </span>
<span id="cb114-421"><a href="#cb114-421" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fungroup</span>()</span>
<span id="cb114-422"><a href="#cb114-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-423"><a href="#cb114-423" aria-hidden="true" tabindex="-1"></a>      lone <span class="ot">&lt;-</span> <span class="fu">fcount</span>(idx, i1, <span class="at">add =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb114-424"><a href="#cb114-424" aria-hidden="true" tabindex="-1"></a>        <span class="fu">fsubset</span>((i2 <span class="sc">+</span> i3 <span class="sc">+</span> i4 <span class="sc">+</span> i5 <span class="sc">+</span> N) <span class="sc">==</span> <span class="dv">5</span>)</span>
<span id="cb114-425"><a href="#cb114-425" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb114-426"><a href="#cb114-426" aria-hidden="true" tabindex="-1"></a>      last <span class="ot">&lt;-</span> <span class="fu">fsubset</span>(idx, code <span class="sc">%!in%</span> lone[[<span class="st">"code"</span>]])</span>
<span id="cb114-427"><a href="#cb114-427" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb114-428"><a href="#cb114-428" aria-hidden="true" tabindex="-1"></a>      last <span class="ot">&lt;-</span> <span class="fu">join</span>(</span>
<span id="cb114-429"><a href="#cb114-429" aria-hidden="true" tabindex="-1"></a>        <span class="fu">fcount</span>(last, grp2, a4),</span>
<span id="cb114-430"><a href="#cb114-430" aria-hidden="true" tabindex="-1"></a>        <span class="fu">fcount</span>(last, grp2, <span class="at">name =</span> <span class="st">"G"</span>), <span class="at">on =</span> <span class="st">"grp2"</span>, <span class="at">verbose =</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb114-431"><a href="#cb114-431" aria-hidden="true" tabindex="-1"></a>        <span class="fu">fsubset</span>(N <span class="sc">==</span> G) <span class="sc">|&gt;</span></span>
<span id="cb114-432"><a href="#cb114-432" aria-hidden="true" tabindex="-1"></a>        <span class="fu">join</span>(last, <span class="at">on =</span> <span class="fu">c</span>(<span class="st">"grp2"</span>, <span class="st">"a4"</span>), <span class="at">how =</span> <span class="st">"right"</span>, <span class="at">verbose =</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb114-433"><a href="#cb114-433" aria-hidden="true" tabindex="-1"></a>        <span class="fu">fsubset</span>(<span class="fu">not_na</span>(N))</span>
<span id="cb114-434"><a href="#cb114-434" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb114-435"><a href="#cb114-435" aria-hidden="true" tabindex="-1"></a>      rest <span class="ot">&lt;-</span> <span class="fu">fsubset</span>(idx, code <span class="sc">%!in%</span> <span class="fu">c</span>(lone[[<span class="st">"code"</span>]], last[[<span class="st">"code"</span>]]))</span>
<span id="cb114-436"><a href="#cb114-436" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb114-437"><a href="#cb114-437" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="cf">if</span> (<span class="fu">empty</span>(lone)) <span class="cn">NULL</span> <span class="cf">else</span> <span class="fu">list</span>(lone[[<span class="st">"code"</span>]]),</span>
<span id="cb114-438"><a href="#cb114-438" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">empty</span>(last)) <span class="cn">NULL</span> <span class="cf">else</span> <span class="fu">gchop</span>(last[[<span class="st">"code"</span>]], last[[<span class="st">"grp2"</span>]]),</span>
<span id="cb114-439"><a href="#cb114-439" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">empty</span>(rest)) <span class="cn">NULL</span> <span class="cf">else</span> <span class="fu">gchop</span>(rest[[<span class="st">"code"</span>]], rest[[<span class="st">"grp3"</span>]]))</span>
<span id="cb114-440"><a href="#cb114-440" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb114-441"><a href="#cb114-441" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-442"><a href="#cb114-442" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-443"><a href="#cb114-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-446"><a href="#cb114-446" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-447"><a href="#cb114-447" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: group_5_chr</span></span>
<span id="cb114-448"><a href="#cb114-448" aria-hidden="true" tabindex="-1"></a>group_5_chr <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb114-449"><a href="#cb114-449" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-450"><a href="#cb114-450" aria-hidden="true" tabindex="-1"></a>  original <span class="ot">&lt;-</span> x</span>
<span id="cb114-451"><a href="#cb114-451" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-452"><a href="#cb114-452" aria-hidden="true" tabindex="-1"></a>  reversed <span class="ot">&lt;-</span> <span class="fu">map</span>(</span>
<span id="cb114-453"><a href="#cb114-453" aria-hidden="true" tabindex="-1"></a>    original, </span>
<span id="cb114-454"><a href="#cb114-454" aria-hidden="true" tabindex="-1"></a>    \(x) <span class="fu">paste0</span>(</span>
<span id="cb114-455"><a href="#cb114-455" aria-hidden="true" tabindex="-1"></a>      <span class="fu">take_at</span>(x, <span class="dv">5</span>), </span>
<span id="cb114-456"><a href="#cb114-456" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sf_remove</span>(x, <span class="st">"[A-Z]$"</span>)</span>
<span id="cb114-457"><a href="#cb114-457" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb114-458"><a href="#cb114-458" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb114-459"><a href="#cb114-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-460"><a href="#cb114-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map2</span>(reversed, original, <span class="cf">function</span>(x, y) {</span>
<span id="cb114-461"><a href="#cb114-461" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb114-462"><a href="#cb114-462" aria-hidden="true" tabindex="-1"></a>    idx <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb114-463"><a href="#cb114-463" aria-hidden="true" tabindex="-1"></a>      <span class="at">orig =</span> y,</span>
<span id="cb114-464"><a href="#cb114-464" aria-hidden="true" tabindex="-1"></a>      <span class="at">code =</span> x,</span>
<span id="cb114-465"><a href="#cb114-465" aria-hidden="true" tabindex="-1"></a>      <span class="at">grp1 =</span> <span class="fu">sf_sub</span>(x, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb114-466"><a href="#cb114-466" aria-hidden="true" tabindex="-1"></a>      <span class="at">grp2 =</span> <span class="fu">sf_sub</span>(x, <span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb114-467"><a href="#cb114-467" aria-hidden="true" tabindex="-1"></a>      <span class="at">grp3 =</span> <span class="fu">sf_sub</span>(x, <span class="dv">1</span>, <span class="dv">4</span>),</span>
<span id="cb114-468"><a href="#cb114-468" aria-hidden="true" tabindex="-1"></a>      <span class="at">a1 =</span> <span class="fu">take_at</span>(x),</span>
<span id="cb114-469"><a href="#cb114-469" aria-hidden="true" tabindex="-1"></a>      <span class="at">a2 =</span> <span class="fu">take_at</span>(x, <span class="dv">2</span>),</span>
<span id="cb114-470"><a href="#cb114-470" aria-hidden="true" tabindex="-1"></a>      <span class="at">a3 =</span> <span class="fu">take_at</span>(x, <span class="dv">3</span>),</span>
<span id="cb114-471"><a href="#cb114-471" aria-hidden="true" tabindex="-1"></a>      <span class="at">a4 =</span> <span class="fu">take_at</span>(x, <span class="dv">4</span>),</span>
<span id="cb114-472"><a href="#cb114-472" aria-hidden="true" tabindex="-1"></a>      <span class="at">a5 =</span> <span class="fu">take_at</span>(x, <span class="dv">5</span>),</span>
<span id="cb114-473"><a href="#cb114-473" aria-hidden="true" tabindex="-1"></a>      <span class="at">i1 =</span> <span class="fu">groupid</span>(<span class="fu">take_at</span>(x))) <span class="sc">|&gt;</span></span>
<span id="cb114-474"><a href="#cb114-474" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fgroup_by</span>(a1) <span class="sc">|&gt;</span> </span>
<span id="cb114-475"><a href="#cb114-475" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fmutate</span>(<span class="at">i2 =</span> <span class="fu">groupid</span>(a2)) <span class="sc">|&gt;</span></span>
<span id="cb114-476"><a href="#cb114-476" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fgroup_by</span>(a1, a2) <span class="sc">|&gt;</span> </span>
<span id="cb114-477"><a href="#cb114-477" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fmutate</span>(<span class="at">i3 =</span> <span class="fu">groupid</span>(a3)) <span class="sc">|&gt;</span></span>
<span id="cb114-478"><a href="#cb114-478" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fgroup_by</span>(a1, a2, a3) <span class="sc">|&gt;</span> </span>
<span id="cb114-479"><a href="#cb114-479" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fmutate</span>(<span class="at">i4 =</span> <span class="fu">groupid</span>(a4)) <span class="sc">|&gt;</span></span>
<span id="cb114-480"><a href="#cb114-480" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fgroup_by</span>(a1, a2, a3, a4) <span class="sc">|&gt;</span> </span>
<span id="cb114-481"><a href="#cb114-481" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fmutate</span>(<span class="at">i5 =</span> <span class="fu">groupid</span>(a5)) <span class="sc">|&gt;</span> </span>
<span id="cb114-482"><a href="#cb114-482" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fungroup</span>()</span>
<span id="cb114-483"><a href="#cb114-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-484"><a href="#cb114-484" aria-hidden="true" tabindex="-1"></a>      lone <span class="ot">&lt;-</span> <span class="fu">fcount</span>(idx, i1, <span class="at">add =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb114-485"><a href="#cb114-485" aria-hidden="true" tabindex="-1"></a>        <span class="fu">fsubset</span>((i2 <span class="sc">+</span> i3 <span class="sc">+</span> i4 <span class="sc">+</span> i5 <span class="sc">+</span> N) <span class="sc">==</span> <span class="dv">5</span>)</span>
<span id="cb114-486"><a href="#cb114-486" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb114-487"><a href="#cb114-487" aria-hidden="true" tabindex="-1"></a>      last <span class="ot">&lt;-</span> <span class="fu">fsubset</span>(idx, code <span class="sc">%!in%</span> lone[[<span class="st">"code"</span>]])</span>
<span id="cb114-488"><a href="#cb114-488" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb114-489"><a href="#cb114-489" aria-hidden="true" tabindex="-1"></a>      last <span class="ot">&lt;-</span> <span class="fu">join</span>(</span>
<span id="cb114-490"><a href="#cb114-490" aria-hidden="true" tabindex="-1"></a>        <span class="fu">fcount</span>(last, grp2, a4),</span>
<span id="cb114-491"><a href="#cb114-491" aria-hidden="true" tabindex="-1"></a>        <span class="fu">fcount</span>(last, grp2, <span class="at">name =</span> <span class="st">"G"</span>), <span class="at">on =</span> <span class="st">"grp2"</span>, <span class="at">verbose =</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb114-492"><a href="#cb114-492" aria-hidden="true" tabindex="-1"></a>        <span class="fu">fsubset</span>(N <span class="sc">==</span> G) <span class="sc">|&gt;</span></span>
<span id="cb114-493"><a href="#cb114-493" aria-hidden="true" tabindex="-1"></a>        <span class="fu">join</span>(last, <span class="at">on =</span> <span class="fu">c</span>(<span class="st">"grp2"</span>, <span class="st">"a4"</span>), <span class="at">how =</span> <span class="st">"right"</span>, <span class="at">verbose =</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb114-494"><a href="#cb114-494" aria-hidden="true" tabindex="-1"></a>        <span class="fu">fsubset</span>(<span class="fu">not_na</span>(N))</span>
<span id="cb114-495"><a href="#cb114-495" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb114-496"><a href="#cb114-496" aria-hidden="true" tabindex="-1"></a>      rest <span class="ot">&lt;-</span> <span class="fu">fsubset</span>(idx, code <span class="sc">%!in%</span> <span class="fu">c</span>(lone[[<span class="st">"code"</span>]], last[[<span class="st">"code"</span>]]))</span>
<span id="cb114-497"><a href="#cb114-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-498"><a href="#cb114-498" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb114-499"><a href="#cb114-499" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">empty</span>(lone))</span>
<span id="cb114-500"><a href="#cb114-500" aria-hidden="true" tabindex="-1"></a>        <span class="cn">NULL</span></span>
<span id="cb114-501"><a href="#cb114-501" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span></span>
<span id="cb114-502"><a href="#cb114-502" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(lone[[<span class="st">"orig"</span>]]),</span>
<span id="cb114-503"><a href="#cb114-503" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">empty</span>(last))</span>
<span id="cb114-504"><a href="#cb114-504" aria-hidden="true" tabindex="-1"></a>        <span class="cn">NULL</span></span>
<span id="cb114-505"><a href="#cb114-505" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span></span>
<span id="cb114-506"><a href="#cb114-506" aria-hidden="true" tabindex="-1"></a>        <span class="fu">gchop</span>(last[[<span class="st">"orig"</span>]], last[[<span class="st">"grp1"</span>]]),</span>
<span id="cb114-507"><a href="#cb114-507" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">empty</span>(rest))</span>
<span id="cb114-508"><a href="#cb114-508" aria-hidden="true" tabindex="-1"></a>        <span class="cn">NULL</span></span>
<span id="cb114-509"><a href="#cb114-509" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span></span>
<span id="cb114-510"><a href="#cb114-510" aria-hidden="true" tabindex="-1"></a>        <span class="fu">gchop</span>(rest[[<span class="st">"orig"</span>]], rest[[<span class="st">"grp2"</span>]])</span>
<span id="cb114-511"><a href="#cb114-511" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb114-512"><a href="#cb114-512" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb114-513"><a href="#cb114-513" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-514"><a href="#cb114-514" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-515"><a href="#cb114-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-516"><a href="#cb114-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-519"><a href="#cb114-519" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-520"><a href="#cb114-520" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: group_5</span></span>
<span id="cb114-521"><a href="#cb114-521" aria-hidden="true" tabindex="-1"></a>group_5 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb114-522"><a href="#cb114-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-523"><a href="#cb114-523" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">getelem</span>(x, <span class="st">"x5"</span>)</span>
<span id="cb114-524"><a href="#cb114-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-525"><a href="#cb114-525" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">empty</span>(x)) <span class="fu">return</span>(x)</span>
<span id="cb114-526"><a href="#cb114-526" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-527"><a href="#cb114-527" aria-hidden="true" tabindex="-1"></a>  chr <span class="ot">&lt;-</span> <span class="fu">map</span>(x, \(x) <span class="fu">sf_extract</span>(x, <span class="st">"[A-Z]$"</span>)) <span class="sc">|&gt;</span> <span class="fu">compact</span>()</span>
<span id="cb114-528"><a href="#cb114-528" aria-hidden="true" tabindex="-1"></a>  num <span class="ot">&lt;-</span> <span class="fu">map</span>(x, \(x) <span class="fu">sf_extract</span>(x, <span class="st">"[0-9]$"</span>)) <span class="sc">|&gt;</span> <span class="fu">compact</span>()</span>
<span id="cb114-529"><a href="#cb114-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-530"><a href="#cb114-530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb114-531"><a href="#cb114-531" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">empty</span>(chr)) <span class="cn">NULL</span> <span class="cf">else</span> <span class="fu">group_5_chr</span>(chr),</span>
<span id="cb114-532"><a href="#cb114-532" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">empty</span>(num)) <span class="cn">NULL</span> <span class="cf">else</span> <span class="fu">group_5_num</span>(num)</span>
<span id="cb114-533"><a href="#cb114-533" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb114-534"><a href="#cb114-534" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-535"><a href="#cb114-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-536"><a href="#cb114-536" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">"C7510"</span>, <span class="st">"C9701"</span>, <span class="st">"G0200"</span>, <span class="st">"G0400"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb114-537"><a href="#cb114-537" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-538"><a href="#cb114-538" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-539"><a href="#cb114-539" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-540"><a href="#cb114-540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_5</span>()</span>
<span id="cb114-541"><a href="#cb114-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-542"><a href="#cb114-542" aria-hidden="true" tabindex="-1"></a>long_test2[<span class="fu">nchar</span>(long_test2) <span class="sc">==</span> <span class="dv">5</span>] <span class="sc">|&gt;</span> </span>
<span id="cb114-543"><a href="#cb114-543" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-544"><a href="#cb114-544" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-545"><a href="#cb114-545" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-546"><a href="#cb114-546" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_5</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-547"><a href="#cb114-547" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nametree</span>()</span>
<span id="cb114-548"><a href="#cb114-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-549"><a href="#cb114-549" aria-hidden="true" tabindex="-1"></a><span class="fu">random_hcpcs</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-550"><a href="#cb114-550" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-551"><a href="#cb114-551" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-552"><a href="#cb114-552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-553"><a href="#cb114-553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_5</span>()</span>
<span id="cb114-554"><a href="#cb114-554" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-555"><a href="#cb114-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-556"><a href="#cb114-556" aria-hidden="true" tabindex="-1"></a><span class="fu">## process_groups</span></span>
<span id="cb114-557"><a href="#cb114-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-560"><a href="#cb114-560" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-561"><a href="#cb114-561" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: process_groups</span></span>
<span id="cb114-562"><a href="#cb114-562" aria-hidden="true" tabindex="-1"></a>process_groups <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb114-563"><a href="#cb114-563" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-564"><a href="#cb114-564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb114-565"><a href="#cb114-565" aria-hidden="true" tabindex="-1"></a>    <span class="at">g1 =</span> x<span class="sc">$</span>x1,</span>
<span id="cb114-566"><a href="#cb114-566" aria-hidden="true" tabindex="-1"></a>    <span class="at">g2 =</span> x<span class="sc">$</span>x2,</span>
<span id="cb114-567"><a href="#cb114-567" aria-hidden="true" tabindex="-1"></a>    <span class="at">g3 =</span> <span class="fu">group_3</span>(x),</span>
<span id="cb114-568"><a href="#cb114-568" aria-hidden="true" tabindex="-1"></a>    <span class="at">g4 =</span> <span class="fu">group_4</span>(x),</span>
<span id="cb114-569"><a href="#cb114-569" aria-hidden="true" tabindex="-1"></a>    <span class="at">g5 =</span> <span class="fu">group_5</span>(x))</span>
<span id="cb114-570"><a href="#cb114-570" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-571"><a href="#cb114-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-572"><a href="#cb114-572" aria-hidden="true" tabindex="-1"></a>hcpcs_tests <span class="sc">|&gt;</span></span>
<span id="cb114-573"><a href="#cb114-573" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-574"><a href="#cb114-574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-575"><a href="#cb114-575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-576"><a href="#cb114-576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_groups</span>()</span>
<span id="cb114-577"><a href="#cb114-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-578"><a href="#cb114-578" aria-hidden="true" tabindex="-1"></a>long_test2 <span class="sc">|&gt;</span> </span>
<span id="cb114-579"><a href="#cb114-579" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-580"><a href="#cb114-580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-581"><a href="#cb114-581" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-582"><a href="#cb114-582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_groups</span>()</span>
<span id="cb114-583"><a href="#cb114-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-584"><a href="#cb114-584" aria-hidden="true" tabindex="-1"></a><span class="fu">random_hcpcs</span>(<span class="dv">50</span>) <span class="sc">|&gt;</span> </span>
<span id="cb114-585"><a href="#cb114-585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-586"><a href="#cb114-586" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-587"><a href="#cb114-587" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-588"><a href="#cb114-588" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_groups</span>()</span>
<span id="cb114-589"><a href="#cb114-589" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-590"><a href="#cb114-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-591"><a href="#cb114-591" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb114-592"><a href="#cb114-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-593"><a href="#cb114-593" aria-hidden="true" tabindex="-1"></a>&lt;hr&gt;</span>
<span id="cb114-594"><a href="#cb114-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-595"><a href="#cb114-595" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb114-596"><a href="#cb114-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-597"><a href="#cb114-597" aria-hidden="true" tabindex="-1"></a><span class="fu"># Reduce Groups</span></span>
<span id="cb114-598"><a href="#cb114-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-599"><a href="#cb114-599" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb114-600"><a href="#cb114-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-601"><a href="#cb114-601" aria-hidden="true" tabindex="-1"></a><span class="fu">## reduce_runs</span></span>
<span id="cb114-602"><a href="#cb114-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-605"><a href="#cb114-605" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-606"><a href="#cb114-606" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: reduce_runs</span></span>
<span id="cb114-607"><a href="#cb114-607" aria-hidden="true" tabindex="-1"></a>reduce_runs <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb114-608"><a href="#cb114-608" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-609"><a href="#cb114-609" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sf_nchar</span>(x) <span class="sc">==</span> <span class="dv">1</span>) </span>
<span id="cb114-610"><a href="#cb114-610" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb114-611"><a href="#cb114-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-612"><a href="#cb114-612" aria-hidden="true" tabindex="-1"></a>  test <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">37</span>), <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>, <span class="st">"&amp;"</span>, LETTERS))</span>
<span id="cb114-613"><a href="#cb114-613" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-614"><a href="#cb114-614" aria-hidden="true" tabindex="-1"></a>  vec <span class="ot">&lt;-</span> test[<span class="fu">c</span>(<span class="fu">desplit</span>(x), <span class="st">"&amp;"</span>)]</span>
<span id="cb114-615"><a href="#cb114-615" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-616"><a href="#cb114-616" aria-hidden="true" tabindex="-1"></a>  vec <span class="ot">&lt;-</span> vec[<span class="fu">not_na</span>(vec)]</span>
<span id="cb114-617"><a href="#cb114-617" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-618"><a href="#cb114-618" aria-hidden="true" tabindex="-1"></a>  test[<span class="fu">names</span>(vec)] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb114-619"><a href="#cb114-619" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-620"><a href="#cb114-620" aria-hidden="true" tabindex="-1"></a>  test[<span class="fu">names</span>(test) <span class="sc">==</span> <span class="st">"&amp;"</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb114-621"><a href="#cb114-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-622"><a href="#cb114-622" aria-hidden="true" tabindex="-1"></a>  groups <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb114-623"><a href="#cb114-623" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">names</span>(test),</span>
<span id="cb114-624"><a href="#cb114-624" aria-hidden="true" tabindex="-1"></a>    <span class="at">keys =</span> test,</span>
<span id="cb114-625"><a href="#cb114-625" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">groupid</span>(test)) <span class="sc">|&gt;</span></span>
<span id="cb114-626"><a href="#cb114-626" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fgroup_by</span>(group)</span>
<span id="cb114-627"><a href="#cb114-627" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-628"><a href="#cb114-628" aria-hidden="true" tabindex="-1"></a>  groups <span class="ot">&lt;-</span> <span class="fu">join</span>(</span>
<span id="cb114-629"><a href="#cb114-629" aria-hidden="true" tabindex="-1"></a>    groups, </span>
<span id="cb114-630"><a href="#cb114-630" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fcount</span>(groups, group), </span>
<span id="cb114-631"><a href="#cb114-631" aria-hidden="true" tabindex="-1"></a>    <span class="at">on =</span> <span class="st">"group"</span>, </span>
<span id="cb114-632"><a href="#cb114-632" aria-hidden="true" tabindex="-1"></a>    <span class="at">verbose =</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb114-633"><a href="#cb114-633" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-634"><a href="#cb114-634" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fsubset</span>(keys <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb114-635"><a href="#cb114-635" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fsubset</span>(N <span class="sc">&gt;=</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb114-636"><a href="#cb114-636" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fselect</span>(value, group)</span>
<span id="cb114-637"><a href="#cb114-637" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb114-638"><a href="#cb114-638" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">empty</span>(groups)) </span>
<span id="cb114-639"><a href="#cb114-639" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb114-640"><a href="#cb114-640" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-641"><a href="#cb114-641" aria-hidden="true" tabindex="-1"></a>  xgroups <span class="ot">&lt;-</span> <span class="fu">gchop</span>(</span>
<span id="cb114-642"><a href="#cb114-642" aria-hidden="true" tabindex="-1"></a>    groups<span class="sc">$</span>value, </span>
<span id="cb114-643"><a href="#cb114-643" aria-hidden="true" tabindex="-1"></a>    groups<span class="sc">$</span>group) <span class="sc">|&gt;</span></span>
<span id="cb114-644"><a href="#cb114-644" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(smush) <span class="sc">|&gt;</span></span>
<span id="cb114-645"><a href="#cb114-645" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list_c</span>()</span>
<span id="cb114-646"><a href="#cb114-646" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-647"><a href="#cb114-647" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">all</span>(xgroups <span class="sc">==</span> <span class="fu">smush</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>, <span class="st">"&amp;"</span>, LETTERS)))) <span class="fu">return</span>(<span class="st">"[A-Z0-9]"</span>)</span>
<span id="cb114-648"><a href="#cb114-648" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-649"><a href="#cb114-649" aria-hidden="true" tabindex="-1"></a>  replacements <span class="ot">&lt;-</span> <span class="fu">join</span>(</span>
<span id="cb114-650"><a href="#cb114-650" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">slice_min</span>(groups, <span class="at">by =</span> group, <span class="at">order_by =</span> value) <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">start =</span> value),</span>
<span id="cb114-651"><a href="#cb114-651" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">slice_max</span>(groups, <span class="at">by =</span> group, <span class="at">order_by =</span> value) <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">end =</span> value),</span>
<span id="cb114-652"><a href="#cb114-652" aria-hidden="true" tabindex="-1"></a>    <span class="at">on =</span> <span class="st">"group"</span>, <span class="at">verbose =</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb114-653"><a href="#cb114-653" aria-hidden="true" tabindex="-1"></a>    stringr<span class="sc">::</span><span class="fu">str_glue_data</span>(<span class="st">"{start}-{end}"</span>) <span class="sc">|&gt;</span></span>
<span id="cb114-654"><a href="#cb114-654" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.vector</span>()</span>
<span id="cb114-655"><a href="#cb114-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-656"><a href="#cb114-656" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bracket</span>(<span class="fu">replace_regex</span>(x, xgroups, replacements))</span>
<span id="cb114-657"><a href="#cb114-657" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-658"><a href="#cb114-658" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-659"><a href="#cb114-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-660"><a href="#cb114-660" aria-hidden="true" tabindex="-1"></a><span class="fu">## red1</span></span>
<span id="cb114-661"><a href="#cb114-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-664"><a href="#cb114-664" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-665"><a href="#cb114-665" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: red1</span></span>
<span id="cb114-666"><a href="#cb114-666" aria-hidden="true" tabindex="-1"></a>red1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb114-667"><a href="#cb114-667" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-668"><a href="#cb114-668" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">getelem</span>(x, <span class="st">"g1"</span>)</span>
<span id="cb114-669"><a href="#cb114-669" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-670"><a href="#cb114-670" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">empty</span>(x)) </span>
<span id="cb114-671"><a href="#cb114-671" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">character</span>(<span class="dv">0</span>))</span>
<span id="cb114-672"><a href="#cb114-672" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-673"><a href="#cb114-673" aria-hidden="true" tabindex="-1"></a>  re <span class="ot">&lt;-</span> <span class="fu">sort_order</span>(x) <span class="sc">|&gt;</span> </span>
<span id="cb114-674"><a href="#cb114-674" aria-hidden="true" tabindex="-1"></a>    <span class="fu">reduce_runs</span>()</span>
<span id="cb114-675"><a href="#cb114-675" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-676"><a href="#cb114-676" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (re <span class="sc">==</span> <span class="st">"[A-Z0-9]"</span>) </span>
<span id="cb114-677"><a href="#cb114-677" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">str_glue</span>(<span class="st">"^{re}{{5}}"</span>))</span>
<span id="cb114-678"><a href="#cb114-678" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-679"><a href="#cb114-679" aria-hidden="true" tabindex="-1"></a>  post <span class="ot">&lt;-</span> <span class="fu">iif_else</span>(</span>
<span id="cb114-680"><a href="#cb114-680" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sf_detect</span>(</span>
<span id="cb114-681"><a href="#cb114-681" aria-hidden="true" tabindex="-1"></a>      re, </span>
<span id="cb114-682"><a href="#cb114-682" aria-hidden="true" tabindex="-1"></a>      <span class="st">"</span><span class="sc">\\</span><span class="st">[?[0-9]{1}"</span>), </span>
<span id="cb114-683"><a href="#cb114-683" aria-hidden="true" tabindex="-1"></a>    <span class="st">"[A-Z0-9]"</span>, </span>
<span id="cb114-684"><a href="#cb114-684" aria-hidden="true" tabindex="-1"></a>    <span class="st">"[0-9]"</span>)</span>
<span id="cb114-685"><a href="#cb114-685" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-686"><a href="#cb114-686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_glue</span>(<span class="st">"^{re}{post}{{4}}"</span>)</span>
<span id="cb114-687"><a href="#cb114-687" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-688"><a href="#cb114-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-689"><a href="#cb114-689" aria-hidden="true" tabindex="-1"></a>long_test2 <span class="sc">|&gt;</span></span>
<span id="cb114-690"><a href="#cb114-690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-691"><a href="#cb114-691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-692"><a href="#cb114-692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-693"><a href="#cb114-693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_groups</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-694"><a href="#cb114-694" aria-hidden="true" tabindex="-1"></a>  <span class="fu">red1</span>()</span>
<span id="cb114-695"><a href="#cb114-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-696"><a href="#cb114-696" aria-hidden="true" tabindex="-1"></a>hcpcs_tests <span class="sc">|&gt;</span> </span>
<span id="cb114-697"><a href="#cb114-697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-698"><a href="#cb114-698" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-699"><a href="#cb114-699" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-700"><a href="#cb114-700" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_groups</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-701"><a href="#cb114-701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">red1</span>()</span>
<span id="cb114-702"><a href="#cb114-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-703"><a href="#cb114-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-704"><a href="#cb114-704" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>) <span class="sc">|&gt;</span> </span>
<span id="cb114-705"><a href="#cb114-705" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-706"><a href="#cb114-706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-707"><a href="#cb114-707" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-708"><a href="#cb114-708" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_groups</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-709"><a href="#cb114-709" aria-hidden="true" tabindex="-1"></a>  <span class="fu">red1</span>()</span>
<span id="cb114-710"><a href="#cb114-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-711"><a href="#cb114-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-712"><a href="#cb114-712" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="at">g1 =</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>, LETTERS)) <span class="sc">|&gt;</span> </span>
<span id="cb114-713"><a href="#cb114-713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">red1</span>()</span>
<span id="cb114-714"><a href="#cb114-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-715"><a href="#cb114-715" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="at">g1 =</span> <span class="fu">c</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb114-716"><a href="#cb114-716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">red1</span>()</span>
<span id="cb114-717"><a href="#cb114-717" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-718"><a href="#cb114-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-719"><a href="#cb114-719" aria-hidden="true" tabindex="-1"></a><span class="fu">## red2</span></span>
<span id="cb114-720"><a href="#cb114-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-723"><a href="#cb114-723" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-724"><a href="#cb114-724" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: red2</span></span>
<span id="cb114-725"><a href="#cb114-725" aria-hidden="true" tabindex="-1"></a>red2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb114-726"><a href="#cb114-726" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-727"><a href="#cb114-727" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">getelem</span>(x, <span class="st">"g2"</span>)</span>
<span id="cb114-728"><a href="#cb114-728" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-729"><a href="#cb114-729" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">empty</span>(x)) </span>
<span id="cb114-730"><a href="#cb114-730" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">character</span>(<span class="dv">0</span>))</span>
<span id="cb114-731"><a href="#cb114-731" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-732"><a href="#cb114-732" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modify_if</span>(x, len_gt_one, <span class="cf">function</span>(x) {</span>
<span id="cb114-733"><a href="#cb114-733" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb114-734"><a href="#cb114-734" aria-hidden="true" tabindex="-1"></a>    parts <span class="ot">&lt;-</span> <span class="fu">split_max_vlen</span>(x) <span class="sc">|&gt;</span> </span>
<span id="cb114-735"><a href="#cb114-735" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-736"><a href="#cb114-736" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(uniq_narm) <span class="sc">|&gt;</span></span>
<span id="cb114-737"><a href="#cb114-737" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(sort_order) <span class="sc">|&gt;</span></span>
<span id="cb114-738"><a href="#cb114-738" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(reduce_runs) <span class="sc">|&gt;</span></span>
<span id="cb114-739"><a href="#cb114-739" aria-hidden="true" tabindex="-1"></a>    <span class="fu">delist</span>()</span>
<span id="cb114-740"><a href="#cb114-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-741"><a href="#cb114-741" aria-hidden="true" tabindex="-1"></a>  multi <span class="ot">&lt;-</span> <span class="fu">sf_nchar</span>(parts) <span class="sc">&gt;</span> <span class="dv">1</span></span>
<span id="cb114-742"><a href="#cb114-742" aria-hidden="true" tabindex="-1"></a>  nobrk <span class="ot">&lt;-</span> <span class="fu">sf_ndetect</span>(parts, <span class="st">"</span><span class="sc">\\</span><span class="st">[|</span><span class="sc">\\</span><span class="st">]"</span>)</span>
<span id="cb114-743"><a href="#cb114-743" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-744"><a href="#cb114-744" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(multi[nobrk])) parts[multi[nobrk]] <span class="ot">&lt;-</span> <span class="fu">map_chr</span>(parts[multi[nobrk]], bracket)</span>
<span id="cb114-745"><a href="#cb114-745" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-746"><a href="#cb114-746" aria-hidden="true" tabindex="-1"></a>  <span class="fu">smush</span>(parts)</span>
<span id="cb114-747"><a href="#cb114-747" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-748"><a href="#cb114-748" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb114-749"><a href="#cb114-749" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-750"><a href="#cb114-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-751"><a href="#cb114-751" aria-hidden="true" tabindex="-1"></a>long_test2[<span class="fu">sf_nchar</span>(long_test2) <span class="sc">==</span> <span class="dv">2</span>] <span class="sc">|&gt;</span></span>
<span id="cb114-752"><a href="#cb114-752" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-753"><a href="#cb114-753" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-754"><a href="#cb114-754" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-755"><a href="#cb114-755" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_groups</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-756"><a href="#cb114-756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">red2</span>()</span>
<span id="cb114-757"><a href="#cb114-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-758"><a href="#cb114-758" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"A"</span>, <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>, LETTERS)) <span class="sc">|&gt;</span> </span>
<span id="cb114-759"><a href="#cb114-759" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-760"><a href="#cb114-760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-761"><a href="#cb114-761" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-762"><a href="#cb114-762" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_groups</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-763"><a href="#cb114-763" aria-hidden="true" tabindex="-1"></a>  <span class="fu">red2</span>()</span>
<span id="cb114-764"><a href="#cb114-764" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-765"><a href="#cb114-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-766"><a href="#cb114-766" aria-hidden="true" tabindex="-1"></a><span class="fu">## red3</span></span>
<span id="cb114-767"><a href="#cb114-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-770"><a href="#cb114-770" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-771"><a href="#cb114-771" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: red3</span></span>
<span id="cb114-772"><a href="#cb114-772" aria-hidden="true" tabindex="-1"></a>red3 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb114-773"><a href="#cb114-773" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-774"><a href="#cb114-774" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">getelem</span>(x, <span class="st">"g3"</span>)</span>
<span id="cb114-775"><a href="#cb114-775" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-776"><a href="#cb114-776" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">empty</span>(x)) <span class="fu">return</span>(<span class="fu">character</span>(<span class="dv">0</span>))</span>
<span id="cb114-777"><a href="#cb114-777" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-778"><a href="#cb114-778" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(x, <span class="cf">function</span>(x) {</span>
<span id="cb114-779"><a href="#cb114-779" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb114-780"><a href="#cb114-780" aria-hidden="true" tabindex="-1"></a>    <span class="fu">modify_if</span>(x, len_gt_one, <span class="cf">function</span>(x) {</span>
<span id="cb114-781"><a href="#cb114-781" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb114-782"><a href="#cb114-782" aria-hidden="true" tabindex="-1"></a>      parts <span class="ot">&lt;-</span> <span class="fu">split_max_vlen</span>(x) <span class="sc">|&gt;</span> </span>
<span id="cb114-783"><a href="#cb114-783" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-784"><a href="#cb114-784" aria-hidden="true" tabindex="-1"></a>        <span class="fu">map</span>(uniq_narm) <span class="sc">|&gt;</span> </span>
<span id="cb114-785"><a href="#cb114-785" aria-hidden="true" tabindex="-1"></a>        <span class="fu">map</span>(sort_order) <span class="sc">|&gt;</span></span>
<span id="cb114-786"><a href="#cb114-786" aria-hidden="true" tabindex="-1"></a>        <span class="fu">map</span>(reduce_runs) <span class="sc">|&gt;</span> </span>
<span id="cb114-787"><a href="#cb114-787" aria-hidden="true" tabindex="-1"></a>        <span class="fu">delist</span>()</span>
<span id="cb114-788"><a href="#cb114-788" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb114-789"><a href="#cb114-789" aria-hidden="true" tabindex="-1"></a>      multi <span class="ot">&lt;-</span> <span class="fu">sf_nchar</span>(parts) <span class="sc">&gt;</span> <span class="dv">1</span></span>
<span id="cb114-790"><a href="#cb114-790" aria-hidden="true" tabindex="-1"></a>      nobrk <span class="ot">&lt;-</span> <span class="fu">sf_ndetect</span>(parts, <span class="st">"</span><span class="sc">\\</span><span class="st">[|</span><span class="sc">\\</span><span class="st">]"</span>)</span>
<span id="cb114-791"><a href="#cb114-791" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb114-792"><a href="#cb114-792" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">any</span>(multi[nobrk])) parts[multi[nobrk]] <span class="ot">&lt;-</span> <span class="fu">map_chr</span>(parts[multi[nobrk]], bracket)</span>
<span id="cb114-793"><a href="#cb114-793" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb114-794"><a href="#cb114-794" aria-hidden="true" tabindex="-1"></a>      <span class="fu">smush</span>(parts)</span>
<span id="cb114-795"><a href="#cb114-795" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb114-796"><a href="#cb114-796" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb114-797"><a href="#cb114-797" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-798"><a href="#cb114-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-799"><a href="#cb114-799" aria-hidden="true" tabindex="-1"></a>long_test2[<span class="fu">sf_nchar</span>(long_test2) <span class="sc">==</span> <span class="dv">3</span>] <span class="sc">|&gt;</span></span>
<span id="cb114-800"><a href="#cb114-800" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-801"><a href="#cb114-801" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-802"><a href="#cb114-802" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-803"><a href="#cb114-803" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_groups</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-804"><a href="#cb114-804" aria-hidden="true" tabindex="-1"></a>  <span class="fu">red3</span>()</span>
<span id="cb114-805"><a href="#cb114-805" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-806"><a href="#cb114-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-807"><a href="#cb114-807" aria-hidden="true" tabindex="-1"></a><span class="fu">## red4</span></span>
<span id="cb114-808"><a href="#cb114-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-811"><a href="#cb114-811" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-812"><a href="#cb114-812" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: red4</span></span>
<span id="cb114-813"><a href="#cb114-813" aria-hidden="true" tabindex="-1"></a>red4 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb114-814"><a href="#cb114-814" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-815"><a href="#cb114-815" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">getelem</span>(x, <span class="st">"g4"</span>)</span>
<span id="cb114-816"><a href="#cb114-816" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-817"><a href="#cb114-817" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">empty</span>(x)) <span class="fu">return</span>(<span class="fu">character</span>(<span class="dv">0</span>))</span>
<span id="cb114-818"><a href="#cb114-818" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-819"><a href="#cb114-819" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(x, <span class="cf">function</span>(x) {</span>
<span id="cb114-820"><a href="#cb114-820" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb114-821"><a href="#cb114-821" aria-hidden="true" tabindex="-1"></a>    <span class="fu">modify_if</span>(x, len_gt_one, <span class="cf">function</span>(x) {</span>
<span id="cb114-822"><a href="#cb114-822" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb114-823"><a href="#cb114-823" aria-hidden="true" tabindex="-1"></a>      parts <span class="ot">&lt;-</span> <span class="fu">split_max_vlen</span>(x) <span class="sc">|&gt;</span> </span>
<span id="cb114-824"><a href="#cb114-824" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-825"><a href="#cb114-825" aria-hidden="true" tabindex="-1"></a>        <span class="fu">map</span>(uniq_narm) <span class="sc">|&gt;</span> </span>
<span id="cb114-826"><a href="#cb114-826" aria-hidden="true" tabindex="-1"></a>        <span class="fu">map</span>(sort_order) <span class="sc">|&gt;</span></span>
<span id="cb114-827"><a href="#cb114-827" aria-hidden="true" tabindex="-1"></a>        <span class="fu">map</span>(reduce_runs) <span class="sc">|&gt;</span> </span>
<span id="cb114-828"><a href="#cb114-828" aria-hidden="true" tabindex="-1"></a>        <span class="fu">delist</span>()</span>
<span id="cb114-829"><a href="#cb114-829" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb114-830"><a href="#cb114-830" aria-hidden="true" tabindex="-1"></a>      multi <span class="ot">&lt;-</span> <span class="fu">sf_nchar</span>(parts) <span class="sc">&gt;</span> <span class="dv">1</span></span>
<span id="cb114-831"><a href="#cb114-831" aria-hidden="true" tabindex="-1"></a>      nobrk <span class="ot">&lt;-</span> <span class="fu">sf_ndetect</span>(parts, <span class="st">"</span><span class="sc">\\</span><span class="st">[|</span><span class="sc">\\</span><span class="st">]"</span>)</span>
<span id="cb114-832"><a href="#cb114-832" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb114-833"><a href="#cb114-833" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">any</span>(multi[nobrk])) parts[multi[nobrk]] <span class="ot">&lt;-</span> <span class="fu">map_chr</span>(parts[multi[nobrk]], bracket)</span>
<span id="cb114-834"><a href="#cb114-834" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb114-835"><a href="#cb114-835" aria-hidden="true" tabindex="-1"></a>      <span class="fu">smush</span>(parts)</span>
<span id="cb114-836"><a href="#cb114-836" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb114-837"><a href="#cb114-837" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb114-838"><a href="#cb114-838" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb114-839"><a href="#cb114-839" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-840"><a href="#cb114-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-841"><a href="#cb114-841" aria-hidden="true" tabindex="-1"></a>long_test2[<span class="fu">sf_nchar</span>(long_test2) <span class="sc">==</span> <span class="dv">4</span>] <span class="sc">|&gt;</span></span>
<span id="cb114-842"><a href="#cb114-842" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-843"><a href="#cb114-843" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-844"><a href="#cb114-844" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-845"><a href="#cb114-845" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_groups</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-846"><a href="#cb114-846" aria-hidden="true" tabindex="-1"></a>  <span class="fu">red4</span>()</span>
<span id="cb114-847"><a href="#cb114-847" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-848"><a href="#cb114-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-849"><a href="#cb114-849" aria-hidden="true" tabindex="-1"></a><span class="fu">## red5</span></span>
<span id="cb114-850"><a href="#cb114-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-853"><a href="#cb114-853" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-854"><a href="#cb114-854" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: red5</span></span>
<span id="cb114-855"><a href="#cb114-855" aria-hidden="true" tabindex="-1"></a>red5 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb114-856"><a href="#cb114-856" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-857"><a href="#cb114-857" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">getelem</span>(x, <span class="st">"g5"</span>)</span>
<span id="cb114-858"><a href="#cb114-858" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-859"><a href="#cb114-859" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">empty</span>(x)) <span class="fu">return</span>(<span class="fu">character</span>(<span class="dv">0</span>))</span>
<span id="cb114-860"><a href="#cb114-860" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-861"><a href="#cb114-861" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(x, <span class="cf">function</span>(x) {</span>
<span id="cb114-862"><a href="#cb114-862" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb114-863"><a href="#cb114-863" aria-hidden="true" tabindex="-1"></a>    <span class="fu">modify_if</span>(x, len_gt_one, <span class="cf">function</span>(x) {</span>
<span id="cb114-864"><a href="#cb114-864" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb114-865"><a href="#cb114-865" aria-hidden="true" tabindex="-1"></a>      parts <span class="ot">&lt;-</span> <span class="fu">split_max_vlen</span>(x) <span class="sc">|&gt;</span> </span>
<span id="cb114-866"><a href="#cb114-866" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-867"><a href="#cb114-867" aria-hidden="true" tabindex="-1"></a>        <span class="fu">map</span>(uniq_narm) <span class="sc">|&gt;</span> </span>
<span id="cb114-868"><a href="#cb114-868" aria-hidden="true" tabindex="-1"></a>        <span class="fu">map</span>(sort_order) <span class="sc">|&gt;</span></span>
<span id="cb114-869"><a href="#cb114-869" aria-hidden="true" tabindex="-1"></a>        <span class="fu">map</span>(reduce_runs) <span class="sc">|&gt;</span> </span>
<span id="cb114-870"><a href="#cb114-870" aria-hidden="true" tabindex="-1"></a>        <span class="fu">delist</span>()</span>
<span id="cb114-871"><a href="#cb114-871" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb114-872"><a href="#cb114-872" aria-hidden="true" tabindex="-1"></a>      multi <span class="ot">&lt;-</span> <span class="fu">sf_nchar</span>(parts) <span class="sc">&gt;</span> <span class="dv">1</span></span>
<span id="cb114-873"><a href="#cb114-873" aria-hidden="true" tabindex="-1"></a>      nobrk <span class="ot">&lt;-</span> <span class="fu">sf_ndetect</span>(parts, <span class="st">"</span><span class="sc">\\</span><span class="st">[|</span><span class="sc">\\</span><span class="st">]"</span>)</span>
<span id="cb114-874"><a href="#cb114-874" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb114-875"><a href="#cb114-875" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">any</span>(multi[nobrk])) parts[multi[nobrk]] <span class="ot">&lt;-</span> <span class="fu">map_chr</span>(parts[multi[nobrk]], bracket)</span>
<span id="cb114-876"><a href="#cb114-876" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb114-877"><a href="#cb114-877" aria-hidden="true" tabindex="-1"></a>      <span class="fu">smush</span>(parts)</span>
<span id="cb114-878"><a href="#cb114-878" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb114-879"><a href="#cb114-879" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb114-880"><a href="#cb114-880" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-881"><a href="#cb114-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-882"><a href="#cb114-882" aria-hidden="true" tabindex="-1"></a>long_test2[<span class="fu">sf_nchar</span>(long_test2) <span class="sc">==</span> <span class="dv">5</span>] <span class="sc">|&gt;</span></span>
<span id="cb114-883"><a href="#cb114-883" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-884"><a href="#cb114-884" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove_redundant() |&gt;</span></span>
<span id="cb114-885"><a href="#cb114-885" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-886"><a href="#cb114-886" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_groups</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-887"><a href="#cb114-887" aria-hidden="true" tabindex="-1"></a>  <span class="fu">red5</span>()</span>
<span id="cb114-888"><a href="#cb114-888" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-889"><a href="#cb114-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-890"><a href="#cb114-890" aria-hidden="true" tabindex="-1"></a><span class="fu">## reduce_groups</span></span>
<span id="cb114-891"><a href="#cb114-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-894"><a href="#cb114-894" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-895"><a href="#cb114-895" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: reduce_groups</span></span>
<span id="cb114-896"><a href="#cb114-896" aria-hidden="true" tabindex="-1"></a>reduce_groups <span class="ot">&lt;-</span> \(x) {</span>
<span id="cb114-897"><a href="#cb114-897" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-898"><a href="#cb114-898" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb114-899"><a href="#cb114-899" aria-hidden="true" tabindex="-1"></a>    <span class="at">g1 =</span> <span class="fu">red1</span>(x),</span>
<span id="cb114-900"><a href="#cb114-900" aria-hidden="true" tabindex="-1"></a>    <span class="at">g2 =</span> <span class="fu">red2</span>(x),</span>
<span id="cb114-901"><a href="#cb114-901" aria-hidden="true" tabindex="-1"></a>    <span class="at">g3 =</span> <span class="fu">red3</span>(x),</span>
<span id="cb114-902"><a href="#cb114-902" aria-hidden="true" tabindex="-1"></a>    <span class="at">g4 =</span> <span class="fu">red4</span>(x),</span>
<span id="cb114-903"><a href="#cb114-903" aria-hidden="true" tabindex="-1"></a>    <span class="at">g5 =</span> <span class="fu">red5</span>(x)</span>
<span id="cb114-904"><a href="#cb114-904" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb114-905"><a href="#cb114-905" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-906"><a href="#cb114-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-907"><a href="#cb114-907" aria-hidden="true" tabindex="-1"></a>long_test2 <span class="sc">|&gt;</span></span>
<span id="cb114-908"><a href="#cb114-908" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-909"><a href="#cb114-909" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove_redundant() |&gt;</span></span>
<span id="cb114-910"><a href="#cb114-910" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-911"><a href="#cb114-911" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_groups</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-912"><a href="#cb114-912" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduce_groups</span>()</span>
<span id="cb114-913"><a href="#cb114-913" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-914"><a href="#cb114-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-915"><a href="#cb114-915" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb114-916"><a href="#cb114-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-917"><a href="#cb114-917" aria-hidden="true" tabindex="-1"></a>&lt;hr&gt;</span>
<span id="cb114-918"><a href="#cb114-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-919"><a href="#cb114-919" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb114-920"><a href="#cb114-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-921"><a href="#cb114-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-922"><a href="#cb114-922" aria-hidden="true" tabindex="-1"></a><span class="fu"># Recombine Vectors</span></span>
<span id="cb114-923"><a href="#cb114-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-924"><a href="#cb114-924" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb114-925"><a href="#cb114-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-926"><a href="#cb114-926" aria-hidden="true" tabindex="-1"></a><span class="fu">## recombine2</span></span>
<span id="cb114-927"><a href="#cb114-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-930"><a href="#cb114-930" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-931"><a href="#cb114-931" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: recombine2</span></span>
<span id="cb114-932"><a href="#cb114-932" aria-hidden="true" tabindex="-1"></a>recombine2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb114-933"><a href="#cb114-933" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-934"><a href="#cb114-934" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">getelem</span>(x, <span class="st">"g2"</span>)</span>
<span id="cb114-935"><a href="#cb114-935" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-936"><a href="#cb114-936" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">empty</span>(x)) <span class="fu">return</span>(<span class="fu">character</span>(<span class="dv">0</span>))</span>
<span id="cb114-937"><a href="#cb114-937" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-938"><a href="#cb114-938" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">sf_collapse</span>(<span class="fu">list_c</span>(x), <span class="at">collapse =</span> <span class="st">'|'</span>)</span>
<span id="cb114-939"><a href="#cb114-939" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-940"><a href="#cb114-940" aria-hidden="true" tabindex="-1"></a>  <span class="co"># str_glue("^({x})[A-Z0-9]{{3}}$")</span></span>
<span id="cb114-941"><a href="#cb114-941" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_glue</span>(<span class="st">"({x})"</span>)</span>
<span id="cb114-942"><a href="#cb114-942" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-943"><a href="#cb114-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-944"><a href="#cb114-944" aria-hidden="true" tabindex="-1"></a>long_test2[<span class="fu">sf_nchar</span>(long_test2) <span class="sc">==</span> <span class="dv">2</span>] <span class="sc">|&gt;</span></span>
<span id="cb114-945"><a href="#cb114-945" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-946"><a href="#cb114-946" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-947"><a href="#cb114-947" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-948"><a href="#cb114-948" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_groups</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-949"><a href="#cb114-949" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduce_groups</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-950"><a href="#cb114-950" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recombine2</span>()</span>
<span id="cb114-951"><a href="#cb114-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-952"><a href="#cb114-952" aria-hidden="true" tabindex="-1"></a><span class="fu">random_hcpcs</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-953"><a href="#cb114-953" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-954"><a href="#cb114-954" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-955"><a href="#cb114-955" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-956"><a href="#cb114-956" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_groups</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-957"><a href="#cb114-957" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduce_groups</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-958"><a href="#cb114-958" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recombine2</span>()</span>
<span id="cb114-959"><a href="#cb114-959" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-960"><a href="#cb114-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-961"><a href="#cb114-961" aria-hidden="true" tabindex="-1"></a><span class="fu">## recombine3</span></span>
<span id="cb114-962"><a href="#cb114-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-965"><a href="#cb114-965" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-966"><a href="#cb114-966" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: recombine3</span></span>
<span id="cb114-967"><a href="#cb114-967" aria-hidden="true" tabindex="-1"></a>recombine3 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb114-968"><a href="#cb114-968" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-969"><a href="#cb114-969" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">getelem</span>(x, <span class="st">"g3"</span>)</span>
<span id="cb114-970"><a href="#cb114-970" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-971"><a href="#cb114-971" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">empty</span>(x)) <span class="fu">return</span>(<span class="fu">character</span>(<span class="dv">0</span>))</span>
<span id="cb114-972"><a href="#cb114-972" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-973"><a href="#cb114-973" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb114-974"><a href="#cb114-974" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">empty</span>(x[<span class="fu">vlen</span>(x) <span class="sc">==</span> <span class="dv">1</span>])) </span>
<span id="cb114-975"><a href="#cb114-975" aria-hidden="true" tabindex="-1"></a>      <span class="cn">NULL</span> </span>
<span id="cb114-976"><a href="#cb114-976" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> </span>
<span id="cb114-977"><a href="#cb114-977" aria-hidden="true" tabindex="-1"></a>      <span class="fu">parentheses</span>(</span>
<span id="cb114-978"><a href="#cb114-978" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sf_collapse</span>(</span>
<span id="cb114-979"><a href="#cb114-979" aria-hidden="true" tabindex="-1"></a>          <span class="fu">delist</span>(x[<span class="fu">vlen</span>(x) <span class="sc">==</span> <span class="dv">1</span>]), <span class="at">collapse =</span> <span class="st">"|"</span>)</span>
<span id="cb114-980"><a href="#cb114-980" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span></span>
<span id="cb114-981"><a href="#cb114-981" aria-hidden="true" tabindex="-1"></a>      glue<span class="sc">::</span><span class="fu">as_glue</span>(),</span>
<span id="cb114-982"><a href="#cb114-982" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">empty</span>(x[<span class="fu">vlen</span>(x) <span class="sc">&gt;</span> <span class="dv">1</span>])) </span>
<span id="cb114-983"><a href="#cb114-983" aria-hidden="true" tabindex="-1"></a>      <span class="cn">NULL</span> </span>
<span id="cb114-984"><a href="#cb114-984" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> </span>
<span id="cb114-985"><a href="#cb114-985" aria-hidden="true" tabindex="-1"></a>      <span class="fu">map</span>(x[<span class="fu">vlen</span>(x) <span class="sc">&gt;</span> <span class="dv">1</span>], </span>
<span id="cb114-986"><a href="#cb114-986" aria-hidden="true" tabindex="-1"></a>          <span class="cf">function</span>(x) {</span>
<span id="cb114-987"><a href="#cb114-987" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb114-988"><a href="#cb114-988" aria-hidden="true" tabindex="-1"></a>            front <span class="ot">&lt;-</span> <span class="fu">uniq</span>(<span class="fu">sf_sub</span>(<span class="fu">delist</span>(x), <span class="at">start =</span> <span class="dv">1</span>, <span class="at">stop =</span> <span class="dv">1</span>))</span>
<span id="cb114-989"><a href="#cb114-989" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb114-990"><a href="#cb114-990" aria-hidden="true" tabindex="-1"></a>            back  <span class="ot">&lt;-</span> <span class="fu">sf_collapse</span>(<span class="fu">sf_remove</span>(<span class="fu">delist</span>(x), <span class="fu">str_glue</span>(<span class="st">"^[{front}]{{1}}"</span>)), <span class="at">collapse =</span> <span class="st">"|"</span>)</span>
<span id="cb114-991"><a href="#cb114-991" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb114-992"><a href="#cb114-992" aria-hidden="true" tabindex="-1"></a>            <span class="fu">str_glue</span>(<span class="st">"{front}({back})"</span>)</span>
<span id="cb114-993"><a href="#cb114-993" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb114-994"><a href="#cb114-994" aria-hidden="true" tabindex="-1"></a>            })) <span class="sc">|&gt;</span> <span class="fu">list_flatten</span>()</span>
<span id="cb114-995"><a href="#cb114-995" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-996"><a href="#cb114-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-997"><a href="#cb114-997" aria-hidden="true" tabindex="-1"></a>long_test2[<span class="fu">sf_nchar</span>(long_test2) <span class="sc">==</span> <span class="dv">3</span>] <span class="sc">|&gt;</span></span>
<span id="cb114-998"><a href="#cb114-998" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-999"><a href="#cb114-999" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-1000"><a href="#cb114-1000" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-1001"><a href="#cb114-1001" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_groups</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-1002"><a href="#cb114-1002" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduce_groups</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-1003"><a href="#cb114-1003" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recombine3</span>()</span>
<span id="cb114-1004"><a href="#cb114-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1005"><a href="#cb114-1005" aria-hidden="true" tabindex="-1"></a><span class="fu">random_hcpcs</span>(<span class="dv">50</span>) <span class="sc">|&gt;</span></span>
<span id="cb114-1006"><a href="#cb114-1006" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-1007"><a href="#cb114-1007" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-1008"><a href="#cb114-1008" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-1009"><a href="#cb114-1009" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_groups</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-1010"><a href="#cb114-1010" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduce_groups</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-1011"><a href="#cb114-1011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recombine3</span>()</span>
<span id="cb114-1012"><a href="#cb114-1012" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1013"><a href="#cb114-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1014"><a href="#cb114-1014" aria-hidden="true" tabindex="-1"></a><span class="fu">## recombine4</span></span>
<span id="cb114-1015"><a href="#cb114-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1018"><a href="#cb114-1018" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-1019"><a href="#cb114-1019" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: recombine4</span></span>
<span id="cb114-1020"><a href="#cb114-1020" aria-hidden="true" tabindex="-1"></a>recombine4 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb114-1021"><a href="#cb114-1021" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-1022"><a href="#cb114-1022" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">getelem</span>(x, <span class="st">"g4"</span>)</span>
<span id="cb114-1023"><a href="#cb114-1023" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-1024"><a href="#cb114-1024" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">empty</span>(x)) <span class="fu">return</span>(<span class="fu">character</span>(<span class="dv">0</span>))</span>
<span id="cb114-1025"><a href="#cb114-1025" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-1026"><a href="#cb114-1026" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb114-1027"><a href="#cb114-1027" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">empty</span>(x[<span class="fu">vlen</span>(x) <span class="sc">==</span> <span class="dv">1</span>])) </span>
<span id="cb114-1028"><a href="#cb114-1028" aria-hidden="true" tabindex="-1"></a>      <span class="cn">NULL</span> </span>
<span id="cb114-1029"><a href="#cb114-1029" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> </span>
<span id="cb114-1030"><a href="#cb114-1030" aria-hidden="true" tabindex="-1"></a>      <span class="fu">parentheses</span>(</span>
<span id="cb114-1031"><a href="#cb114-1031" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sf_collapse</span>(</span>
<span id="cb114-1032"><a href="#cb114-1032" aria-hidden="true" tabindex="-1"></a>          <span class="fu">delist</span>(x[<span class="fu">vlen</span>(x) <span class="sc">==</span> <span class="dv">1</span>]), <span class="at">collapse =</span> <span class="st">"|"</span>)</span>
<span id="cb114-1033"><a href="#cb114-1033" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span></span>
<span id="cb114-1034"><a href="#cb114-1034" aria-hidden="true" tabindex="-1"></a>      glue<span class="sc">::</span><span class="fu">as_glue</span>(),</span>
<span id="cb114-1035"><a href="#cb114-1035" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">empty</span>(x[<span class="fu">vlen</span>(x) <span class="sc">&gt;</span> <span class="dv">1</span>])) </span>
<span id="cb114-1036"><a href="#cb114-1036" aria-hidden="true" tabindex="-1"></a>      <span class="cn">NULL</span> </span>
<span id="cb114-1037"><a href="#cb114-1037" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> </span>
<span id="cb114-1038"><a href="#cb114-1038" aria-hidden="true" tabindex="-1"></a>      <span class="fu">map</span>(x[<span class="fu">vlen</span>(x) <span class="sc">&gt;</span> <span class="dv">1</span>], </span>
<span id="cb114-1039"><a href="#cb114-1039" aria-hidden="true" tabindex="-1"></a>          <span class="cf">function</span>(x) {</span>
<span id="cb114-1040"><a href="#cb114-1040" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb114-1041"><a href="#cb114-1041" aria-hidden="true" tabindex="-1"></a>            front <span class="ot">&lt;-</span> <span class="fu">uniq</span>(<span class="fu">sf_sub</span>(<span class="fu">delist</span>(x), <span class="at">start =</span> <span class="dv">1</span>, <span class="at">stop =</span> <span class="dv">1</span>))</span>
<span id="cb114-1042"><a href="#cb114-1042" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb114-1043"><a href="#cb114-1043" aria-hidden="true" tabindex="-1"></a>            back  <span class="ot">&lt;-</span> <span class="fu">sf_collapse</span>(<span class="fu">sf_remove</span>(<span class="fu">delist</span>(x), <span class="fu">str_glue</span>(<span class="st">"^[{front}]{{1}}"</span>)), <span class="at">collapse =</span> <span class="st">"|"</span>)</span>
<span id="cb114-1044"><a href="#cb114-1044" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb114-1045"><a href="#cb114-1045" aria-hidden="true" tabindex="-1"></a>            <span class="fu">str_glue</span>(<span class="st">"{front}({back})"</span>)</span>
<span id="cb114-1046"><a href="#cb114-1046" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb114-1047"><a href="#cb114-1047" aria-hidden="true" tabindex="-1"></a>            })) <span class="sc">|&gt;</span> <span class="fu">list_flatten</span>()</span>
<span id="cb114-1048"><a href="#cb114-1048" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-1049"><a href="#cb114-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1050"><a href="#cb114-1050" aria-hidden="true" tabindex="-1"></a>long_test2[<span class="fu">sf_nchar</span>(long_test2) <span class="sc">==</span> <span class="dv">4</span>] <span class="sc">|&gt;</span></span>
<span id="cb114-1051"><a href="#cb114-1051" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-1052"><a href="#cb114-1052" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-1053"><a href="#cb114-1053" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-1054"><a href="#cb114-1054" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_groups</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-1055"><a href="#cb114-1055" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduce_groups</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-1056"><a href="#cb114-1056" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recombine4</span>()</span>
<span id="cb114-1057"><a href="#cb114-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1058"><a href="#cb114-1058" aria-hidden="true" tabindex="-1"></a><span class="fu">random_hcpcs</span>(<span class="dv">50</span>) <span class="sc">|&gt;</span></span>
<span id="cb114-1059"><a href="#cb114-1059" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-1060"><a href="#cb114-1060" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-1061"><a href="#cb114-1061" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-1062"><a href="#cb114-1062" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_groups</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-1063"><a href="#cb114-1063" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduce_groups</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-1064"><a href="#cb114-1064" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recombine4</span>()</span>
<span id="cb114-1065"><a href="#cb114-1065" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1066"><a href="#cb114-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1067"><a href="#cb114-1067" aria-hidden="true" tabindex="-1"></a><span class="fu">## recombine5</span></span>
<span id="cb114-1068"><a href="#cb114-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1071"><a href="#cb114-1071" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-1072"><a href="#cb114-1072" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: recombine5</span></span>
<span id="cb114-1073"><a href="#cb114-1073" aria-hidden="true" tabindex="-1"></a>recombine5 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb114-1074"><a href="#cb114-1074" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-1075"><a href="#cb114-1075" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">getelem</span>(x, <span class="st">"g5"</span>)</span>
<span id="cb114-1076"><a href="#cb114-1076" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-1077"><a href="#cb114-1077" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">empty</span>(x)) <span class="fu">return</span>(<span class="fu">character</span>(<span class="dv">0</span>))</span>
<span id="cb114-1078"><a href="#cb114-1078" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-1079"><a href="#cb114-1079" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb114-1080"><a href="#cb114-1080" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">empty</span>(x[<span class="fu">vlen</span>(x) <span class="sc">==</span> <span class="dv">1</span>])) </span>
<span id="cb114-1081"><a href="#cb114-1081" aria-hidden="true" tabindex="-1"></a>      <span class="cn">NULL</span> </span>
<span id="cb114-1082"><a href="#cb114-1082" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> </span>
<span id="cb114-1083"><a href="#cb114-1083" aria-hidden="true" tabindex="-1"></a>      <span class="fu">parentheses</span>(</span>
<span id="cb114-1084"><a href="#cb114-1084" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sf_collapse</span>(</span>
<span id="cb114-1085"><a href="#cb114-1085" aria-hidden="true" tabindex="-1"></a>          <span class="fu">delist</span>(x[<span class="fu">vlen</span>(x) <span class="sc">==</span> <span class="dv">1</span>]), <span class="at">collapse =</span> <span class="st">"|"</span>)</span>
<span id="cb114-1086"><a href="#cb114-1086" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span></span>
<span id="cb114-1087"><a href="#cb114-1087" aria-hidden="true" tabindex="-1"></a>      glue<span class="sc">::</span><span class="fu">as_glue</span>(),</span>
<span id="cb114-1088"><a href="#cb114-1088" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">empty</span>(x[<span class="fu">vlen</span>(x) <span class="sc">&gt;</span> <span class="dv">1</span>])) </span>
<span id="cb114-1089"><a href="#cb114-1089" aria-hidden="true" tabindex="-1"></a>      <span class="cn">NULL</span> </span>
<span id="cb114-1090"><a href="#cb114-1090" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> </span>
<span id="cb114-1091"><a href="#cb114-1091" aria-hidden="true" tabindex="-1"></a>      <span class="fu">map</span>(x[<span class="fu">vlen</span>(x) <span class="sc">&gt;</span> <span class="dv">1</span>], </span>
<span id="cb114-1092"><a href="#cb114-1092" aria-hidden="true" tabindex="-1"></a>          <span class="cf">function</span>(x) {</span>
<span id="cb114-1093"><a href="#cb114-1093" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb114-1094"><a href="#cb114-1094" aria-hidden="true" tabindex="-1"></a>            front <span class="ot">&lt;-</span> <span class="fu">uniq</span>(<span class="fu">sf_sub</span>(<span class="fu">delist</span>(x), <span class="at">start =</span> <span class="dv">1</span>, <span class="at">stop =</span> <span class="dv">1</span>))</span>
<span id="cb114-1095"><a href="#cb114-1095" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb114-1096"><a href="#cb114-1096" aria-hidden="true" tabindex="-1"></a>            back  <span class="ot">&lt;-</span> <span class="fu">sf_collapse</span>(<span class="fu">sf_remove</span>(<span class="fu">delist</span>(x), <span class="fu">str_glue</span>(<span class="st">"^[{front}]{{1}}"</span>)), <span class="at">collapse =</span> <span class="st">"|"</span>)</span>
<span id="cb114-1097"><a href="#cb114-1097" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb114-1098"><a href="#cb114-1098" aria-hidden="true" tabindex="-1"></a>            <span class="fu">str_glue</span>(<span class="st">"{front}({back})"</span>)</span>
<span id="cb114-1099"><a href="#cb114-1099" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb114-1100"><a href="#cb114-1100" aria-hidden="true" tabindex="-1"></a>            })) <span class="sc">|&gt;</span> <span class="fu">list_flatten</span>()</span>
<span id="cb114-1101"><a href="#cb114-1101" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-1102"><a href="#cb114-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1103"><a href="#cb114-1103" aria-hidden="true" tabindex="-1"></a>long_test2[<span class="fu">sf_nchar</span>(long_test2) <span class="sc">==</span> <span class="dv">5</span>] <span class="sc">|&gt;</span></span>
<span id="cb114-1104"><a href="#cb114-1104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-1105"><a href="#cb114-1105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-1106"><a href="#cb114-1106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-1107"><a href="#cb114-1107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_groups</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-1108"><a href="#cb114-1108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduce_groups</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-1109"><a href="#cb114-1109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recombine5</span>()</span>
<span id="cb114-1110"><a href="#cb114-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1111"><a href="#cb114-1111" aria-hidden="true" tabindex="-1"></a><span class="fu">random_hcpcs</span>(<span class="dv">50</span>) <span class="sc">|&gt;</span></span>
<span id="cb114-1112"><a href="#cb114-1112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-1113"><a href="#cb114-1113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-1114"><a href="#cb114-1114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-1115"><a href="#cb114-1115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_groups</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-1116"><a href="#cb114-1116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduce_groups</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-1117"><a href="#cb114-1117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recombine5</span>()</span>
<span id="cb114-1118"><a href="#cb114-1118" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1119"><a href="#cb114-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1120"><a href="#cb114-1120" aria-hidden="true" tabindex="-1"></a><span class="fu">## recombine_groups</span></span>
<span id="cb114-1121"><a href="#cb114-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1124"><a href="#cb114-1124" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-1125"><a href="#cb114-1125" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: recombine_groups</span></span>
<span id="cb114-1126"><a href="#cb114-1126" aria-hidden="true" tabindex="-1"></a>recombine_groups <span class="ot">&lt;-</span> \(x) {</span>
<span id="cb114-1127"><a href="#cb114-1127" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-1128"><a href="#cb114-1128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb114-1129"><a href="#cb114-1129" aria-hidden="true" tabindex="-1"></a>    <span class="at">v1 =</span> x<span class="sc">$</span>g1,</span>
<span id="cb114-1130"><a href="#cb114-1130" aria-hidden="true" tabindex="-1"></a>    <span class="at">v2 =</span> <span class="fu">recombine2</span>(x),</span>
<span id="cb114-1131"><a href="#cb114-1131" aria-hidden="true" tabindex="-1"></a>    <span class="at">v3 =</span> <span class="fu">recombine3</span>(x),</span>
<span id="cb114-1132"><a href="#cb114-1132" aria-hidden="true" tabindex="-1"></a>    <span class="at">v4 =</span> <span class="fu">recombine4</span>(x),</span>
<span id="cb114-1133"><a href="#cb114-1133" aria-hidden="true" tabindex="-1"></a>    <span class="at">v5 =</span> <span class="fu">recombine5</span>(x)</span>
<span id="cb114-1134"><a href="#cb114-1134" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb114-1135"><a href="#cb114-1135" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-1136"><a href="#cb114-1136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1137"><a href="#cb114-1137" aria-hidden="true" tabindex="-1"></a>long_test2 <span class="sc">|&gt;</span></span>
<span id="cb114-1138"><a href="#cb114-1138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-1139"><a href="#cb114-1139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-1140"><a href="#cb114-1140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-1141"><a href="#cb114-1141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_groups</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-1142"><a href="#cb114-1142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduce_groups</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-1143"><a href="#cb114-1143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recombine_groups</span>()</span>
<span id="cb114-1144"><a href="#cb114-1144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1145"><a href="#cb114-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1146"><a href="#cb114-1146" aria-hidden="true" tabindex="-1"></a><span class="fu">random_hcpcs</span>(<span class="dv">50</span>) <span class="sc">|&gt;</span></span>
<span id="cb114-1147"><a href="#cb114-1147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_lengths</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-1148"><a href="#cb114-1148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_redundant</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-1149"><a href="#cb114-1149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_first</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-1150"><a href="#cb114-1150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_groups</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-1151"><a href="#cb114-1151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduce_groups</span>() <span class="sc">|&gt;</span></span>
<span id="cb114-1152"><a href="#cb114-1152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recombine_groups</span>()</span>
<span id="cb114-1153"><a href="#cb114-1153" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1154"><a href="#cb114-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1155"><a href="#cb114-1155" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb114-1156"><a href="#cb114-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1157"><a href="#cb114-1157" aria-hidden="true" tabindex="-1"></a>&lt;hr&gt;</span>
<span id="cb114-1158"><a href="#cb114-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1159"><a href="#cb114-1159" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb114-1160"><a href="#cb114-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1161"><a href="#cb114-1161" aria-hidden="true" tabindex="-1"></a><span class="fu"># Collapse Regex</span></span>
<span id="cb114-1162"><a href="#cb114-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1165"><a href="#cb114-1165" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-1166"><a href="#cb114-1166" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: collapse_regex</span></span>
<span id="cb114-1167"><a href="#cb114-1167" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb114-1168"><a href="#cb114-1168" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: true</span></span>
<span id="cb114-1169"><a href="#cb114-1169" aria-hidden="true" tabindex="-1"></a>vec_to_regex <span class="ot">&lt;-</span> vrg <span class="ot">&lt;-</span> \(x, n) {</span>
<span id="cb114-1170"><a href="#cb114-1170" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-1171"><a href="#cb114-1171" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">empty</span>(x)) </span>
<span id="cb114-1172"><a href="#cb114-1172" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">character</span>(<span class="dv">0</span>))</span>
<span id="cb114-1173"><a href="#cb114-1173" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-1174"><a href="#cb114-1174" aria-hidden="true" tabindex="-1"></a>  post <span class="ot">&lt;-</span> <span class="fu">iif_else</span>(<span class="fu">sf_detect</span>(x, <span class="st">"^</span><span class="sc">\\</span><span class="st">[?[A-Z]</span><span class="sc">\\</span><span class="st">-?"</span>), <span class="st">"[0-9]"</span>, <span class="st">"[A-Z0-9]"</span>)</span>
<span id="cb114-1175"><a href="#cb114-1175" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-1176"><a href="#cb114-1176" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">fcase</span>(</span>
<span id="cb114-1177"><a href="#cb114-1177" aria-hidden="true" tabindex="-1"></a>    n <span class="sc">==</span> <span class="dv">0</span>, glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"^{x}$"</span>),                </span>
<span id="cb114-1178"><a href="#cb114-1178" aria-hidden="true" tabindex="-1"></a>    n <span class="sc">==</span> <span class="dv">1</span>, glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"^{x}{post}$"</span>),</span>
<span id="cb114-1179"><a href="#cb114-1179" aria-hidden="true" tabindex="-1"></a>    n <span class="sc">==</span> <span class="dv">2</span>, glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"^{x}{post}{{2}}$"</span>),</span>
<span id="cb114-1180"><a href="#cb114-1180" aria-hidden="true" tabindex="-1"></a>    n <span class="sc">==</span> <span class="dv">3</span>, glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"^{x}{post}{{3}}$"</span>)</span>
<span id="cb114-1181"><a href="#cb114-1181" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb114-1182"><a href="#cb114-1182" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb114-1183"><a href="#cb114-1183" aria-hidden="true" tabindex="-1"></a>  glue<span class="sc">::</span><span class="fu">glue_collapse</span>(x)</span>
<span id="cb114-1184"><a href="#cb114-1184" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-1185"><a href="#cb114-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1186"><a href="#cb114-1186" aria-hidden="true" tabindex="-1"></a>collapse_regex <span class="ot">&lt;-</span> \(x) {</span>
<span id="cb114-1187"><a href="#cb114-1187" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-1188"><a href="#cb114-1188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb114-1189"><a href="#cb114-1189" aria-hidden="true" tabindex="-1"></a>    <span class="at">g1 =</span> <span class="fu">red1</span>(x),</span>
<span id="cb114-1190"><a href="#cb114-1190" aria-hidden="true" tabindex="-1"></a>    <span class="at">g2 =</span> <span class="fu">map_chr</span>(x<span class="sc">$</span>g2, red2) <span class="sc">|&gt;</span> <span class="fu">map_chr</span>(vrg, <span class="at">n =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> glue<span class="sc">::</span><span class="fu">as_glue</span>(),</span>
<span id="cb114-1191"><a href="#cb114-1191" aria-hidden="true" tabindex="-1"></a>    <span class="at">g3 =</span> <span class="fu">map_chr</span>(x<span class="sc">$</span>g3, red3) <span class="sc">|&gt;</span> <span class="fu">map_chr</span>(vrg, <span class="at">n =</span> <span class="dv">2</span>) <span class="sc">|&gt;</span> glue<span class="sc">::</span><span class="fu">as_glue</span>(),</span>
<span id="cb114-1192"><a href="#cb114-1192" aria-hidden="true" tabindex="-1"></a>    <span class="at">g4 =</span> <span class="fu">map_chr</span>(x<span class="sc">$</span>g4, red4) <span class="sc">|&gt;</span> <span class="fu">map_chr</span>(vrg, <span class="at">n =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> glue<span class="sc">::</span><span class="fu">as_glue</span>(),</span>
<span id="cb114-1193"><a href="#cb114-1193" aria-hidden="true" tabindex="-1"></a>    <span class="at">g5 =</span> <span class="fu">map_chr</span>(x<span class="sc">$</span>g5, red5) <span class="sc">|&gt;</span> <span class="fu">map_chr</span>(vrg, <span class="at">n =</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> glue<span class="sc">::</span><span class="fu">as_glue</span>()</span>
<span id="cb114-1194"><a href="#cb114-1194" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb114-1195"><a href="#cb114-1195" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-1196"><a href="#cb114-1196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1197"><a href="#cb114-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1198"><a href="#cb114-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1201"><a href="#cb114-1201" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-1202"><a href="#cb114-1202" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: final_output</span></span>
<span id="cb114-1203"><a href="#cb114-1203" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb114-1204"><a href="#cb114-1204" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb114-1205"><a href="#cb114-1205" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb114-1206"><a href="#cb114-1206" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: true</span></span>
<span id="cb114-1207"><a href="#cb114-1207" aria-hidden="true" tabindex="-1"></a>medrex <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">verbose =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb114-1208"><a href="#cb114-1208" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">|&gt;</span> </span>
<span id="cb114-1209"><a href="#cb114-1209" aria-hidden="true" tabindex="-1"></a>    <span class="fu">split_lengths</span>(<span class="at">verbose =</span> verbose) <span class="sc">|&gt;</span> </span>
<span id="cb114-1210"><a href="#cb114-1210" aria-hidden="true" tabindex="-1"></a>    <span class="fu">remove_redundant</span>(<span class="at">verbose =</span> verbose) <span class="sc">|&gt;</span> </span>
<span id="cb114-1211"><a href="#cb114-1211" aria-hidden="true" tabindex="-1"></a>    <span class="fu">process_groups</span>(<span class="at">verbose =</span> verbose) <span class="sc">|&gt;</span> </span>
<span id="cb114-1212"><a href="#cb114-1212" aria-hidden="true" tabindex="-1"></a>    <span class="fu">reduce_groups</span>() <span class="sc">|&gt;</span> </span>
<span id="cb114-1213"><a href="#cb114-1213" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>(<span class="at">use.names =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb114-1214"><a href="#cb114-1214" aria-hidden="true" tabindex="-1"></a>    glue<span class="sc">::</span><span class="fu">glue_collapse</span>(<span class="at">sep =</span> <span class="st">"|"</span>)</span>
<span id="cb114-1215"><a href="#cb114-1215" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-1216"><a href="#cb114-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1217"><a href="#cb114-1217" aria-hidden="true" tabindex="-1"></a>long_test2[<span class="fu">nchar</span>(long_test2) <span class="sc">&gt;</span> <span class="dv">4</span>]</span>
<span id="cb114-1218"><a href="#cb114-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1219"><a href="#cb114-1219" aria-hidden="true" tabindex="-1"></a><span class="co"># REMOVE {1} FROM EXPRS WITH 5 CHARS</span></span>
<span id="cb114-1220"><a href="#cb114-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1221"><a href="#cb114-1221" aria-hidden="true" tabindex="-1"></a><span class="fu">medrex</span>(long_test2[<span class="fu">nchar</span>(long_test2) <span class="sc">&gt;</span> <span class="dv">4</span>])</span>
<span id="cb114-1222"><a href="#cb114-1222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1223"><a href="#cb114-1223" aria-hidden="true" tabindex="-1"></a>vctrs<span class="sc">::</span><span class="fu">vec_slice</span>(</span>
<span id="cb114-1224"><a href="#cb114-1224" aria-hidden="true" tabindex="-1"></a>  hcpcs, </span>
<span id="cb114-1225"><a href="#cb114-1225" aria-hidden="true" tabindex="-1"></a>  stringfish<span class="sc">::</span><span class="fu">sf_grepl</span>(</span>
<span id="cb114-1226"><a href="#cb114-1226" aria-hidden="true" tabindex="-1"></a>    hcpcs, </span>
<span id="cb114-1227"><a href="#cb114-1227" aria-hidden="true" tabindex="-1"></a>    <span class="fu">medrex</span>(</span>
<span id="cb114-1228"><a href="#cb114-1228" aria-hidden="true" tabindex="-1"></a>      long_test2[<span class="fu">nchar</span>(long_test2) <span class="sc">&gt;</span> <span class="dv">4</span>],</span>
<span id="cb114-1229"><a href="#cb114-1229" aria-hidden="true" tabindex="-1"></a>      <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb114-1230"><a href="#cb114-1230" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb114-1231"><a href="#cb114-1231" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb114-1232"><a href="#cb114-1232" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb114-1233"><a href="#cb114-1233" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1234"><a href="#cb114-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1235"><a href="#cb114-1235" aria-hidden="true" tabindex="-1"></a>&lt;hr&gt;</span>
<span id="cb114-1236"><a href="#cb114-1236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1237"><a href="#cb114-1237" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb114-1238"><a href="#cb114-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1239"><a href="#cb114-1239" aria-hidden="true" tabindex="-1"></a><span class="fu"># S7 Class</span></span>
<span id="cb114-1240"><a href="#cb114-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1243"><a href="#cb114-1243" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-1244"><a href="#cb114-1244" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: s7_class</span></span>
<span id="cb114-1245"><a href="#cb114-1245" aria-hidden="true" tabindex="-1"></a>hcpcs <span class="ot">&lt;-</span> <span class="fu">new_class</span>(</span>
<span id="cb114-1246"><a href="#cb114-1246" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">"hcpcs"</span>,</span>
<span id="cb114-1247"><a href="#cb114-1247" aria-hidden="true" tabindex="-1"></a>  <span class="at">properties =</span> <span class="fu">list</span>(</span>
<span id="cb114-1248"><a href="#cb114-1248" aria-hidden="true" tabindex="-1"></a>    <span class="at">input =</span> class_vector,</span>
<span id="cb114-1249"><a href="#cb114-1249" aria-hidden="true" tabindex="-1"></a>    <span class="at">split_length     =</span> <span class="fu">new_property</span>(<span class="at">class =</span> class_list, <span class="at">getter =</span> \(self) <span class="fu">split_lengths</span>(self<span class="sc">@</span>input)),</span>
<span id="cb114-1250"><a href="#cb114-1250" aria-hidden="true" tabindex="-1"></a>    <span class="at">remove_redundant =</span> <span class="fu">new_property</span>(<span class="at">class =</span> class_list, <span class="at">getter =</span> \(self) <span class="fu">remove_redundant</span>(self<span class="sc">@</span>split_length)),</span>
<span id="cb114-1251"><a href="#cb114-1251" aria-hidden="true" tabindex="-1"></a>    <span class="at">split_first      =</span> <span class="fu">new_property</span>(<span class="at">class =</span> class_list, <span class="at">getter =</span> \(self) <span class="fu">split_first</span>(self<span class="sc">@</span>remove_redundant)),</span>
<span id="cb114-1252"><a href="#cb114-1252" aria-hidden="true" tabindex="-1"></a>    <span class="at">process_groups   =</span> <span class="fu">new_property</span>(<span class="at">class =</span> class_list, <span class="at">getter =</span> \(self) <span class="fu">process_groups</span>(self<span class="sc">@</span>split_first)),</span>
<span id="cb114-1253"><a href="#cb114-1253" aria-hidden="true" tabindex="-1"></a>    <span class="at">reduce_groups    =</span> <span class="fu">new_property</span>(<span class="at">class =</span> class_list, <span class="at">getter =</span> \(self) <span class="fu">reduce_groups</span>(self<span class="sc">@</span>process_groups)),</span>
<span id="cb114-1254"><a href="#cb114-1254" aria-hidden="true" tabindex="-1"></a>    <span class="at">recombine_groups =</span> <span class="fu">new_property</span>(<span class="at">class =</span> class_list, <span class="at">getter =</span> \(self) <span class="fu">recombine_groups</span>(self<span class="sc">@</span>reduce_groups))</span>
<span id="cb114-1255"><a href="#cb114-1255" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb114-1256"><a href="#cb114-1256" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb114-1257"><a href="#cb114-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1258"><a href="#cb114-1258" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">hcpcs</span>(<span class="at">input =</span> <span class="fu">random_hcpcs</span>(<span class="dv">50</span>))</span>
<span id="cb114-1259"><a href="#cb114-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1260"><a href="#cb114-1260" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb114-1261"><a href="#cb114-1261" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1262"><a href="#cb114-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1263"><a href="#cb114-1263" aria-hidden="true" tabindex="-1"></a>&lt;hr&gt;</span>
<span id="cb114-1264"><a href="#cb114-1264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1265"><a href="#cb114-1265" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb114-1266"><a href="#cb114-1266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1267"><a href="#cb114-1267" aria-hidden="true" tabindex="-1"></a>::: {#nte-references .callout-tip collapse="true"}</span>
<span id="cb114-1268"><a href="#cb114-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1269"><a href="#cb114-1269" aria-hidden="true" tabindex="-1"></a><span class="fu">## Links</span></span>
<span id="cb114-1270"><a href="#cb114-1270" aria-hidden="true" tabindex="-1"></a><span class="fu">### Reference</span></span>
<span id="cb114-1271"><a href="#cb114-1271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1272"><a href="#cb114-1272" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="co">[</span><span class="ot">Regex Cheatsheet</span><span class="co">](https://github.com/raredd/regex)</span></span>
<span id="cb114-1273"><a href="#cb114-1273" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="co">[</span><span class="ot">Learn Regex</span><span class="co">](https://github.com/ziishaned/learn-regex)</span></span>
<span id="cb114-1274"><a href="#cb114-1274" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="co">[</span><span class="ot">Evaluating strings as code</span><span class="co">](https://josiahparry.com/posts/2024-06-13-eval-strings)</span></span>
<span id="cb114-1275"><a href="#cb114-1275" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="co">[</span><span class="ot">Building rules from code operands</span><span class="co">](https://github.com/Permian-Global-Research/rsi)</span></span>
<span id="cb114-1276"><a href="#cb114-1276" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="co">[</span><span class="ot">Filter logic</span><span class="co">](https://github.com/atorus-research/ardis/blob/main/R/denom.R)</span></span>
<span id="cb114-1277"><a href="#cb114-1277" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="co">[</span><span class="ot">Regular-Expression.info</span><span class="co">](https://www.regular-expressions.info/tutorial.html)</span></span>
<span id="cb114-1278"><a href="#cb114-1278" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="co">[</span><span class="ot">RexEgg</span><span class="co">](https://www.rexegg.com/)</span></span>
<span id="cb114-1279"><a href="#cb114-1279" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="co">[</span><span class="ot">Regular Expressions as used in R</span><span class="co">](https://stat.ethz.ch/R-manual/R-devel/library/base/html/regex.html)</span></span>
<span id="cb114-1280"><a href="#cb114-1280" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="co">[</span><span class="ot">Debuggex</span><span class="co">](https://www.debuggex.com/)</span></span>
<span id="cb114-1281"><a href="#cb114-1281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1282"><a href="#cb114-1282" aria-hidden="true" tabindex="-1"></a><span class="fu">### Packages</span></span>
<span id="cb114-1283"><a href="#cb114-1283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1284"><a href="#cb114-1284" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="co">[</span><span class="ot">**textshape**</span><span class="co">](https://github.com/trinker/textshape)</span></span>
<span id="cb114-1285"><a href="#cb114-1285" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="co">[</span><span class="ot">**stringr.plus**</span><span class="co">](https://github.com/johncassil/stringr.plus)</span></span>
<span id="cb114-1286"><a href="#cb114-1286" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="co">[</span><span class="ot">**regexmagic**</span><span class="co">](https://github.com/jonocarroll/regexmagic)</span></span>
<span id="cb114-1287"><a href="#cb114-1287" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="co">[</span><span class="ot">**makeunique**</span><span class="co">](https://github.com/selkamand/makeunique)</span></span>
<span id="cb114-1288"><a href="#cb114-1288" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="co">[</span><span class="ot">**similiars**</span><span class="co">](https://github.com/davidsjoberg/similiars)</span></span>
<span id="cb114-1289"><a href="#cb114-1289" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="co">[</span><span class="ot">**strex**</span><span class="co">](https://github.com/rorynolan/strex/)</span></span>
<span id="cb114-1290"><a href="#cb114-1290" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="co">[</span><span class="ot">**stringfish**</span><span class="co">](https://github.com/traversc/stringfish)</span></span>
<span id="cb114-1291"><a href="#cb114-1291" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="co">[</span><span class="ot">**collapse**</span><span class="co">](https://sebkrantz.github.io/collapse/)</span></span>
<span id="cb114-1292"><a href="#cb114-1292" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="co">[</span><span class="ot">**kit**</span><span class="co">](https://github.com/2005m/kit)</span></span>
<span id="cb114-1293"><a href="#cb114-1293" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="co">[</span><span class="ot">**cheapr**</span><span class="co">](https://github.com/NicChr/cheapr)</span></span>
<span id="cb114-1294"><a href="#cb114-1294" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="co">[</span><span class="ot">**fastplyr**</span><span class="co">](https://github.com/NicChr/fastplyr)</span></span>
<span id="cb114-1295"><a href="#cb114-1295" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="co">[</span><span class="ot">**stringi**</span><span class="co">](https://stringi.gagolewski.com/)</span></span>
<span id="cb114-1296"><a href="#cb114-1296" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="co">[</span><span class="ot">**qdapRegex**</span><span class="co">](https://github.com/trinker/qdapRegex)</span></span>
<span id="cb114-1297"><a href="#cb114-1297" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="co">[</span><span class="ot">**charcuterie**</span><span class="co">](https://github.com/jonocarroll/charcuterie)</span></span>
<span id="cb114-1298"><a href="#cb114-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1299"><a href="#cb114-1299" aria-hidden="true" tabindex="-1"></a><span class="fu">### Functions</span></span>
<span id="cb114-1300"><a href="#cb114-1300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1301"><a href="#cb114-1301" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="co">[</span><span class="ot">mark::globbing</span><span class="co">](https://github.com/jmbarbone/mark/blob/main/R/glob.R)</span></span>
<span id="cb114-1302"><a href="#cb114-1302" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="co">[</span><span class="ot">RUtil::make_unique_comb</span><span class="co">](https://github.com/raivokolde/RUtil/blob/master/Source/R/make_unique_comb.r)</span></span>
<span id="cb114-1303"><a href="#cb114-1303" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="co">[</span><span class="ot">mirmisc::longest_common_substring</span><span class="co">](https://github.com/mirvie/mirmisc/blob/main/R/utils.R)</span></span>
<span id="cb114-1304"><a href="#cb114-1304" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="co">[</span><span class="ot">hutils::longest prefix/suffix</span><span class="co">](https://github.com/HughParsonage/hutils/blob/master/R/longest_affix.R)</span></span>
<span id="cb114-1305"><a href="#cb114-1305" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="co">[</span><span class="ot">tidyext::combn_2_col</span><span class="co">](https://github.com/m-clark/tidyext/blob/master/R/combn_2_col.R)</span></span>
<span id="cb114-1306"><a href="#cb114-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1307"><a href="#cb114-1307" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb114-1308"><a href="#cb114-1308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1309"><a href="#cb114-1309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1310"><a href="#cb114-1310" aria-hidden="true" tabindex="-1"></a><span class="fu">## Session Information </span></span>
<span id="cb114-1311"><a href="#cb114-1311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1314"><a href="#cb114-1314" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-1315"><a href="#cb114-1315" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb114-1316"><a href="#cb114-1316" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">sessionInfo</span>())</span>
<span id="cb114-1317"><a href="#cb114-1317" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2024 Andrew Allen Bruce.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>