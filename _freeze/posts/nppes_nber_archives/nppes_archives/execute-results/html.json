{
  "hash": "a0bfefab8f813d63775107e04c2e847c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"NPPES NPI Archives\"\nformat:\n  html:\n    reference-location: block\neditor_options: \n  chunk_output_type: console\n---\n\n::: {.cell}\n\n:::\n\n\n\n\n# 2024-01-01\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nw241_base <- wk_2024_01_01$basic |> \n  fcompute(\n    npi = npi,\n    entity = data.table::fcase(entity == \"Ind\", \"I\", entity == \"Org\", \"O\"),\n    prefix = sf_remove(prefix, \"\\\\.\"),\n    first_name = sf_remove(first, \"\\\\.\"),\n    middle_name = sf_remove(middle, \"\\\\.\"),\n    last_name = sf_remove(last, \"\\\\.\"),\n    suffix = sf_remove(suffix, \"\\\\.\"),\n    credential = sf_remove(credential, \"\\\\.\"),\n    org_parent = sf_remove(parent_org_lbn, \"\\\\.|,\"),\n    org_prov = sf_remove(prov_org_lbn, \"\\\\.|,\"),\n    cert_date = certified,\n    enum_date = enum_date,\n    deact_date = deact_date,\n    react_date = react_date,\n    sole_prop = sole_prop,\n    org_subpart = org_sub\n    )\n\n# Remove deactivated NPIs with no reactivation date\nw241_deact <- w241_base |> filter(not_na(deact_date), !not_na(react_date)) |> remove_quiet()\n\nw241_base <- fsubset(w241_base, npi %!in% w241_deact$npi)\n\n\n# Credentials in Last Name\nw241_base |> \n  fsubset(sf_detect(last_name, \", \")) |> \n  fsubset(is.na(credential))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 16\n  npi        entity prefix first_name middle_name last_name    suffix credential\n  <chr>      <chr>  <chr>  <chr>      <chr>       <chr>        <chr>  <chr>     \n1 1265752158 I      <NA>   LIVIA      S           MACHADO, RP… <NA>   <NA>      \n2 1386886174 I      MS     JUDY       A           LIU, INC     <NA>   <NA>      \n# ℹ 8 more variables: org_parent <chr>, org_prov <chr>, cert_date <date>,\n#   enum_date <date>, deact_date <date>, react_date <date>, sole_prop <chr>,\n#   org_subpart <chr>\n```\n\n\n:::\n\n```{.r .cell-code}\nbase_g <- GRP(w241_base, ~ entity)\n\nw241_base_spl <- rsplit(w241_base, base_g) |> \n  map(remove_quiet) |> \n  setNames(GRPnames(base_g))\n\nw241_base_spl\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$I\n# A tibble: 15,267 × 13\n   npi        entity prefix first_name middle_name last_name   suffix credential\n   <chr>      <chr>  <chr>  <chr>      <chr>       <chr>       <chr>  <chr>     \n 1 1912620808 I      <NA>   DEIDRE     <NA>        HAMILTON    <NA>   <NA>      \n 2 1518543511 I      <NA>   VANESSA    <NA>        CHAMBERS    <NA>   RN        \n 3 1619688645 I      <NA>   DESTINY    RENEE       BARNETT     <NA>   AGACNP-BC \n 4 1437575206 I      <NA>   MICHELE    <NA>        WHITE       <NA>   PHD LLP L…\n 5 1053912162 I      MS     CHANEL     MARIE       POOLE       <NA>   LMT       \n 6 1265752158 I      <NA>   LIVIA      S           MACHADO, R… <NA>   <NA>      \n 7 1609131515 I      <NA>   EYAD       <NA>        ALDAAS      <NA>   MD        \n 8 1750841870 I      <NA>   TAM        T           TRAN        <NA>   MD        \n 9 1942708748 I      <NA>   WINFORD    <NA>        PALMA       <NA>   CRNA      \n10 1255864583 I      <NA>   GWENDOLYN  <NA>        WILSON      <NA>   LMHC, ATR \n# ℹ 15,257 more rows\n# ℹ 5 more variables: cert_date <date>, enum_date <date>, deact_date <date>,\n#   react_date <date>, sole_prop <chr>\n\n$O\n# A tibble: 3,917 × 9\n   npi    entity org_parent org_prov cert_date  enum_date  deact_date react_date\n   <chr>  <chr>  <chr>      <chr>    <date>     <date>     <date>     <date>    \n 1 19527… O      <NA>       WHITE B… 2024-01-01 2014-01-31 NA         NA        \n 2 15489… O      <NA>       MORGAN … 2022-10-04 2021-10-29 NA         NA        \n 3 12955… O      <NA>       KENDRA … 2023-09-26 2024-01-01 NA         NA        \n 4 13864… O      <NA>       ULYSSES… 2023-09-19 2024-01-01 NA         NA        \n 5 15581… O      <NA>       RETHINK… 2023-12-21 2024-01-01 NA         NA        \n 6 18218… O      <NA>       AURORA … 2023-12-28 2024-01-01 NA         NA        \n 7 16490… O      <NA>       PULSE U… 2023-12-27 2024-01-01 NA         NA        \n 8 12753… O      <NA>       NVR & S… 2023-12-30 2024-01-01 NA         NA        \n 9 13561… O      <NA>       HEBKRAM… 2023-12-30 2024-01-01 NA         NA        \n10 15086… O      <NA>       HYPNOSI… 2023-12-30 2024-01-01 NA         NA        \n# ℹ 3,907 more rows\n# ℹ 1 more variable: org_subpart <chr>\n```\n\n\n:::\n\n```{.r .cell-code}\n# Org NPIs that are org_subpart have org_parent names\nrsplit(w241_base_spl$O, w241_base_spl$O$org_subpart)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$N\n# A tibble: 3,514 × 9\n   npi    entity org_parent org_prov cert_date  enum_date  deact_date react_date\n   <chr>  <chr>  <chr>      <chr>    <date>     <date>     <date>     <date>    \n 1 19527… O      <NA>       WHITE B… 2024-01-01 2014-01-31 NA         NA        \n 2 15489… O      <NA>       MORGAN … 2022-10-04 2021-10-29 NA         NA        \n 3 12955… O      <NA>       KENDRA … 2023-09-26 2024-01-01 NA         NA        \n 4 13864… O      <NA>       ULYSSES… 2023-09-19 2024-01-01 NA         NA        \n 5 15581… O      <NA>       RETHINK… 2023-12-21 2024-01-01 NA         NA        \n 6 18218… O      <NA>       AURORA … 2023-12-28 2024-01-01 NA         NA        \n 7 16490… O      <NA>       PULSE U… 2023-12-27 2024-01-01 NA         NA        \n 8 12753… O      <NA>       NVR & S… 2023-12-30 2024-01-01 NA         NA        \n 9 13561… O      <NA>       HEBKRAM… 2023-12-30 2024-01-01 NA         NA        \n10 15086… O      <NA>       HYPNOSI… 2023-12-30 2024-01-01 NA         NA        \n# ℹ 3,504 more rows\n# ℹ 1 more variable: org_subpart <chr>\n\n$Y\n# A tibble: 403 × 9\n   npi    entity org_parent org_prov cert_date  enum_date  deact_date react_date\n   <chr>  <chr>  <chr>      <chr>    <date>     <date>     <date>     <date>    \n 1 16894… O      RAE 6 LLC  RAE6TECH 2023-12-30 2024-01-01 NA         NA        \n 2 11248… O      POPLAR PE… POPLAR … 2024-01-01 2023-09-06 NA         NA        \n 3 19420… O      ASTERRA L… AUBURN … 2024-01-01 2024-01-01 NA         NA        \n 4 15783… O      LW CARE L… LW CARE… 2023-12-27 2024-01-01 NA         NA        \n 5 10137… O      LW CARE L… LW CARE… 2024-01-01 2024-01-01 NA         NA        \n 6 18319… O      LW CARE L… LW CARE… 2024-01-01 2024-01-01 NA         NA        \n 7 15682… O      LW CARE L… LW CARE… 2024-01-01 2024-01-01 NA         NA        \n 8 14671… O      1336854454 CLINICA… 2024-01-01 2023-01-23 NA         NA        \n 9 18218… O      LW CARE L… LW CARE… 2024-01-01 2024-01-01 NA         NA        \n10 11144… O      LAKE WASH… ADVANCE… 2024-01-01 2018-06-11 NA         NA        \n# ℹ 393 more rows\n# ℹ 1 more variable: org_subpart <chr>\n```\n\n\n:::\n\n```{.r .cell-code}\n# Individuals - Sole Proprietors\nrsplit(w241_base_spl$I, w241_base_spl$I$sole_prop)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$N\n# A tibble: 10,405 × 13\n   npi        entity prefix first_name middle_name last_name   suffix credential\n   <chr>      <chr>  <chr>  <chr>      <chr>       <chr>       <chr>  <chr>     \n 1 1912620808 I      <NA>   DEIDRE     <NA>        HAMILTON    <NA>   <NA>      \n 2 1619688645 I      <NA>   DESTINY    RENEE       BARNETT     <NA>   AGACNP-BC \n 3 1265752158 I      <NA>   LIVIA      S           MACHADO, R… <NA>   <NA>      \n 4 1609131515 I      <NA>   EYAD       <NA>        ALDAAS      <NA>   MD        \n 5 1750841870 I      <NA>   TAM        T           TRAN        <NA>   MD        \n 6 1942708748 I      <NA>   WINFORD    <NA>        PALMA       <NA>   CRNA      \n 7 1477895621 I      <NA>   GARY       FRANK       RIVAS       <NA>   RD, PA-C  \n 8 1891305488 I      <NA>   ALISHA     LYNNE       RUKOVISHNI… <NA>   <NA>      \n 9 1477322501 I      <NA>   ELLA       <NA>        COOK        <NA>   NP        \n10 1568231694 I      <NA>   ANNA       <NA>        THOMPSON    <NA>   <NA>      \n# ℹ 10,395 more rows\n# ℹ 5 more variables: cert_date <date>, enum_date <date>, deact_date <date>,\n#   react_date <date>, sole_prop <chr>\n\n$X\n# A tibble: 29 × 13\n   npi        entity prefix first_name middle_name last_name   suffix credential\n   <chr>      <chr>  <chr>  <chr>      <chr>       <chr>       <chr>  <chr>     \n 1 1639155427 I      <NA>   STEPHEN    JOHN        SMITH       <NA>   MD        \n 2 1992706071 I      <NA>   PRISCILA   <NA>        SUNTAY      <NA>   MD        \n 3 1619942935 I      DR     NORMA      VB          MADERAZO    <NA>   MD        \n 4 1710978242 I      DR     SHAHIRA    HALIM       FELOUS      <NA>   MD        \n 5 1376521179 I      <NA>   ROSEMARY   M           BRANSTETTER <NA>   LCSW      \n 6 1033109871 I      DR     JOHN       B           LAFAVE      <NA>   MD        \n 7 1750325726 I      MS     MERRILL    <NA>        GOLDSTEIN   <NA>   NYPSYA    \n 8 1144274283 I      MS     LUCILLE    J           ST-PIERRE   <NA>   PTA       \n 9 1528045325 I      MR     JOHN       <NA>        BOYD        <NA>   LCPC      \n10 1578511382 I      DR     DONALD     MICHAEL     MANZO       <NA>   OD        \n# ℹ 19 more rows\n# ℹ 5 more variables: cert_date <date>, enum_date <date>, deact_date <date>,\n#   react_date <date>, sole_prop <chr>\n\n$Y\n# A tibble: 4,833 × 13\n   npi        entity prefix first_name middle_name last_name   suffix credential\n   <chr>      <chr>  <chr>  <chr>      <chr>       <chr>       <chr>  <chr>     \n 1 1518543511 I      <NA>   VANESSA    <NA>        CHAMBERS    <NA>   RN        \n 2 1437575206 I      <NA>   MICHELE    <NA>        WHITE       <NA>   PHD LLP L…\n 3 1053912162 I      MS     CHANEL     MARIE       POOLE       <NA>   LMT       \n 4 1255864583 I      <NA>   GWENDOLYN  <NA>        WILSON      <NA>   LMHC, ATR \n 5 1831968973 I      MS     APRIL      JENILLE     JULIAN-ST … <NA>   <NA>      \n 6 1922877067 I      <NA>   VASHTI     <NA>        CLARK       <NA>   LMSW      \n 7 1568231603 I      <NA>   LYNDSEY    <NA>        HANSEN      <NA>   <NA>      \n 8 1477322519 I      <NA>   MOHAMED    <NA>        ABDURAHMAN  <NA>   <NA>      \n 9 1912776055 I      <NA>   DWIGHT     <NA>        ADAMS       <NA>   CRNA      \n10 1730958877 I      <NA>   GIFTY      <NA>        BREW-THOMP… <NA>   <NA>      \n# ℹ 4,823 more rows\n# ℹ 5 more variables: cert_date <date>, enum_date <date>, deact_date <date>,\n#   react_date <date>, sole_prop <chr>\n```\n\n\n:::\n:::\n\n\n\n\n## Address\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nw241_add <- join(\n  wk_2024_01_01$address, \n  w241_base[c(\"npi\", \"entity\")], \n  on = \"npi\", \n  verbose = 0) |> \n  fsubset(npi %!in% w241_deact$npi)\n\n# Exact match on all address fields\nw241_exact <- w241_add |> \n  filter(\n    mail_address == prac_address,\n    mail_city == prac_city,\n    mail_state == prac_state,\n    mail_zip == prac_zip,\n    mail_country == prac_country,\n    mail_phone == prac_phone,\n    mail_fax == prac_fax) |> \n  fcompute(\n    npi = npi,\n    entity = entity,\n    purpose = \"MP\",\n    address = prac_address,\n    city = prac_city,\n    state = prac_state,\n    zip = map_chr(prac_zip, \\(x) if (not_na(x) & nchar(x) == 9) str_glue(\"{substr(x, 1, 5)}-{substr(x, 6, 9)}\") else x),\n    country = prac_country,\n    phone = map_chr(prac_phone, \\(x) if (not_na(x) & nchar(x) == 10) str_glue(\"({substr(x, 1, 3)}) {substr(x, 4, 6)}-{substr(x, 7, 10)}\") else x),\n    fax = map_chr(prac_fax, \\(x) if (not_na(x) & nchar(x) == 10) str_glue(\"({substr(x, 1, 3)}) {substr(x, 4, 6)}-{substr(x, 7, 10)}\") else x))\n\n# Match on all except FAX\nw241_fax <- w241_add |> \n  filter(\n    npi %!in% w241_exact$npi,  \n    mail_address == prac_address, \n    mail_city == prac_city,\n    mail_state == prac_state,\n    mail_country == prac_country,\n    mail_zip == prac_zip,\n    mail_phone == prac_phone) |> \n  fcompute(\n    npi = npi,\n    entity = entity,\n    address = prac_address,\n    city = prac_city,\n    state = prac_state,\n    zip = map_chr(prac_zip, \\(x) if (not_na(x) & nchar(x) == 9) str_glue(\"{substr(x, 1, 5)}-{substr(x, 6, 9)}\") else x),\n    country = prac_country,\n    phone = map_chr(prac_phone, \\(x) if (not_na(x) & nchar(x) == 10) str_glue(\"({substr(x, 1, 3)}) {substr(x, 4, 6)}-{substr(x, 7, 10)}\") else x),\n    fax = fcase(\n      not_na(mail_fax) & not_na(prac_fax) & mail_fax == prac_fax, str_glue(\"{prac_fax}\"),\n      not_na(mail_fax) & not_na(prac_fax) & mail_fax != prac_fax, str_glue(\"{mail_fax}, {prac_fax}\"),\n      not_na(mail_fax) & !not_na(prac_fax), str_glue(\"{mail_fax}\"),\n      !not_na(mail_fax) & not_na(prac_fax), str_glue(\"{prac_fax}\")),\n    purpose = fcase(\n      not_na(mail_fax) & !not_na(prac_fax), \"M\",\n      !not_na(mail_fax) & not_na(prac_fax), \"P\",\n      default = \"MP\")) |> \n  fmutate(\n    fax = map_chr(\n      fax, \\(x) if (not_na(x)) {\n        if (nchar(x) == 10) {\n          str_glue(\"({substr(x, 1, 3)}) {substr(x, 4, 6)}-{substr(x, 7, 10)}\")\n          } else if (nchar(x) > 10) {\n            str_glue(\"({substr(x, 1, 3)}) {substr(x, 4, 6)}-{substr(x, 7, 10)}, ({substr(x, 13, 15)})-{substr(x, 16, 18)}-{substr(x, 19, 22)}\")\n            } \n        } \n      else x\n      )\n    )\n\n# Match on all except ZIP, PHONE, and FAX\nw241_phone <- w241_add |> \n  filter(\n    npi %!in% c(w241_exact$npi, w241_fax$npi),      \n    mail_address == prac_address,\n    mail_city == prac_city,\n    mail_state == prac_state,\n    mail_country == prac_country) |>\n  fcompute(\n    npi = npi,\n    entity = entity,\n    purpose = fcase(not_na(mail_phone) & !not_na(prac_phone), \"M\",\n                    !not_na(mail_phone) & not_na(prac_phone), \"P\",\n                    default = \"MP\"),\n    address = prac_address,\n    city = prac_city,\n    state = prac_state,\n    zip = fcase(\n      not_na(mail_zip) & not_na(prac_zip) & mail_zip == prac_zip, str_glue(\"{prac_zip}\"),\n      not_na(mail_zip) & not_na(prac_zip) & mail_zip != prac_zip, str_glue(\"{mail_zip}, {prac_zip}\"),\n      not_na(mail_zip) & !not_na(prac_zip), str_glue(\"{mail_zip}\"),\n      !not_na(mail_zip) & not_na(prac_zip), str_glue(\"{prac_zip}\")),\n    country = prac_country,\n    phone = fcase(\n      not_na(mail_phone) & not_na(prac_phone) & mail_phone == prac_phone, str_glue(\"{prac_phone}\"),\n      not_na(mail_phone) & not_na(prac_phone) & mail_phone != prac_phone, str_glue(\"{mail_phone}, {prac_phone}\"),\n      not_na(mail_phone) & !not_na(prac_phone), str_glue(\"{mail_phone}\"),\n      !not_na(mail_phone) & not_na(prac_phone), str_glue(\"{prac_phone}\")),\n    fax = fcase(\n      not_na(mail_fax) & not_na(prac_fax) & mail_fax == prac_fax, str_glue(\"{prac_fax}\"),\n      not_na(mail_fax) & not_na(prac_fax) & mail_fax != prac_fax, str_glue(\"{mail_fax}, {prac_fax}\"),\n      not_na(mail_fax) & !not_na(prac_fax), str_glue(\"{mail_fax}\"),\n      !not_na(mail_fax) & not_na(prac_fax), str_glue(\"{prac_fax}\"))) |> \n  fmutate(\n    zip = map_chr(zip, \\(x) if (not_na(x) & nchar(x) == 9) str_glue(\"{substr(x, 1, 5)}-{substr(x, 6, 9)}\") else x), \n    phone = map_chr(\n      phone, \\(x) if (not_na(x)) {\n        if (nchar(x) == 10) {\n          str_glue(\"({substr(x, 1, 3)}) {substr(x, 4, 6)}-{substr(x, 7, 10)}\")\n          } else if (nchar(x) > 10) {\n            str_glue(\"({substr(x, 1, 3)}) {substr(x, 4, 6)}-{substr(x, 7, 10)}, ({substr(x, 13, 15)})-{substr(x, 16, 18)}-{substr(x, 19, 22)}\")\n            } \n        } \n      else x\n      ),\n    fax = map_chr(\n      fax, \\(x) if (not_na(x)) {\n        if (nchar(x) == 10) {\n          str_glue(\"({substr(x, 1, 3)}) {substr(x, 4, 6)}-{substr(x, 7, 10)}\")\n          } else if (nchar(x) > 10) {\n            str_glue(\"({substr(x, 1, 3)}) {substr(x, 4, 6)}-{substr(x, 7, 10)}, ({substr(x, 13, 15)})-{substr(x, 16, 18)}-{substr(x, 19, 22)}\")\n            } \n        } \n      else x\n      )\n    )\n\n# Pivot remaining addresses\nw241_piv <- w241_add |> \n  filter(npi %!in% c(w241_exact$npi, w241_fax$npi, w241_phone$npi)) |> \n  pivot_longer(\n    -c(npi, entity), \n    names_to = \"type_part\", \n    values_to = \"value\", \n    names_transform = list(type_part = stringr::str_to_title)) |> \n  separate_wider_delim(\n    type_part, \n    delim = \"_\", \n    names = c(\"type\", \"part\")) |> \n  fmutate(\n    purpose = case_when(\n      type == \"Mail\" ~ \"M\",\n      type == \"Prac\" ~ \"P\",\n    .default = type),\n    type = NULL\n    ) |>\n  pivot_wider(names_from = part, values_from = value) |> \n  fmutate(\n    zip = map_chr(zip, \\(x) if (not_na(x) & nchar(x) == 9) str_glue(\"{substr(x, 1, 5)}-{substr(x, 6, 9)}\") else x), \n    phone = map_chr(\n      phone, \\(x) if (not_na(x)) {\n        if (nchar(x) == 10) {\n          str_glue(\"({substr(x, 1, 3)}) {substr(x, 4, 6)}-{substr(x, 7, 10)}\")\n          } else if (nchar(x) > 10) {\n            str_glue(\"({substr(x, 1, 3)}) {substr(x, 4, 6)}-{substr(x, 7, 10)}, ({substr(x, 13, 15)})-{substr(x, 16, 18)}-{substr(x, 19, 22)}\")\n            } \n        } \n      else x\n      ),\n    fax = map_chr(\n      fax, \\(x) if (not_na(x)) {\n        if (nchar(x) == 10) {\n          str_glue(\"({substr(x, 1, 3)}) {substr(x, 4, 6)}-{substr(x, 7, 10)}\")\n          } else if (nchar(x) > 10) {\n            str_glue(\"({substr(x, 1, 3)}) {substr(x, 4, 6)}-{substr(x, 7, 10)}, ({substr(x, 13, 15)})-{substr(x, 16, 18)}-{substr(x, 19, 22)}\")\n            } \n        } \n      else x\n      )\n    )\n\n# Combine all address matches\nw241_add <- rowbind(w241_exact, w241_fax, w241_phone, w241_piv)\n\nadd_g <- GRP(w241_add, ~ entity)\n\nrsplit(w241_add, add_g) |> \n  map(remove_quiet) |> \n  setNames(GRPnames(add_g))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$I\n# A tibble: 22,883 × 10\n   npi        entity purpose address       city  state zip   country phone fax  \n   <chr>      <chr>  <chr>   <chr>         <chr> <chr> <chr> <chr>   <chr> <chr>\n 1 1437575206 I      MP      3840 PACKARD… ANN … MI    4810… US      (734… (734…\n 2 1477895621 I      MP      3144 SANTA A… EL M… CA    9173… US      (626… (626…\n 3 1346019486 I      MP      57 TOWNSHIP … CHES… OH    4561… US      (740… (740…\n 4 1265201206 I      MP      822 LOVELACE… BREW… AL    3642… US      (251… (800…\n 5 1447029483 I      MP      350 FAIRWAY … DEER… FL    3344… US      (877… (866…\n 6 1295504249 I      MP      1550 N 115TH… SEAT… WA    9813… US      (206… (206…\n 7 1073382024 I      MP      401 16TH ST … ROCH… MN    5590… US      (507… (507…\n 8 1639948698 I      MP      920 SARATOGA… SAN … CA    9512… US      (408… (408…\n 9 1508635574 I      MP      14725 SE RHO… PORT… OR    9723… US      (971… (971…\n10 1932978905 I      MP      3801 KELL BL… WICH… TX    7630… US      (940… (940…\n# ℹ 22,873 more rows\n\n$O\n# A tibble: 5,839 × 10\n   npi        entity purpose address       city  state zip   country phone fax  \n   <chr>      <chr>  <chr>   <chr>         <chr> <chr> <chr> <chr>   <chr> <chr>\n 1 1548924087 O      MP      46 GRAMATAN … MOUN… NY    1055… US      (295… (646…\n 2 1205605342 O      MP      7610 CARROLL… TAKO… MD    2091… US      (301… (301…\n 3 1114796257 O      MP      6510 KENILWO… RIVE… MD    2073… US      (301… (301…\n 4 1902675945 O      MP      2585 PACIFIC… TORR… CA    9050… US      (424… (310…\n 5 1538938576 O      MP      10751 W ROWE… PEOR… AZ    8538… US      (623… (623…\n 6 1568231512 O      MP      1121 FIRECRA… JUST… TX    7624… US      (940… (940…\n 7 1912776964 O      MP      3760 CURTIS … COCOA FL    3292… US      (321… (321…\n 8 1306615364 O      MP      350 FAIRWAY … DEER… FL    3344… US      (877… (866…\n 9 1336918390 O      MP      240 E GARRIS… GAST… NC    2805… US      (980… (980…\n10 1649049610 O      MP      6751 N SUNSE… GLEN… AZ    8530… US      (775… (702…\n# ℹ 5,829 more rows\n```\n\n\n:::\n:::\n\n\n\n\n## Taxonomy\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nw241_tax <- join(\n  wk_2024_01_01$taxonomy[c(\"npi\", \"taxonomy_code\", \"taxonomy_group\", \"taxonomy_primary\")], \n  w241_base[c(\"npi\", \"entity\")], \n  on = \"npi\", \n  verbose = 0) |> \n  fsubset(npi %!in% w241_deact$npi) |> \n  fmutate(\n    level = fcase(\n      taxonomy_primary == \"Y\", \"Primary\",\n      taxonomy_primary == \"N\", \"Other\",\n      taxonomy_primary == \"X\", \"X\"),\n    taxonomy_primary = NULL)\n\nw241_tax <- rowbind(\n  w241_tax |> \n  fsubset(!not_na(taxonomy_group)) |> \n  fselect(-taxonomy_group) |> \n  distinct(),\n  w241_tax |> \n  fsubset(not_na(taxonomy_group)) |> \n  fselect(-taxonomy_code, -level) |> \n  distinct() |> \n  frename(taxonomy_code = taxonomy_group) |> \n  fmutate(level = \"Group\"))\n\ntax_g <- GRP(w241_tax, ~ entity)\n\nw241_tax <- rsplit(w241_tax, tax_g) |> \n  map(remove_quiet) |> \n  setNames(GRPnames(tax_g))\n\nw241_tax\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$I\n# A tibble: 20,828 × 4\n   npi        taxonomy_code entity level  \n   <chr>      <chr>         <chr>  <chr>  \n 1 1003009861 207RC0000X    I      Primary\n 2 1003013137 363AM0700X    I      Primary\n 3 1003013137 363AM0700X    I      Other  \n 4 1003018060 106H00000X    I      Primary\n 5 1003047531 207L00000X    I      Primary\n 6 1003047531 390200000X    I      Other  \n 7 1003047531 207L00000X    I      Other  \n 8 1003052903 2084P0800X    I      Primary\n 9 1003063173 208G00000X    I      Primary\n10 1003063173 208G00000X    I      Other  \n# ℹ 20,818 more rows\n\n$O\n# A tibble: 5,433 × 4\n   npi        taxonomy_code entity level  \n   <chr>      <chr>         <chr>  <chr>  \n 1 1003096488 261Q00000X    O      Primary\n 2 1003196072 3416L0300X    O      Primary\n 3 1003200874 253Z00000X    O      Primary\n 4 1003200874 251E00000X    O      Other  \n 5 1003330226 251E00000X    O      Primary\n 6 1003330226 251J00000X    O      Other  \n 7 1003337734 324500000X    O      Primary\n 8 1003407230 261QM1300X    O      Primary\n 9 1003407230 251E00000X    O      Other  \n10 1003463092 333600000X    O      Primary\n# ℹ 5,423 more rows\n```\n\n\n:::\n:::\n\n\n\n\n\n### Duplicates\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nw241_tax$O |> \n  mutate(N = n(), .by = npi) |> \n  filter(N == 2) |> \n  mutate(eq = taxonomy_code == flag(taxonomy_code), .by = npi) |> \n  filter(eq)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 21 × 6\n   npi        taxonomy_code entity level     N eq   \n   <chr>      <chr>         <chr>  <chr> <int> <lgl>\n 1 1093182198 324500000X    O      Other     2 TRUE \n 2 1194812784 332B00000X    O      Other     2 TRUE \n 3 1235225210 251E00000X    O      Other     2 TRUE \n 4 1336114131 3416L0300X    O      Other     2 TRUE \n 5 1376554865 332B00000X    O      Other     2 TRUE \n 6 1396804225 324500000X    O      Other     2 TRUE \n 7 1396867578 3336C0002X    O      Other     2 TRUE \n 8 1427298140 261QP2000X    O      Other     2 TRUE \n 9 1457587222 251E00000X    O      Other     2 TRUE \n10 1467558668 332B00000X    O      Other     2 TRUE \n# ℹ 11 more rows\n```\n\n\n:::\n\n```{.r .cell-code}\nw241_tax$I |> \n  mutate(N = n(), .by = npi) |> \n  filter(N == 2) |> \n  mutate(eq = taxonomy_code == flag(taxonomy_code), .by = npi) |> \n  filter(eq)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1,135 × 6\n   npi        taxonomy_code entity level     N eq   \n   <chr>      <chr>         <chr>  <chr> <int> <lgl>\n 1 1003013137 363AM0700X    I      Other     2 TRUE \n 2 1003063173 208G00000X    I      Other     2 TRUE \n 3 1003122698 2085R0202X    I      Other     2 TRUE \n 4 1003182908 207ZP0101X    I      Other     2 TRUE \n 5 1003202565 207ZP0102X    I      Other     2 TRUE \n 6 1003249749 207L00000X    I      Other     2 TRUE \n 7 1003443680 207W00000X    I      Other     2 TRUE \n 8 1003461666 152W00000X    I      Other     2 TRUE \n 9 1003561242 111N00000X    I      Other     2 TRUE \n10 1003859794 363LF0000X    I      Other     2 TRUE \n# ℹ 1,125 more rows\n```\n\n\n:::\n:::\n\n\n\n\n## License\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nw241_lic <- join(\n  wk_2024_01_01$taxonomy[c(\"npi\", \"license_number\", \"license_state\")], \n  w241_base[c(\"npi\", \"entity\")], \n  on = \"npi\", \n  verbose = 0) |> \n  fsubset(npi %!in% w241_deact$npi)\n\nlic_g <- GRP(w241_lic, ~ entity)\n\nw241_lic <- rsplit(w241_lic, lic_g) |> \n  map(\\(df) remove_quiet(df) |> filter(not_na(license_number))) |> \n  setNames(GRPnames(lic_g))\n\nw241_lic\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$I\n# A tibble: 15,565 × 4\n   npi        license_number license_state entity\n   <chr>      <chr>          <chr>         <chr> \n 1 1003009861 45263          AZ            I     \n 2 1003013137 4354           WI            I     \n 3 1003018060 959            NV            I     \n 4 1003047531 116063         CA            I     \n 5 1003047531 30135          OK            I     \n 6 1003047531 MD60681697     WA            I     \n 7 1003052903 087968         NY            I     \n 8 1003063173 5499           OK            I     \n 9 1003063173 036.143737     IL            I     \n10 1003063173 007606         AZ            I     \n# ℹ 15,555 more rows\n\n$O\n# A tibble: 592 × 4\n   npi        license_number license_state entity\n   <chr>      <chr>          <chr>         <chr> \n 1 1003096488 12-296         MS            O     \n 2 1003196072 23-255         OH            O     \n 3 1003199829 10000          ND            O     \n 4 1003200874 HHA201205      NE            O     \n 5 1013007475 1673           WI            O     \n 6 1013069608 28RS00588100   NJ            O     \n 7 1013105568 H80CS06662     IN            O     \n 8 1013174127 X 05660-1      NY            O     \n 9 1013214089 230304         NY            O     \n10 1013995521 1038           WI            O     \n# ℹ 582 more rows\n```\n\n\n:::\n:::\n\n\n\n\n## Identifiers\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nw241_id <- join(\n  wk_2024_01_01$identifier, \n  w241_base[c(\"npi\", \"entity\")], \n  on = \"npi\", \n  verbose = 0) |> \n  fsubset(npi %!in% w241_deact$npi) |> \n  # Remove Taxonomy Codes\n  fsubset(sf_ndetect(other_id, \"^[A-Z0-9]{9}X$\"))\n\nid_g <- GRP(w241_id, ~ entity)\n\nrsplit(w241_id, id_g) |> \n  map(remove_quiet) |> \n  setNames(GRPnames(id_g))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$I\n# A tibble: 3,052 × 6\n   npi        other_id   other_id_code other_id_state other_id_issuer     entity\n   <chr>      <chr>      <chr>         <chr>          <chr>               <chr> \n 1 1003685140 3496       01            NH             STATE OF NEW HAMPS… I     \n 2 1134998198 1194322628 05            MI             <NA>                I     \n 3 1578544367 10007752   05            TX             <NA>                I     \n 4 1578544367 152031401  05            TX             <NA>                I     \n 5 1578544367 152028001  05            TX             <NA>                I     \n 6 1316936222 4160095    01            TN             BLUE CROSS          I     \n 7 1316936222 1053635    05            LA             <NA>                I     \n 8 1316936222 087281     05            AZ             <NA>                I     \n 9 1316936222 3000540    05            TN             <NA>                I     \n10 1316936222 P00444174  01            <NA>           MEDICARE RAILROAD   I     \n# ℹ 3,042 more rows\n\n$O\n# A tibble: 1,314 × 6\n   npi        other_id   other_id_code other_id_state other_id_issuer     entity\n   <chr>      <chr>      <chr>         <chr>          <chr>               <chr> \n 1 1417726456 0155098    05            OH             <NA>                O     \n 2 1225765241 U5083      01            TX             TEXAS MEDICAL LICE… O     \n 3 1689443665 1417266396 05            NY             <NA>                O     \n 4 1255611539 014469     01            TX             TEXAS HCSSA LICENSE O     \n 5 1508824574 890596700  05            FL             <NA>                O     \n 6 1750958104 1386940575 05            WI             <NA>                O     \n 7 1982294732 250000218  05            NV             <NA>                O     \n 8 1891209284 U300404468 01            RI             MEDICARE PTAN       O     \n 9 1730729385 1952817926 01            <NA>           ORGANIZATIONAL NPI  O     \n10 1730729385 1043526098 01            <NA>           NPI                 O     \n# ℹ 1,304 more rows\n```\n\n\n:::\n:::\n\n\n\n\n## Other\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nw241_oth <- join(\n  wk_2024_01_01$other, \n  w241_base[c(\"npi\", \"entity\")], \n  on = \"npi\", \n  verbose = 0) |> \n  fsubset(npi %!in% w241_deact$npi) |> \n  fcompute(\n    npi = npi,\n    entity = entity,\n    ao_prefix = sf_remove(ao_prefix, \"\\\\.\"),\n    ao_first_name = sf_remove(ao_first, \"\\\\.\"),\n    ao_middle_name = sf_remove(ao_middle, \"\\\\.\"),\n    ao_last_name = sf_remove(ao_last, \"\\\\.\"),\n    ao_suffix = sf_remove(ao_suffix, \"\\\\.\"),\n    ao_credential = sf_remove(ao_credential, \"\\\\.\"),\n    ao_title = sf_remove(ao_title, \"\\\\.\"),\n    ao_phone = map_chr(ao_phone, \\(x) if (not_na(x)) str_glue(\"({substr(x, 1, 3)}) {substr(x, 4, 6)}-{substr(x, 7, 10)}\") else x)\n  )\n```\n\n::: {.cell-output .cell-output-error}\n\n```\nError in eval(substitute(list(...)), .data, parent.frame()): object 'ao_prefix' not found\n```\n\n\n:::\n\n```{.r .cell-code}\noth_g <- GRP(w241_oth, ~ entity)\n```\n\n::: {.cell-output .cell-output-error}\n\n```\nError: object 'w241_oth' not found\n```\n\n\n:::\n\n```{.r .cell-code}\nw241_oth <- rsplit(w241_oth, oth_g) |> \n  map(remove_quiet) |> \n  setNames(GRPnames(oth_g))\n```\n\n::: {.cell-output .cell-output-error}\n\n```\nError: object 'oth_g' not found\n```\n\n\n:::\n\n```{.r .cell-code}\nw241_oth$I <- vctrs::vec_slice(w241_oth$I, cheapr::row_na_counts(w241_oth$I) < 6)\n```\n\n::: {.cell-output .cell-output-error}\n\n```\nError: object 'w241_oth' not found\n```\n\n\n:::\n\n```{.r .cell-code}\nw241_oth\n```\n\n::: {.cell-output .cell-output-error}\n\n```\nError: object 'w241_oth' not found\n```\n\n\n:::\n:::\n\n\n\n\n## Authorized\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nw241_ao <- join(\n  wk_2024_01_01$authorized, \n  w241_base[c(\"npi\", \"entity\")], \n  on = \"npi\", \n  verbose = 0) |> \n  fsubset(npi %!in% w241_deact$npi) |> \n  fcompute(\n    npi = npi,\n    entity = entity,\n    ao_prefix = sf_remove(ao_prefix, \"\\\\.\"),\n    ao_first_name = sf_remove(ao_first, \"\\\\.\"),\n    ao_middle_name = sf_remove(ao_middle, \"\\\\.\"),\n    ao_last_name = sf_remove(ao_last, \"\\\\.\"),\n    ao_suffix = sf_remove(ao_suffix, \"\\\\.\"),\n    ao_credential = sf_remove(ao_credential, \"\\\\.\"),\n    ao_title = sf_remove(ao_title, \"\\\\.\"),\n    ao_phone = map_chr(ao_phone, \\(x) if (not_na(x)) str_glue(\"({substr(x, 1, 3)}) {substr(x, 4, 6)}-{substr(x, 7, 10)}\") else x)\n  )\n\nw241_ao\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3,917 × 10\n   npi      entity ao_prefix ao_first_name ao_middle_name ao_last_name ao_suffix\n * <chr>    <chr>  <chr>     <chr>         <chr>          <chr>        <chr>    \n 1 1952724… O      <NA>      MICHELE       <NA>           WHITE        <NA>     \n 2 1548924… O      <NA>      TANESHA       <NA>           MORGAN       <NA>     \n 3 1295504… O      <NA>      KENDRA        <NA>           TAYLOR       <NA>     \n 4 1386413… O      <NA>      MELISSA       <NA>           DELLA FEMINA <NA>     \n 5 1558130… O      MRS       MALYNDI       R              WEST         <NA>     \n 6 1821867… O      <NA>      AURORA        CANE           HOYLE        <NA>     \n 7 1649049… O      DR        ASMITA        <NA>           PATEL        <NA>     \n 8 1275302… O      MR        RANGANARAYAN  <NA>           NARASIMHAN   <NA>     \n 9 1356110… O      DR        AKRAM         <NA>           ABD EL KADER <NA>     \n10 1508635… O      <NA>      JAYSON        <NA>           ROWLAND      <NA>     \n# ℹ 3,907 more rows\n# ℹ 3 more variables: ao_credential <chr>, ao_title <chr>, ao_phone <chr>\n```\n\n\n:::\n:::\n\n\n\n\n<hr>\n\n\n\n\n{{< pagebreak >}}\n\n\n\n\n\n\n\n## Session Information \n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n**R version 4.4.2 (2024-10-31 ucrt)**\n\n**Platform:** x86_64-w64-mingw32/x64 \n\n**locale:**\n_LC_COLLATE=English_United States.utf8_, _LC_CTYPE=English_United States.utf8_, _LC_MONETARY=English_United States.utf8_, _LC_NUMERIC=C_ and _LC_TIME=English_United States.utf8_\n\n**attached base packages:** \n_stats_, _graphics_, _grDevices_, _utils_, _datasets_, _methods_ and _base_\n\n**other attached packages:** \n_hacksaw(v.0.0.2)_, _nppez(v.0.0.1)_, _codex(v.0.0.1)_, _fuimus(v.0.0.2)_, _collapse(v.2.0.17)_, _data.table(v.1.16.99)_, _lubridate(v.1.9.3)_, _forcats(v.1.0.0)_, _stringr(v.1.5.1)_, _dplyr(v.1.1.4)_, _purrr(v.1.0.2)_, _readr(v.2.1.5)_, _tidyr(v.1.3.1)_, _tibble(v.3.2.1)_, _ggplot2(v.3.5.1)_ and _tidyverse(v.2.0.0)_\n\n**loaded via a namespace (and not attached):** \n_rappdirs(v.0.3.3)_, _utf8(v.1.2.4)_, _generics(v.0.1.3)_, _stringi(v.1.8.4)_, _hms(v.1.1.3)_, _digest(v.0.6.37)_, _magrittr(v.2.0.3)_, _evaluate(v.1.0.1)_, _grid(v.4.4.2)_, _timechange(v.0.3.0)_, _fastmap(v.1.2.0)_, _jsonlite(v.1.8.9)_, _pins(v.1.4.0)_, _pander(v.0.6.5)_, _fansi(v.1.0.6)_, _scales(v.1.3.0)_, _textshaping(v.0.4.0)_, _RApiSerialize(v.0.1.4)_, _cli(v.3.6.3)_, _rlang(v.1.1.4)_, _munsell(v.0.5.1)_, _withr(v.3.0.2)_, _yaml(v.2.3.10)_, _qs(v.0.27.2)_, _tools(v.4.4.2)_, _parallel(v.4.4.2)_, _tzdb(v.0.4.0)_, _zeallot(v.0.1.0)_, _colorspace(v.2.1-1)_, _vctrs(v.0.6.5)_, _R6(v.2.5.1)_, _lifecycle(v.1.0.4)_, _snakecase(v.0.11.1)_, _cheapr(v.0.9.91)_, _stringfish(v.0.16.0)_, _fs(v.1.6.5)_, _htmlwidgets(v.1.6.4)_, _janitor(v.2.2.0)_, _ragg(v.1.3.3)_, _pkgconfig(v.2.0.3)_, _RcppParallel(v.5.1.9)_, _pillar(v.1.9.0)_, _gtable(v.0.3.6)_, _glue(v.1.8.0)_, _Rcpp(v.1.0.13-1)_, _systemfonts(v.1.1.0)_, _xfun(v.0.49)_, _tidyselect(v.1.2.1)_, _rstudioapi(v.0.17.1)_, _knitr(v.1.49)_, _htmltools(v.0.5.8.1)_, _rmarkdown(v.2.29)_ and _compiler(v.4.4.2)_\n:::\n:::\n",
    "supporting": [
      "nppes_archives_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}