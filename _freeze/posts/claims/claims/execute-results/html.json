{
  "hash": "4fd7e564b988cd3bfadc0122b30bf530",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Audit Workflow\"\nformat:\n  html:\n    reference-location: block\neditor_options: \n  chunk_output_type: console\n---\n\n::: {.cell}\n\n:::\n\n# Findings\n\nBetween the dates of **2022-06-14** and **2024-03-12** *(approx 637 days)*,\n\n   - 512 Dates of Service were recorded\n   - 7158 Unique Patients were seen\n   - Referred by 232 different Providers\n   - Seen by 66 different Rendering Providers\n\n# EDA\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nappt <- claims |> \n  select(dos, ptid, .enc) |> \n  distinct() |> \n  mutate(year = year(dos), \n         month = month(dos, label = TRUE, abbr = TRUE), \n         year_month = data.table::yearmon(dos)) |>\n  summarise(\n    appointments = n(),\n    patients = n_distinct(ptid),\n    new_patients = sum(.enc == 1),\n    .by = c(year, month, year_month))\n\nmd_title <- \"# {.orange Appointments}, {.dodgerblue Patients}, & {.red New Patients}\"\n\n# \"For _Dates of Service_: 2022-06-14 to 2024-03-12\"\n\nggplot(appt, aes(x = year_month)) + \n  geom_hline(yintercept = 0, color = \"grey60\", alpha = 1/1.25) +\n  geom_line(aes(y = appointments), colour = \"orange\", linewidth = 1.75, alpha = 1/1.25) +\n  geom_line(aes(y = patients), colour = \"dodgerblue\", linewidth = 1.75, alpha = 1/1.25) +\n  geom_line(aes(y = new_patients), colour = \"red\", linewidth = 1.75, alpha = 1/1.25) +\n  geom_point(aes(y = appointments), color = \"#E87800\", shape = 21, fill = \"grey80\", size = 2.5, stroke = 1.2) +\n  geom_point(aes(y = patients), color = \"#E87800\", shape = 21, fill = \"grey80\", size = 2.5, stroke = 1.2) +\n  geom_point(aes(y = new_patients), color = \"#E87800\", shape = 21, fill = \"grey80\", size = 2.5, stroke = 1.2) +\n  geom_rug(aes(y = appointments), colour = \"orange\", alpha = 1/3, outside = FALSE) +\n  geom_rug(aes(y = patients), colour = \"dodgerblue\", alpha = 1/3, outside = FALSE) +\n  geom_rug(aes(y = new_patients), colour = \"red\", alpha = 1/3, outside = FALSE) +\n  gg_theme() +\n  ggtitle(md_title) +\n  theme(plot.title = element_marquee(size = 9, width = 1),\n        panel.grid.minor = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid = element_blank())\n```\n\n::: {.cell-output-display}\n![](claims_files/figure-html/appt-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nclaims |> \n  select(dos, ptid) |> \n  distinct() |> \n  mutate(year = year(dos),\n         month = month(dos, label = TRUE, abbr = TRUE),\n         ymon = data.table::yearmon(dos)) |>\n  group_by(year) |>\n  dplyr::count(month, dos) |>\n  ggplot(aes(dos, n)) + \n  geom_line(color = \"grey70\") +\n  geom_hline(yintercept = 0, color = \"grey40\") +\n  geom_point(color = \"#E87800\", shape = 21, fill = \"grey80\", size = 2.5, stroke = 1.2) +\n  geom_rug(alpha = 1/2.5, color = \"#E87800\", outside = FALSE) +\n  gg_theme() +\n  labs(x = NULL, y = NULL) +\n  facet_wrap(vars(year), \n             scales = \"free_x\", \n             dir = \"h\", \n             nrow = 3, \n             strip.position = \"left\",\n             labeller = \"label_both\") +\n  theme(\n    panel.grid.minor = element_blank(),\n    panel.grid.major = element_blank(),\n    panel.grid = element_blank())\n```\n\n::: {.cell-output-display}\n![](claims_files/figure-html/unnamed-chunk-3-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nclaims |> \n  select(dos, ptid, pos_type, render) |> \n  distinct() |> \n  mutate(year = lubridate::year(dos),\n         month = lubridate::month(dos, label = TRUE, abbr = TRUE),\n         ymon = data.table::yearmon(dos)) |>\n  dplyr::group_by(year) |>\n  dplyr::count(dos) |>\n  dplyr::ungroup() |> \n  ggTimeSeries::ggplot_calendar_heatmap(\"dos\", \"n\",\n  monthBorderLineEnd = \"square\",\n  dayBorderColour = \"white\",\n  monthBorderSize = 1,\n  monthBorderColour = \"white\") +\n  labs(x = NULL, y = NULL) +\n  facet_wrap(~Year, ncol = 1, nrow = 3) +\n  scale_fill_gradient(na.value = \"grey95\") +\n  gg_theme() +\n  theme(\n    panel.grid.minor = element_blank(),\n    panel.grid.major = element_blank(),\n    panel.grid = element_blank())\n```\n\n::: {.cell-output-display}\n![](claims_files/figure-html/ggcal-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# claims\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(ggdark)\nlibrary(hrbrthemes)\n\nraw <- tibble::tribble(\n    ~BEACON, ~DRAPER, ~FILMORE, ~LAKESIDE, ~MARE.VALLEY, ~NORTH, ~OAKLEY, ~ORLY, ~PIERCE, ~ROSEDALE, ~SEALY, ~SOUTHLAKE, ~WESTLAKE, ~WILDLAND, ~REGIONAL.AVG, \n    69L, 130L, 85L, 117L, 16L, 74L, 61L, 51L, 35L, 65L, 93L, 72L, 83L, 83L, 74L, \n    77L, 86L, 97L, 107L, 17L, 71L, 55L, 61L, 32L, 55L, 89L, 64L, 73L, 79L, 69L, \n    63L, 90L, 92L, 127L, 18L, 68L, 55L, 67L, 32L, 59L, 79L, 58L, 73L, 81L, 69L, \n    61L, 100L, 95L, 132L, 21L, 72L, 72L, 51L, 49L, 53L, 82L, 77L, 85L, 75L, 73L, \n    67L, 106L, 92L, 145L, 21L, 69L, 79L, 51L, 49L, 59L, 94L, 87L, 87L, 79L, 78L, \n    67L, 91L, 83L, 112L, 17L, 71L, 60L, 66L, 42L, 52L, 83L, 70L, 54L, 72L, 67L, \n    57L, 89L, 103L, 107L, 17L, 56L, 42L, 52L, 23L, 41L, 84L, 66L, 59L, 51L, 61L, \n    62L, 87L, 109L, 95L, 17L, 66L, 44L, 60L, 48L, 37L, 81L, 59L, 64L, 46L, 63L, \n    68L, 93L, 94L, 126L, 21L, 83L, 65L, 66L, 38L, 63L, 89L, 66L, 59L, 66L, 71L, \n    61L, 96L, 104L, 133L, 13L, 79L, 80L, 47L, 24L, 49L, 70L, 65L, 68L, 57L, 68L, \n    54L, 103L, 88L, 105L, 22L, 66L, 37L, 63L, 26L, 52L, 66L, 55L, 51L, 69L, 61L) |> \n    mutate(quart = c(\"2017 Q1\", \"2017 Q2\", \"2017 Q3\", \"2017 Q4\", \"2018 Q1\", \"2018 Q2\", \"2018 Q3\", \"2018 Q4\", \"2019 Q1\", \"2019 Q2\", \"2019 Q3\"))\n\n# separate out the regional average\ndf_reg <- raw |> transmute(quart, reg_avg = REGIONAL.AVG)\n\ndf <- raw |> \n    select(-REGIONAL.AVG) |> \n    pivot_longer(BEACON:WILDLAND, \n                 names_to = \"dealer\") |> \n    group_by(dealer) |> \n    mutate(avg_sales = mean(value)) |> \n    ungroup() |> \n    mutate(dealer = str_to_title(dealer) |> \n             str_replace(\".v\", \" v\") |> \n             as_factor() |> \n             fct_reorder(avg_sales) |> \n             fct_rev())\n\ndf_new <- df |> \n  mutate(new = dealer)\n\n# minimal labels\nquart_lab <- c(\"2017\", \"\", \"\", \"\", \"18\", \"\", \"\", \"\", \"19\", \"\", \"\")\n\n# plot\ndf_new |> \n    ggplot(aes(quart, value)) +\n    geom_hline(yintercept = 0) +\n    geom_path(\n        data = select(df_new, -dealer),\n        aes(group = new),\n        color = \"#ababab\",\n        linewidth = .5,\n        alpha = .25) +\n    geom_path(\n        data = df_reg, \n        aes(y = reg_avg, group = 1),\n        size = .5, \n        color = \"gold\") +\n    geom_path(aes(group = dealer), size = 1) +\n    facet_wrap(~ dealer, ncol = 5) +\n    scale_x_discrete(labels = quart_lab, \n                     expand = c(0, 0)) +\n    scale_y_continuous(sec.axis = dup_axis()) +\n    labs(title = \"Cars sold by dealership per quarter\",\n         caption = \"@ikashnitsky\",\n         x = NULL, \n         y = NULL) +\n    geom_text(\n        data = df_new |> filter(dealer == \"Mare valley\", quart == \"2019 Q3\") |> transmute(dealer, quart, value = 90),\n        label = \"Regional average\", \n        hjust = 1, \n        size = 3,\n        color = \"gold\", \n        family = font_rc) +\n    # dark_theme_minimal(base_family = font_rc) +\n    theme(\n        plot.title = element_text(family = \"Roboto Slab\", size = 20),\n        panel.spacing.x =  unit(1, \"lines\"), \n        panel.grid.minor = element_blank(),\n        panel.grid.major.x = element_line(linewidth = .25, color = \"#cdcdcd33\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](claims_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n# Reimbursement\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npprrvu\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 7,882 × 14\n   date_start date_end   hcpcs description      work_rvu pe_rvu mp_rvu rvu_total\n   <date>     <date>     <chr> <chr>               <dbl>  <dbl>  <dbl>     <dbl>\n 1 2022-07-01 2022-09-30 96130 Psycl tst eval …     2.56   0.84   0.11      3.51\n 2 2022-07-01 2022-09-30 96131 Psycl tst eval …     1.96   0.56   0.09      2.61\n 3 2022-07-01 2022-09-30 96136 Psycl/nrpsyc ts…     0.55   0.71   0.04      1.3 \n 4 2022-07-01 2022-09-30 96137 Psycl/nrpsyc ts…     0.46   0.69   0.02      1.17\n 5 2022-07-01 2022-09-30 90837 Psytx w pt 60 m…     3.31   0.94   0.11      4.36\n 6 2022-07-01 2022-09-30 90834 Psytx w pt 45 m…     2.24   0.64   0.09      2.97\n 7 2022-07-01 2022-09-30 90792 Psych diag eval…     4.16   1.46   0.17      5.79\n 8 2022-07-01 2022-09-30 80305 Drug test prsmv…     0      0      0         0   \n 9 2022-07-01 2022-09-30 90834 Psytx w pt 45 m…     2.24   0.64   0.09      2.97\n10 2022-07-01 2022-09-30 99214 Office o/p est …     1.92   1.71   0.12      3.75\n# ℹ 7,872 more rows\n# ℹ 6 more variables: conv_factor <dbl>, pctc_ind <chr>, glob_days <chr>,\n#   mult_proc <chr>, dos <date>, pos <chr>\n```\n\n\n:::\n:::\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n{{< pagebreak >}}\n\n\n## Session Information \n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n**R version 4.4.2 (2024-10-31 ucrt)**\n\n**Platform:** x86_64-w64-mingw32/x64 \n\n**locale:**\n_LC_COLLATE=English_United States.utf8_, _LC_CTYPE=English_United States.utf8_, _LC_MONETARY=English_United States.utf8_, _LC_NUMERIC=C_ and _LC_TIME=English_United States.utf8_\n\n**attached base packages:** \n_stats_, _graphics_, _grDevices_, _utils_, _datasets_, _methods_ and _base_\n\n**other attached packages:** \n_hrbrthemes(v.0.8.7)_, _ggdark(v.0.2.1)_, _marquee(v.0.1.0)_, _fuimus(v.0.0.5.9009)_, _northstar(v.0.0.8)_, _arkrvu(v.0.0.1.9002)_, _gt(v.0.11.1.9000)_, _here(v.1.0.1)_, _lubridate(v.1.9.4)_, _forcats(v.1.0.0)_, _stringr(v.1.5.1)_, _dplyr(v.1.1.4)_, _purrr(v.1.0.2)_, _readr(v.2.1.5)_, _tidyr(v.1.3.1.9000)_, _tibble(v.3.2.1)_, _ggplot2(v.3.5.1)_ and _tidyverse(v.2.0.0)_\n\n**loaded via a namespace (and not attached):** \n_gtable(v.0.3.6)_, _xfun(v.0.50)_, _htmlwidgets(v.1.6.4)_, _collapse(v.2.0.19)_, _RApiSerialize(v.0.1.4)_, _tzdb(v.0.4.0)_, _vctrs(v.0.6.5)_, _tools(v.4.4.2)_, _generics(v.0.1.3)_, _parallel(v.4.4.2)_, _pkgconfig(v.2.0.3)_, _data.table(v.1.16.99)_, _RcppParallel(v.5.1.9)_, _lifecycle(v.1.0.4)_, _farver(v.2.1.2)_, _compiler(v.4.4.2)_, _textshaping(v.0.4.1)_, _munsell(v.0.5.1)_, _janitor(v.2.2.1)_, _qs(v.0.27.2)_, _snakecase(v.0.11.1)_, _fontLiberation(v.0.1.0)_, _fontquiver(v.0.2.1)_, _htmltools(v.0.5.8.1)_, _yaml(v.2.3.10)_, _Rttf2pt1(v.1.3.12)_, _extrafontdb(v.1.0)_, _pillar(v.1.10.1)_, _crayon(v.1.5.3)_, _fontBitstreamVera(v.0.1.1)_, _tidyselect(v.1.2.1)_, _digest(v.0.6.37)_, _stringi(v.1.8.4)_, _pander(v.0.6.5)_, _labeling(v.0.4.3)_, _pins(v.1.4.0)_, _extrafont(v.0.19)_, _rprojroot(v.2.0.4)_, _fastmap(v.1.2.0)_, _grid(v.4.4.2)_, _archive(v.1.1.10)_, _colorspace(v.2.1-1)_, _cli(v.3.6.3.9001)_, _magrittr(v.2.0.3)_, _utf8(v.1.2.4)_, _withr(v.3.0.2)_, _gdtools(v.0.4.1)_, _scales(v.1.3.0)_, _rappdirs(v.0.3.3)_, _bit64(v.4.5.2)_, _timechange(v.0.3.0)_, _rmarkdown(v.2.29)_, _ggTimeSeries(v.1.0.2)_, _bit(v.4.5.0.1)_, _ragg(v.1.3.3)_, _hms(v.1.1.3)_, _stringfish(v.0.16.0)_, _evaluate(v.1.0.3)_, _knitr(v.1.49)_, _rlang(v.1.1.4)_, _Rcpp(v.1.0.14)_, _zeallot(v.0.1.0)_, _glue(v.1.8.0)_, _xml2(v.1.3.6)_, _rstudioapi(v.0.17.1)_, _vroom(v.1.6.5)_, _jsonlite(v.1.8.9)_, _R6(v.2.5.1)_, _systemfonts(v.1.1.0)_ and _fs(v.1.6.5)_\n:::\n:::\n",
    "supporting": [
      "claims_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}