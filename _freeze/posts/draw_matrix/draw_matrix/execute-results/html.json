{
  "hash": "47d05c127007c27b2a01ac67bfef5173",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Medical Codes as Matrices\"\nformat:\n  html:\n    reference-location: block\neditor_options: \n  chunk_output_type: console\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::opts_chunk$set(\n  dev = \"ragg_png\",\n  dpi = 320,\n  out.width = \"100%\",\n  fig.width = 8,\n  fig.asp = 0.818,\n  fig.retina = 2,\n  fig.align = \"center\",\n  fig.show = \"hold\"\n)\noptions(scipen = 999)\n\nlibrary(tidyverse)\nlibrary(rlang)\nlibrary(stringfish)\nlibrary(ggthemes)\nlibrary(paintr)\nlibrary(fuimus)\n# library(procedural)\n# library(northstar)\n```\n:::\n\n\n\n\n# Coding Terminologies\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npcs <- lst(\n  c = c(0:9, grep(\"[^IO]\", LETTERS, value = TRUE)),\n  p = seq2_along(1, c),\n  a = 1:7)\n\npcs\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$c\n [1] \"0\" \"1\" \"2\" \"3\" \"4\" \"5\" \"6\" \"7\" \"8\" \"9\" \"A\" \"B\" \"C\" \"D\" \"E\" \"F\" \"G\" \"H\" \"J\"\n[20] \"K\" \"L\" \"M\" \"N\" \"P\" \"Q\" \"R\" \"S\" \"T\" \"U\" \"V\" \"W\" \"X\" \"Y\" \"Z\"\n\n$p\n [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25\n[26] 26 27 28 29 30 31 32 33 34\n\n$a\n[1] 1 2 3 4 5 6 7\n```\n\n\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhcpcs <- lst(\n  c = c(0:9, grep(\"[^DINOW-Z]\", LETTERS, value = TRUE)),\n  p = seq2_along(1, c),\n  a = 1:5)\n\nhcpcs\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$c\n [1] \"0\" \"1\" \"2\" \"3\" \"4\" \"5\" \"6\" \"7\" \"8\" \"9\" \"A\" \"B\" \"C\" \"E\" \"F\" \"G\" \"H\" \"J\" \"K\"\n[20] \"L\" \"M\" \"P\" \"Q\" \"R\" \"S\" \"T\" \"U\" \"V\"\n\n$p\n [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25\n[26] 26 27 28\n\n$a\n[1] 1 2 3 4 5\n```\n\n\n:::\n:::\n\n\n\n\n## Lookup\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlook <- \\(code, system) {\n  \n  constants <- system$c\n  possible  <- system$p\n  \n  names(possible) <- constants\n  \n  unname(possible[splitter(sf_toupper(code))])\n}\n\nlook(\"0G9000Z\", pcs)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1]  1 17 10  1  1  1 34\n```\n\n\n:::\n\n```{.r .cell-code}\nlook(\"99213\", hcpcs)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 10 10  3  2  4\n```\n\n\n:::\n:::\n\n\n\n\n## Make Matrix\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmedtrix <- \\(code, system) {\n  \n  constants <- system$c\n  possible  <- system$p\n  axis      <- system$a\n  \n  m <- matrix(data     = 0L,\n              nrow     = length(constants),\n              ncol     = length(axis),\n              dimnames = list(constants, axis))\n  \n  x <- look(code, system)\n  \n  for (i in axis) { \n    m[x[i], i] <- 1L \n    }\n  \n  return(m)\n}\n```\n:::\n\n\n\n\n**ICD-10-PCS:**\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmedtrix(code = \"0G9000Z\", system = pcs)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  1 2 3 4 5 6 7\n0 1 0 0 1 1 1 0\n1 0 0 0 0 0 0 0\n2 0 0 0 0 0 0 0\n3 0 0 0 0 0 0 0\n4 0 0 0 0 0 0 0\n5 0 0 0 0 0 0 0\n6 0 0 0 0 0 0 0\n7 0 0 0 0 0 0 0\n8 0 0 0 0 0 0 0\n9 0 0 1 0 0 0 0\nA 0 0 0 0 0 0 0\nB 0 0 0 0 0 0 0\nC 0 0 0 0 0 0 0\nD 0 0 0 0 0 0 0\nE 0 0 0 0 0 0 0\nF 0 0 0 0 0 0 0\nG 0 1 0 0 0 0 0\nH 0 0 0 0 0 0 0\nJ 0 0 0 0 0 0 0\nK 0 0 0 0 0 0 0\nL 0 0 0 0 0 0 0\nM 0 0 0 0 0 0 0\nN 0 0 0 0 0 0 0\nP 0 0 0 0 0 0 0\nQ 0 0 0 0 0 0 0\nR 0 0 0 0 0 0 0\nS 0 0 0 0 0 0 0\nT 0 0 0 0 0 0 0\nU 0 0 0 0 0 0 0\nV 0 0 0 0 0 0 0\nW 0 0 0 0 0 0 0\nX 0 0 0 0 0 0 0\nY 0 0 0 0 0 0 0\nZ 0 0 0 0 0 0 1\n```\n\n\n:::\n:::\n\n\n\n\n**HCPCS (CPT):**\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmedtrix(code = \"99213\", system = hcpcs)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  1 2 3 4 5\n0 0 0 0 0 0\n1 0 0 0 1 0\n2 0 0 1 0 0\n3 0 0 0 0 1\n4 0 0 0 0 0\n5 0 0 0 0 0\n6 0 0 0 0 0\n7 0 0 0 0 0\n8 0 0 0 0 0\n9 1 1 0 0 0\nA 0 0 0 0 0\nB 0 0 0 0 0\nC 0 0 0 0 0\nE 0 0 0 0 0\nF 0 0 0 0 0\nG 0 0 0 0 0\nH 0 0 0 0 0\nJ 0 0 0 0 0\nK 0 0 0 0 0\nL 0 0 0 0 0\nM 0 0 0 0 0\nP 0 0 0 0 0\nQ 0 0 0 0 0\nR 0 0 0 0 0\nS 0 0 0 0 0\nT 0 0 0 0 0\nU 0 0 0 0 0\nV 0 0 0 0 0\n```\n\n\n:::\n:::\n\n\n\n\n# Plot Matrix\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmpcs <- medtrix(code = \"0G9000Z\", system = pcs)\n\ngpaint_matrix(\n  mpcs, \n  highlight_area = mpcs == 1, \n  show_indices = \"none\",\n  graph_title = \"ICD-10-PCS Code 0G9000Z\"\n  ) + \n  theme_solid() + \n  ylim(rev(rownames(mpcs))) + \n  xlim(colnames(mpcs)) + \n  xlab(\"\") + \n  ylab(\"\") +\n  theme(\n    legend.position = \"none\",\n    axis.text.x = element_text(size = 11),\n    axis.text.y = element_text(size = 11),\n    axis.ticks.x = element_blank(),\n    axis.ticks.y = element_blank())\n```\n\n::: {.cell-output-display}\n![](draw_matrix_files/figure-html/unnamed-chunk-8-1.png){fig-align='center' width=100%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmhcpcs <- medtrix(code = \"99213\", system = hcpcs)\n\ngpaint_matrix(\n  mhcpcs, \n  highlight_area = mhcpcs == 1, \n  show_indices = \"none\",\n  graph_title = \"HCPCS Code 99213\") + \n  theme_solid() + \n  ylim(rev(rownames(mhcpcs))) + \n  xlim(colnames(mhcpcs)) + \n  xlab(\"\") + \n  ylab(\"\") +\n  theme(\n    legend.position = \"none\",\n    axis.text.x = element_text(size = 11),\n    axis.text.y = element_text(size = 11),\n    axis.ticks.x = element_blank(),\n    axis.ticks.y = element_blank())\n```\n\n::: {.cell-output-display}\n![](draw_matrix_files/figure-html/unnamed-chunk-9-1.png){fig-align='center' width=100%}\n:::\n:::\n\n{{< pagebreak >}}\n\n\n\n\n\n\n\n## Session Information \n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n**R version 4.4.1 (2024-06-14 ucrt)**\n\n**Platform:** x86_64-w64-mingw32/x64 \n\n**locale:**\n_LC_COLLATE=English_United States.utf8_, _LC_CTYPE=English_United States.utf8_, _LC_MONETARY=English_United States.utf8_, _LC_NUMERIC=C_ and _LC_TIME=English_United States.utf8_\n\n**attached base packages:** \n_stats_, _graphics_, _grDevices_, _utils_, _datasets_, _methods_ and _base_\n\n**other attached packages:** \n_fuimus(v.0.0.2)_, _paintr(v.0.0.1)_, _ggthemes(v.5.1.0)_, _stringfish(v.0.16.0)_, _rlang(v.1.1.4)_, _lubridate(v.1.9.3)_, _forcats(v.1.0.0)_, _stringr(v.1.5.1)_, _dplyr(v.1.1.4)_, _purrr(v.1.0.2)_, _readr(v.2.1.5)_, _tidyr(v.1.3.1)_, _tibble(v.3.2.1)_, _ggplot2(v.3.5.1)_ and _tidyverse(v.2.0.0)_\n\n**loaded via a namespace (and not attached):** \n_utf8(v.1.2.4)_, _generics(v.0.1.3)_, _stringi(v.1.8.4)_, _hms(v.1.1.3)_, _digest(v.0.6.37)_, _magrittr(v.2.0.3)_, _evaluate(v.1.0.1)_, _grid(v.4.4.1)_, _timechange(v.0.3.0)_, _fastmap(v.1.2.0)_, _jsonlite(v.1.8.9)_, _pander(v.0.6.5)_, _fansi(v.1.0.6)_, _scales(v.1.3.0)_, _textshaping(v.0.4.0)_, _cli(v.3.6.3)_, _munsell(v.0.5.1)_, _withr(v.3.0.2)_, _yaml(v.2.3.10)_, _tools(v.4.4.1)_, _tzdb(v.0.4.0)_, _colorspace(v.2.1-1)_, _vctrs(v.0.6.5)_, _R6(v.2.5.1)_, _lifecycle(v.1.0.4)_, _htmlwidgets(v.1.6.4)_, _ragg(v.1.3.3)_, _pkgconfig(v.2.0.3)_, _RcppParallel(v.5.1.9)_, _pillar(v.1.9.0)_, _gtable(v.0.3.6)_, _glue(v.1.8.0)_, _Rcpp(v.1.0.13)_, _systemfonts(v.1.1.0)_, _xfun(v.0.48)_, _tidyselect(v.1.2.1)_, _rstudioapi(v.0.17.1)_, _knitr(v.1.48)_, _farver(v.2.1.2)_, _htmltools(v.0.5.8.1)_, _rmarkdown(v.2.29)_ and _compiler(v.4.4.1)_\n:::\n:::\n",
    "supporting": [
      "draw_matrix_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}