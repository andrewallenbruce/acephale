{
  "hash": "72a59af9171b50afcb1577662ce0318a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Medical Codes as Matrices\"\nformat:\n  html:\n    reference-location: block\neditor_options: \n  chunk_output_type: console\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::opts_chunk$set(\n  dev = \"ragg_png\",\n  dpi = 320,\n  out.width = \"100%\",\n  fig.width = 8,\n  fig.asp = 0.818,\n  fig.retina = 2,\n  fig.align = \"center\",\n  fig.show = \"hold\"\n)\noptions(scipen = 999)\n\nlibrary(tidyverse)\nlibrary(rlang)\nlibrary(stringfish)\nlibrary(ggthemes)\nlibrary(paintr)\nlibrary(fuimus)\n# library(procedural)\n# library(northstar)\n```\n:::\n\n\n\n\n# Coding Terminologies\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npcs <- lst(\n  c = c(0:9, grep(\"[^IO]\", LETTERS, value = TRUE)),\n  p = seq2_along(1, c),\n  a = 1:7)\n\npcs\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$c\n [1] \"0\" \"1\" \"2\" \"3\" \"4\" \"5\" \"6\" \"7\" \"8\" \"9\" \"A\" \"B\" \"C\" \"D\" \"E\" \"F\" \"G\" \"H\" \"J\"\n[20] \"K\" \"L\" \"M\" \"N\" \"P\" \"Q\" \"R\" \"S\" \"T\" \"U\" \"V\" \"W\" \"X\" \"Y\" \"Z\"\n\n$p\n [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25\n[26] 26 27 28 29 30 31 32 33 34\n\n$a\n[1] 1 2 3 4 5 6 7\n```\n\n\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhcpcs <- lst(\n  c = c(0:9, grep(\"[^DINOW-Z]\", LETTERS, value = TRUE)),\n  p = seq2_along(1, c),\n  a = 1:5)\n\nhcpcs\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$c\n [1] \"0\" \"1\" \"2\" \"3\" \"4\" \"5\" \"6\" \"7\" \"8\" \"9\" \"A\" \"B\" \"C\" \"E\" \"F\" \"G\" \"H\" \"J\" \"K\"\n[20] \"L\" \"M\" \"P\" \"Q\" \"R\" \"S\" \"T\" \"U\" \"V\"\n\n$p\n [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25\n[26] 26 27 28\n\n$a\n[1] 1 2 3 4 5\n```\n\n\n:::\n:::\n\n\n\n\n## Lookup\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlook <- \\(code, system) {\n  \n  constants <- system$c\n  possible  <- system$p\n  \n  names(possible) <- constants\n  \n  unname(possible[splitter(sf_toupper(code))])\n}\n\nlook(\"0G9000Z\", pcs)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1]  1 17 10  1  1  1 34\n```\n\n\n:::\n\n```{.r .cell-code}\nlook(\"99213\", hcpcs)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 10 10  3  2  4\n```\n\n\n:::\n:::\n\n\n\n\n## Make Matrix\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmedtrix <- \\(code, system) {\n  \n  constants <- system$c\n  possible  <- system$p\n  axis      <- system$a\n  \n  m <- matrix(data     = 0L,\n              nrow     = length(constants),\n              ncol     = length(axis),\n              dimnames = list(constants, axis))\n  \n  x <- look(code, system)\n  \n  for (i in axis) { \n    m[x[i], i] <- 1L \n    }\n  \n  return(m)\n}\n```\n:::\n\n\n\n\n**ICD-10-PCS:**\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmedtrix(code = \"0G9000Z\", system = pcs)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  1 2 3 4 5 6 7\n0 1 0 0 1 1 1 0\n1 0 0 0 0 0 0 0\n2 0 0 0 0 0 0 0\n3 0 0 0 0 0 0 0\n4 0 0 0 0 0 0 0\n5 0 0 0 0 0 0 0\n6 0 0 0 0 0 0 0\n7 0 0 0 0 0 0 0\n8 0 0 0 0 0 0 0\n9 0 0 1 0 0 0 0\nA 0 0 0 0 0 0 0\nB 0 0 0 0 0 0 0\nC 0 0 0 0 0 0 0\nD 0 0 0 0 0 0 0\nE 0 0 0 0 0 0 0\nF 0 0 0 0 0 0 0\nG 0 1 0 0 0 0 0\nH 0 0 0 0 0 0 0\nJ 0 0 0 0 0 0 0\nK 0 0 0 0 0 0 0\nL 0 0 0 0 0 0 0\nM 0 0 0 0 0 0 0\nN 0 0 0 0 0 0 0\nP 0 0 0 0 0 0 0\nQ 0 0 0 0 0 0 0\nR 0 0 0 0 0 0 0\nS 0 0 0 0 0 0 0\nT 0 0 0 0 0 0 0\nU 0 0 0 0 0 0 0\nV 0 0 0 0 0 0 0\nW 0 0 0 0 0 0 0\nX 0 0 0 0 0 0 0\nY 0 0 0 0 0 0 0\nZ 0 0 0 0 0 0 1\n```\n\n\n:::\n:::\n\n\n\n\n**HCPCS (CPT):**\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmedtrix(code = \"99213\", system = hcpcs)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  1 2 3 4 5\n0 0 0 0 0 0\n1 0 0 0 1 0\n2 0 0 1 0 0\n3 0 0 0 0 1\n4 0 0 0 0 0\n5 0 0 0 0 0\n6 0 0 0 0 0\n7 0 0 0 0 0\n8 0 0 0 0 0\n9 1 1 0 0 0\nA 0 0 0 0 0\nB 0 0 0 0 0\nC 0 0 0 0 0\nE 0 0 0 0 0\nF 0 0 0 0 0\nG 0 0 0 0 0\nH 0 0 0 0 0\nJ 0 0 0 0 0\nK 0 0 0 0 0\nL 0 0 0 0 0\nM 0 0 0 0 0\nP 0 0 0 0 0\nQ 0 0 0 0 0\nR 0 0 0 0 0\nS 0 0 0 0 0\nT 0 0 0 0 0\nU 0 0 0 0 0\nV 0 0 0 0 0\n```\n\n\n:::\n:::\n\n\n\n\n# Plot Matrix\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmpcs <- medtrix(code = \"0G9000Z\", system = pcs)\n\ngpaint_matrix(\n  mpcs, \n  highlight_area = mpcs == 1, \n  show_indices = \"none\",\n  graph_title = \"ICD-10-PCS Code 0G9000Z\"\n  ) + \n  theme_solid() + \n  ylim(rev(rownames(mpcs))) + \n  xlim(colnames(mpcs)) + \n  xlab(\"\") + \n  ylab(\"\") +\n  theme(\n    legend.position = \"none\",\n    axis.text.x = element_text(size = 11),\n    axis.text.y = element_text(size = 11),\n    axis.ticks.x = element_blank(),\n    axis.ticks.y = element_blank())\n```\n\n::: {.cell-output-display}\n![](draw_matrix_files/figure-html/unnamed-chunk-8-1.png){fig-align='center' width=100%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmhcpcs <- medtrix(code = \"99213\", system = hcpcs)\n\ngpaint_matrix(\n  mhcpcs, \n  highlight_area = mhcpcs == 1, \n  show_indices = \"none\",\n  graph_title = \"HCPCS Code 99213\") + \n  theme_solid() + \n  ylim(rev(rownames(mhcpcs))) + \n  xlim(colnames(mhcpcs)) + \n  xlab(\"\") + \n  ylab(\"\") +\n  theme(\n    legend.position = \"none\",\n    axis.text.x = element_text(size = 11),\n    axis.text.y = element_text(size = 11),\n    axis.ticks.x = element_blank(),\n    axis.ticks.y = element_blank())\n```\n\n::: {.cell-output-display}\n![](draw_matrix_files/figure-html/unnamed-chunk-9-1.png){fig-align='center' width=100%}\n:::\n:::\n\n{{< pagebreak >}}\n\n\n\n\n\n\n\n# Session Information\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stdout}\n\n```\n═ Session info ═══════════════════════════════════════════════════════════════\n─ Packages ───────────────────────────────────────────────────────────────────\n ! package      * version date (UTC) lib source\n   cli            3.6.3   2024-06-21 [1] RSPM (R 4.4.0)\n   colorspace     2.1-1   2024-07-26 [1] RSPM (R 4.4.0)\n   digest         0.6.37  2024-08-19 [1] RSPM (R 4.4.0)\n   dplyr        * 1.1.4   2023-11-17 [1] RSPM (R 4.4.0)\n   evaluate       1.0.1   2024-10-10 [1] RSPM (R 4.4.0)\n   fansi          1.0.6   2023-12-08 [1] RSPM (R 4.4.0)\n   farver         2.1.2   2024-05-13 [1] RSPM (R 4.4.0)\n   fastmap        1.2.0   2024-05-15 [1] RSPM (R 4.4.0)\n   forcats      * 1.0.0   2023-01-29 [1] RSPM (R 4.4.0)\n   fuimus       * 0.0.2   2024-10-15 [1] local\n   generics       0.1.3   2022-07-05 [1] RSPM (R 4.4.0)\n   ggplot2      * 3.5.1   2024-04-23 [1] RSPM (R 4.4.0)\n   ggthemes     * 5.1.0   2024-02-10 [1] RSPM (R 4.4.0)\n   glue           1.8.0   2024-09-30 [1] RSPM (R 4.4.0)\n   gtable         0.3.5   2024-04-22 [1] RSPM (R 4.4.0)\n   hms            1.1.3   2023-03-21 [1] RSPM (R 4.4.0)\n   htmltools      0.5.8.1 2024-04-04 [1] RSPM (R 4.4.0)\n   htmlwidgets    1.6.4   2023-12-06 [1] RSPM (R 4.4.0)\n   jsonlite       1.8.9   2024-09-20 [1] RSPM (R 4.4.0)\n   knitr          1.48    2024-07-07 [1] CRAN (R 4.4.1)\n   lifecycle      1.0.4   2023-11-07 [1] RSPM (R 4.4.0)\n   lubridate    * 1.9.3   2023-09-27 [1] RSPM (R 4.4.0)\n   magrittr       2.0.3   2022-03-30 [1] RSPM (R 4.4.0)\n   munsell        0.5.1   2024-04-01 [1] RSPM (R 4.4.0)\n   paintr       * 0.0.1   2024-09-25 [1] Github (coatless-rpkg/paintr@075e925)\n   pillar         1.9.0   2023-03-22 [1] RSPM (R 4.4.0)\n   pkgconfig      2.0.3   2019-09-22 [1] RSPM (R 4.4.0)\n   purrr        * 1.0.2   2023-08-10 [1] RSPM (R 4.4.0)\n   R6             2.5.1   2021-08-19 [1] RSPM (R 4.4.0)\n   ragg           1.3.3   2024-09-11 [1] RSPM (R 4.4.0)\n   Rcpp           1.0.13  2024-07-17 [1] RSPM (R 4.4.0)\n D RcppParallel   5.1.9   2024-08-19 [1] RSPM (R 4.4.0)\n   readr        * 2.1.5   2024-01-10 [1] RSPM (R 4.4.0)\n   rlang        * 1.1.4   2024-06-04 [1] RSPM (R 4.4.0)\n   rmarkdown      2.28    2024-08-17 [1] CRAN (R 4.4.1)\n   rstudioapi     0.17.0  2024-10-16 [1] RSPM (R 4.4.0)\n   scales         1.3.0   2023-11-28 [1] RSPM (R 4.4.0)\n   sessioninfo    1.2.2   2021-12-06 [1] RSPM (R 4.4.0)\n   stringfish   * 0.16.0  2023-11-28 [1] RSPM (R 4.4.0)\n   stringi        1.8.4   2024-05-06 [1] RSPM (R 4.4.0)\n   stringr      * 1.5.1   2023-11-14 [1] RSPM (R 4.4.0)\n   systemfonts    1.1.0   2024-05-15 [1] RSPM (R 4.4.0)\n   textshaping    0.4.0   2024-05-24 [1] RSPM (R 4.4.0)\n   tibble       * 3.2.1   2023-03-20 [1] RSPM (R 4.4.0)\n   tidyr        * 1.3.1   2024-01-24 [1] RSPM (R 4.4.0)\n   tidyselect     1.2.1   2024-03-11 [1] RSPM (R 4.4.0)\n   tidyverse    * 2.0.0   2023-02-22 [1] RSPM (R 4.4.0)\n   timechange     0.3.0   2024-01-18 [1] RSPM (R 4.4.0)\n   tzdb           0.4.0   2023-05-12 [1] RSPM (R 4.4.0)\n   utf8           1.2.4   2023-10-22 [1] RSPM (R 4.4.0)\n   vctrs          0.6.5   2023-12-01 [1] RSPM (R 4.4.0)\n   withr          3.0.1   2024-07-31 [1] RSPM (R 4.4.0)\n   xfun           0.48    2024-10-03 [1] RSPM (R 4.4.0)\n   yaml           2.3.10  2024-07-26 [1] RSPM (R 4.4.0)\n\n [1] C:/Users/Andrew/AppData/Local/R/win-library/4.4\n [2] C:/Program Files/R/R-4.4.1/library\n\n D ── DLL MD5 mismatch, broken installation.\n\n──────────────────────────────────────────────────────────────────────────────\n```\n\n\n:::\n:::\n",
    "supporting": [
      "draw_matrix_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}